{"version":3,"sources":["Components/SwiperCss/CSwiperJss.tsx","Components/CSwiper.tsx","Components/Specific/DiscountTag.tsx","Components/CCard.tsx","ComponentFactory.tsx","Pages/Menu.tsx","Layout.tsx","Pages/Home.tsx","Components/Chart/Types/CChartStateTypes.ts","Components/Chart/CChartDataSchema.ts","Components/Chart/Types/CChartTypes.ts","Components/Chart/CChartLabel.tsx","Components/Chart/CChartCrosshair.tsx","Components/Chart/Charts/CCandleChart.tsx","Components/Chart/utils.ts","Components/Chart/Charts/CLineChart.tsx","Components/Chart/Charts/CBarChart.tsx","Components/Chart/Time/CChartDateTime.ts","Components/Chart/Time/CChartPeriod.ts","Components/Chart/CChartModel.ts","Components/Chart/Time/CChartDateStat.ts","Components/Chart/ChartState/CChartStateReducer.ts","Components/Chart/ChartState/CChartStateMethods.ts","Components/Chart/ChartState/CChartStateXaxis.ts","Components/Chart/ChartState/CChartStateYaxis.ts","Components/Chart/ChartState/CChartStateInteractions.ts","Components/Chart/ChartState/CChartState.ts","Components/Chart/Tools/CTrendline.tsx","Components/Chart/Tools/CVLine.tsx","Components/Chart/Tools/CHLine.tsx","Components/Chart/MuiTheme.ts","Components/Chart/Menu2/ChartMenuHome.tsx","Components/Chart/CIndicator.ts","Components/Chart/CTreeItem.tsx","Components/Chart/Colorpicker.tsx","Components/Chart/Menu2/ChartMenuIndicators.tsx","Components/Chart/Menu2/ChartMenuTools.tsx","Components/Chart/Menu2/ChartMenuSettings.tsx","Components/Chart/Menu2/ChartMenuQuickys.tsx","Components/Chart/Menu2/ChartMenu.tsx","Components/Chart/CChart.tsx","Pages/Chart.tsx","App.tsx","reportWebVitals.js","index.js"],"names":["useSwiperGlobalStyles","makeStyles","theme","fontFamily","src","fontWeight","fontStyle","palette","secondary","main","marginLeft","marginRight","position","overflow","listStyle","padding","zIndex","height","flexDirection","width","display","transitionProperty","boxSizing","transform","flexWrap","transitionTimingFunction","margin","touchAction","flexShrink","maxWidth","backgroundRepeat","backgroundSize","backgroundPosition","visibility","alignItems","perspective","transformStyle","left","top","pointerEvents","backgroundImage","scrollbarWidth","msOverflowStyle","scrollSnapAlign","scrollSnapType","marginTop","cursor","justifyContent","color","opacity","fontSize","textTransform","letterSpacing","fallbacks","fontVariant","lineHeight","right","content","swiperNavigationColor","textAlign","transition","bottom","borderRadius","background","border","boxShadow","webkitAppearance","mozAppearance","appearance","whiteSpace","transformOrigin","swiperPaginationColor","msTouchAction","maxHeight","objectFit","animation","borderTopColor","swiperPreloaderColor","webkitBackfaceVisibility","backfaceVisibility","webkitFilter","filter","name","SwiperCore","use","Navigation","Pagination","Scrollbar","EffectCoverflow","EffectFade","EffectCube","EffectFlip","Autoplay","CSwiper","props","autoHeight","autoplay","breakpoints","centeredSlides","effect","freeMode","loop","loopFillGroupWithBlank","navigation","pagination","preloadImages","slideToClickedSlide","slidesOffsetAfter","slidesOffsetBefore","slidesPerGroup","slidesPerView","spaceBetween","speed","activeSlide","accentColor","CssBackgroundSize","slides","onSlideChange","other","ActiveSlideRef","React","useRef","SwiperInst","useEffect","current","undefined","length","slideTo","Fragment","initialSlide","onSwiper","swiper","activeIndex","style","map","slide","slideIdx","bgImgSrc","divContent","slideStyle","slideOtherProps","defaultProps","clickable","discountsDefaultProps","time","discount","size","paddingPercentOfSize","bgImgUrl","DiscountTag","Math","round","upperTextHeightPercent","lowerTextHeightPercent","heightUpperText","heightLowerText","gridTemplateRows","gridTemplateColumns","useStyles","headerAction","CCard","cardMaxWidth","elevation","footerContent","headerAvatar","headerSubTitle","headerTitle","imageSrc","imageToolTip","mediaContent","mediaHeight","muiCardActionAreaProps","muiCardActionsProps","muiCardContentProps","muiCardHeaderProps","muiCardMediaProps","muiCardProps","useActionArea","useContent","useFooter","useHeader","useMedia","onActionAreaClick","classes","headerProps","avatar","action","title","subheader","cardContent","CardMedia","image","CardContent","Card","CardHeader","CardActionArea","onClick","CardActions","createSkillChipSlide","Chip","label","Typography","variant","Search","hour","Date","getHours","useTheme","matches","useMediaQuery","up","spacing","List","component","aria-label","ListItem","button","ListItemIcon","path","mdiFire","primary","mdiClipboardCheck","mdiAccount","mdiCodeTags","justifySelf","type","justifyItems","IconButton","mdiLinkedin","mdiGithub","mdiMapMarker","mdiMail","Layout","menuOpen","setMenuOpen","console","log","imgHeader","overflowY","children","Container","disableGutters","Menu","paddingTop","Paper","e","stopPropagation","mdiClose","Fab","mdiChevronUp","mdiMenu","useSwiperStyles","Home","useState","Toggle","setToggle","activeLocationStyle","paddingBottom","Button","isIndicatorGraph","graph","isChartGraph","chartDataSchema","minItems","items","properties","data","nullable","date","open","high","low","close","required","isCandleChartDataset","dataset","isLineChartDataset","isVolumeDataset","isIndicatorDataset","CChartLabel","decimals","startIcon","mdiChartBellCurve","mdiChartLine","prices","price","toFixed","join","CChartCrosshair","fullState","containerWidth","containerSize","containerHeight","widthYAxis","yaxis","xaxis","heightXAxis","heightTickMarkLines","pixYSnap","ySnap","pointer","move","xy","i","subCharts","subchart","j","graphs","chartPointer","snapDatasets","subchartIdx","findIndex","val","methods","pixToY","curgraph","indicator","default","parseFloat","pow","toString","x","y","points","xToPix","pixToX","stroke","strokeWidth","sceneFunc","context","shape","ctx","_context","yStart","moveTo","lineTo","fillStrokeShape","fill","font","fontName","fillStyle","fontColor","textBaseline","fillText","widthTickmarkLines","xUnlimited","xEnd","xStart","dateString","CCandleChart","curData","dxHalfCandle","forEach","valIdx","idx","widthPerTick","floor","beginPath","datasetIdx","xPix","pixXStart","yPixHigh","yToPix","yPixLow","yPixClose","closePath","candleStrokeColor","gainDataset","gainDatasetIdx","yPixOpen","pixXEnd","rect","candleUpColor","candleDownColor","isNullish","isNaN","getDecimals","split","includesOne","array","res","params","param","includes","colorNames","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","honeydew","hotpink","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgrey","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","hexToRgb","hex","replace","m","r","g","b","result","exec","parseInt","CLineChart","yaxisIdx","graphIdx","indSeriesIdxIn","indSeriesIdx","graphVals","Array","isArray","push","flat","graphValsNN","strokeColor","CBarChart","volume","yPixVol","yPix0","getDateString","period","format","getDateSubValue","getMinutes","getDate","getISOWeek","getMonth","getYear","getDateObject","minute","day","week","month","year","chartPeriods","minutes","scaleMultiplys","range","hours","days","weeks","months","years","getOptimalPeriod","metaData","noDataPortion","dateStat","chartPeriod","periodsConstIdx","chartPeriodName","nCurrent","curDateStat","Object","assign","nInDateStat","accAmt","keys","key","keyIdx","targetIntervals","opt","optPeriod","optMultiply","multiply","abs","isNewYear","curYearDateStat","thisMonthStat","isNewMonth","curMonthIdx","periodMultiply","isNewIsoWeek","curWeekIdx","daysInMonth","curDays","optWeekIdx","optimalDaysTarget","weekInMonth","isNewPeriod","optPeriodName","curYearStat","curMonthStat","curMonthStatIdx","indexOf","curWeekStat","curWeekStatIdx","curDayStat","curDayStatIdx","curDayIdx","isNewDay","getGraphMetaData","dataSeries","nData","getDeltaT","dataPoint1","dataPoint0","deltaPeriods","dT","amt","curWeek","curYear","curWeekDays","weekDays","deltaPeriod","iDataWeek","iyear","weekDaysFiltered","amtDays","weekDayIdx","occ","datasetDecimals","curDataset","maxDecimals","max","deltaTs","item","amts","maxIdx","reduce","arr","maxDaysPerWeekOccurences","totalOcc","maxDaysPerWeekOccIdx","maxDaysPerWeek","maxDaysPerWeekGuessConfidence","dataPeriod","dataPeriodKeys","chartPeriodKey","chartPeriodRange","getChartPeriod","periodGuessConfidence","tradingDaysPerWeek","tradingDaysPerWeekGuessConfidence","createSubChartModel","chartData","chartName","createYaxisModel","newGraph","createIndicatorGraphModel","createChartGraphModel","tools","translatedY","optIntervalY","heightPerPt","drawTicks","graphProps","stat","makeSingleDayStat","makeSingleWeekStat","makeSingleMonthStat","makeSingleYearStat","incrementPeriodAccAmt","addPeriod","curStatIdx","addOrIncrementPeriod","periodStat","periodStatFilter","filteredStatIdx","nextLowerPeriod","getDateStat","meta","yMax","yMaxExact","yMin","yMinExact","datasets","first","last","indicatorData","indicatorFn","decimalsData","graphColorsLight","getGraphColors","colorArr","isSetCandleChartUpColor","task","isSetCandleChartDownColor","isSetCandleChartStrokeColor","isSetToolStrokeColorAction","isSetToolAnchorColor","chartStateReducer","isAddSubchartAction","chartSeries","minMainHeight","heightNewSubchart","min","subChart","subChartIdx","isRemoveSubchartAction","dHeight","dHeightEach","dHeightRest","slice","subchartSliced","subchartSlicedIdx","isRemoveGraphAction","isAddGraphAction","isDrawAction","draw","isDrawing","pixXy","isSetBackgroundColorAction","backgroundColor","isSetGridStrokeColorAction","grid","isSetAxisFillColorAction","fillColor","isSetAxisStrokeColorAction","isSetAxisTextColorAction","isToggleXaxisGridAction","useGridX","isToggleYaxisGridAction","useGridY","isToggleFullscreenAction","fullscreen","isSetLineChartStrokeColor","prop","toolIdx","isSetIndicatorParam","paramIdx","indicatorGraph","fn","srcData","isSetHlineYlevelAction","newAnchor","isUpdateInteractionState","newState","getChartMethods","ChartState","Dispatch","addGraph","addSubchart","getSubchart","getYaxis","getGraph","translatedX","totalTranslatedX","pixX","stateTranslatedY","translatedYint","pixY","pureXToPix","translated","purePixToX","pureYToPix","pixYBottom","pixPerPt","purePixToY","snapPixYToPrices","subcharts","snapTolerance","snapTol","snapRes","priceIdx","yPixPrice","sort","a","calculateCurrentGraphs","pixXstart","pixXend","calculatedSubcharts","mainYaxis","yMinExactAllGraphs","yMaxExactAllGraphs","graphM","fixedYScale","intervalsTarget","dec","targetSteps","initIntervalStep","curIntervalStep","optIntervalStep","optimizationFunction","steps","optimizer","factor","curOptimizerRes","GetYOptInterval","yMaxAllGraphs","yMinAllGraphs","ceil","y_bottom","yi","yvalstr","getSubchartIdxByVector","getDragActionType","dragInitXy","isEditing","canvasWidth","canvasHeight","init","editToolPath","toolsIdx","scaledWidthPerTick","singleYaxis","singleYaxisIdx","tool","anchorXy","anchorIdx","getToolsByXy","resizeSubchartIdx","getSubchartIdxByBottom","initBottom","editToolPosition","dragActionType","curPixX","pixXSnap","drag","curPixY","initX","initial","subIdx","yAdjusted","localInitY","newPixX","newPixY","newX","newY","toolsSubIdx","toolsYaxisIdx","resizeSubchart","newBottom","addToolAnchor","drawToolType","dragpixXy","dequal","require","defaultState","totalScaleX","startNoDataPeriod","endNoDataPeriod","noDataPeriodPortion","optPeriodRes","xAxisTicks","strokeStyle","isHovering","isMoving","wheel","isWheeling","delta","dragPointerUp","isDragPointerUp","movementInitial","isDragging","xDateString","click","clickedSubchartIdx","useChartState","HtmlElementRef","settings","maxUpdatesPerSec","initWidthPerTick","viewModeInternal","viewMode","useReducer","PreStateRef","tmp","scaleInitWidthPerTick","scaleInitTranslatedX","lastUpdate","shallUpdate","userInteractedChartState","useGesture","onDrag","dragState","deltaX","deltaY","movement","active","onMove","moveState","onHover","hoverState","onWheel","wheelState","onDragEnd","domTarget","useTouch","experimental_preventWindowScrollY","clientWidth","clientHeight","getBoundingClientRect","handleWindowResize","parentElement","addEventListener","window","removeEventListener","userInteractedSubcharts","addIndicatorDeps","onTimer","PreState","DragEndState","DragState","currentPointer","widthYaxis","widthChart","heightChart","heightXaxis","calcSubcharts","calcXaxis","calcDraw","dHproportionalTmp","newMainSizeTmp","dHeightMain","dHeightSingleSubchart","rest","currentRest","lastBottom","correctRest","tempRest","sign","newTop","dragInit","mainGraph","currentXaxis","initWidthTickX","shallUpdateDrag","clickedChart","clickedXaxis","nDatasets","wheeldY","initWheelMousePos","scaleFn","translatedXonStart","initPixX","initXexact","getInteractiveXaxisState","translatedPixX","nMainData","pixXi","xi","periodToDraw","calculateCurrentXaxis","calcCurrentSubchart","xpointerRes","xIdx","xPointerUnlimited","xPointer","xPointerDateStr","pixXPointer","calculateXPointer","xpointer","xpointerUnlimited","xPointerDateString","getSubchartIdx","snapPriceRes","calculateCurrentPointerDataset","nPoints","xyArr","pixXyIdx","anchorColor","addTool","state","handleTimer","setInterval","clearInterval","CTrendline","mode","subchartTop","subchartBottom","modeInt","pixXyAdjusted","dx","dy","slope","pixYTarget","pixXTarget","pixYSrc","pixXSrc","radius","CVline","CHline","muiTheme","localTheme","createMuiTheme","typography","h1","h2","h3","h4","h5","h6","responsiveFontSizes","ChartMenuHome","onNavigate","minWidth","contrastText","ListItemText","primaryTypographyProps","mdiPencilRuler","mdiTune","mdiStarShooting","iSMA","srcChartData","srcChartName","srcDataset","srcDatasetIdx","singleSmaAcc","selSrcDataset","newSubchart","iEMACalc","initSMA","multiplier","ema","iEMA","iATR","singleValAcc","dataset1","singleAtr","hl","hc1","lc1","iRSI","calcData","dClose","dwn","w","lastUpEma","lastDwnEma","upSmoothed","dwnSmoothed","rsi","iOBV","obv","iVolume","iMACD","periodEmaShort","periodEmaLong","periodSignal","emaShort","emaLong","macd","emaLongVal","emaShortVal","priceLabels","signal","macdComplete","macdVal","macdIdx","macdValPrice","signalVal","macdHistogramm","useTreeItemStyles","createStyles","root","text","hover","grey","borderTopRightRadius","borderBottomRightRadius","paddingRight","fontWeightMedium","fontWeightRegular","group","paddingLeft","expanded","selected","labelRoot","labelRootBtn","btnLabel","labelIcon","labelText","flexGrow","CTreeItem","LabelIcon","labelInfo","bgColor","onLabelClick","onIconClick","labelTypographyVariant","infoTypographyVariant","labelTypographyColor","infoTypographyColor","TreeItem","className","rgbaColor","ColorRect","container","Colorpicker","onColorSelected","Open","setOpen","ColorHover","setColorHover","InputRef","isHex","test","hexToRgbRes","isRgb","match","isRgba","rgbInternal","colorNameRes","alphaProp","AlphaVal","setAlphaVal","ref","Popover","id","anchorEl","onClose","anchorOrigin","vertical","horizontal","Grid","alignContent","justify","clr","clrIdx","xs","onMouseOver","onMouseLeave","Slider","value","onChange","TextField","inputProps","target","borderTop","align","fullWidth","onIndicatorLabelClick","indi","CIndicatorGraphTreeItem","ChartStateDispatch","graphGeneric","nodeId","Icon","preventDefault","mdiBorderColor","mdiIframeVariableOutline","defaultValue","ChartMenuIndicators","FilterCat","setFilterCat","categorys","icon","mdiDiameterVariant","mdiArrowExpandVertical","mdiPoll","indicators","category","amtIndicators","yaxixsIdx","fgraph","acc","cur","ToggleButtonGroup","exclusive","ToggleButton","borderBottomLeftRadius","borderTopLeftRadius","light","alert","mdiMagnify","mdiSortAlphabeticalAscending","mdiFilter","TreeView","defaultCollapseIcon","mdiMenuDown","defaultExpandIcon","mdiMenuRight","defaultEndIcon","disableSelection","cat","catIdx","indiIdx","onToolLabelClick","CToolTreeItem","toolIn","mdiMinus","mdiHelp","rotate","mdiArrowSplitHorizontal","mdiBullseye","ChartMenuTools","mdiRuler","mdiRulerSquareCompass","amtTools","ChartMenuSettings","setAnchorEl","handleClose","event","currentTarget","keepMounted","Boolean","MenuItem","mdiFileChartOutline","mdiWater","mdiFormatText","mdiGrid","Checkbox","checked","mdiChartAreaspline","ChartMenuQuickys","mdiBroom","paper","minHeight","paperDesktop","CChartMenu2","isMinSm","Drawer","anchor","ModalProps","hideBackdrop","mdiHome","mdiFullscreen","ajv","Ajv","CChart","ContainerRef","setChartMenuActive","ChartMenu2Open","setChartMenu2Open","isContainerInit","validate","compile","errors","xAxis","ThemeProvider","listening","stateGraph","indicatorType","indicatorLines","indicatorDataSeries","indDataSeriesIdx","xaxisTick","xaxisTickIdx","yaxisTick","yaxisTickIdx","tmpDataset","parseDate","timeParse","ChartTest","Data","setData","fetch","then","response","csvParse","parse","d","routes","exact","overrides","MuiCssBaseline","body","App","MenuOpen","setMenuState","basename","process","route","index","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.5874d57c.chunk.js","sourcesContent":["import { makeStyles, Theme } from \"@material-ui/core\";\r\n\r\nexport const useSwiperGlobalStyles = makeStyles(\r\n  (theme: Theme) => ({\r\n    \"@global\": {\r\n      \"@font-face\": {\r\n        fontFamily: \"'swiper-icons'\",\r\n        src:\r\n          \"url('data:application/font-woff;charset=utf-8;base64, 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') format('woff')\",\r\n        fontWeight: \"400\",\r\n        fontStyle: \"normal\",\r\n      },\r\n      \":root\": {\r\n        \"--swiper-theme-color\": theme.palette.secondary.main,\r\n        \"--swiper-navigation-size\": \"44px\",\r\n      },\r\n      \".swiper-container\": {\r\n        marginLeft: \"auto\",\r\n        marginRight: \"auto\",\r\n        position: \"relative\",\r\n        overflow: \"hidden\",\r\n        listStyle: \"none\",\r\n        padding: \"0\",\r\n        zIndex: \"1\",\r\n        height: \"\",\r\n      },\r\n      \".swiper-container-vertical > .swiper-wrapper\": {\r\n        flexDirection: \"column\",\r\n      },\r\n      \".swiper-wrapper\": {\r\n        position: \"relative\",\r\n        width: \"100%\",\r\n        height: \"100%\",\r\n        zIndex: \"1\",\r\n        display: \"flex\",\r\n        transitionProperty: \"transform\",\r\n        boxSizing: \"content-box\",\r\n      },\r\n      \".swiper-container-android .swiper-slide, .swiper-wrapper\": {\r\n        transform: \"translate3d(0px, 0, 0)\",\r\n      },\r\n      \".swiper-container-multirow > .swiper-wrapper\": {\r\n        flexWrap: \"wrap\",\r\n      },\r\n      \".swiper-container-multirow-column > .swiper-wrapper\": {\r\n        flexWrap: \"wrap\",\r\n        flexDirection: \"column\",\r\n      },\r\n      \".swiper-container-free-mode > .swiper-wrapper\": {\r\n        transitionTimingFunction: \"ease-out\",\r\n        margin: \"0 auto\",\r\n      },\r\n      \".swiper-container-pointer-events\": {\r\n        touchAction: \"pan-y\",\r\n      },\r\n      \".swiper-container-pointer-events.swiper-container-vertical\": {\r\n        touchAction: \"pan-x\",\r\n      },\r\n      \".swiper-slide\": {\r\n        flexShrink: \"0\",\r\n        width: \"100%\",\r\n        position: \"relative\",\r\n        transitionProperty: \"transform\",\r\n        maxWidth: \"100%\",\r\n        height: \"100%\",\r\n        backgroundRepeat: \"no-repeat\",\r\n        backgroundSize: \"cover\",\r\n        backgroundPosition: \"center\",\r\n      },\r\n      \".swiper-slide-invisible-blank\": {\r\n        visibility: \"hidden\",\r\n      },\r\n      \".swiper-container-autoheight, .swiper-container-autoheight .swiper-slide\": {\r\n        height: \"auto\",\r\n      },\r\n      \".swiper-container-autoheight .swiper-wrapper\": {\r\n        alignItems: \"flex-start\",\r\n        transitionProperty: \"transform, height\",\r\n      },\r\n      \".swiper-container-3d\": {\r\n        perspective: 1200,\r\n      },\r\n      \".swiper-container-3d .swiper-wrapper, .swiper-container-3d .swiper-slide, .swiper-container-3d .swiper-slide-shadow-left, .swiper-container-3d .swiper-slide-shadow-right, .swiper-container-3d .swiper-slide-shadow-top, .swiper-container-3d .swiper-slide-shadow-bottom, .swiper-container-3d .swiper-cube-shadow\": {\r\n        transformStyle: \"preserve-3d\",\r\n      },\r\n      \".swiper-container-3d .swiper-slide-shadow-left, .swiper-container-3d .swiper-slide-shadow-right, .swiper-container-3d .swiper-slide-shadow-top, .swiper-container-3d .swiper-slide-shadow-bottom\": {\r\n        position: \"absolute\",\r\n        left: \"0\",\r\n        top: \"0\",\r\n        width: \"100%\",\r\n        height: \"100%\",\r\n        pointerEvents: \"none\",\r\n        zIndex: \"10\",\r\n      },\r\n      \".swiper-container-3d .swiper-slide-shadow-left\": {\r\n        backgroundImage: \"linear-gradient(to left, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0))\",\r\n      },\r\n      \".swiper-container-3d .swiper-slide-shadow-right\": {\r\n        backgroundImage: \"linear-gradient(to right, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0))\",\r\n      },\r\n      \".swiper-container-3d .swiper-slide-shadow-top\": {\r\n        backgroundImage: \"linear-gradient(to top, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0))\",\r\n      },\r\n      \".swiper-container-3d .swiper-slide-shadow-bottom\": {\r\n        backgroundImage: \"linear-gradient(to bottom, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0))\",\r\n      },\r\n      \".swiper-container-css-mode > .swiper-wrapper\": {\r\n        overflow: \"auto\",\r\n        scrollbarWidth: \"none\",\r\n        msOverflowStyle: \"none\",\r\n      },\r\n      \".swiper-container-css-mode > .swiper-wrapper::-webkit-scrollbar\": {\r\n        display: \"none\",\r\n      },\r\n      \".swiper-container-css-mode > .swiper-wrapper > .swiper-slide\": {\r\n        scrollSnapAlign: \"start start\",\r\n      },\r\n      \".swiper-container-horizontal.swiper-container-css-mode > .swiper-wrapper\": {\r\n        scrollSnapType: \"x mandatory\",\r\n      },\r\n      \".swiper-container-vertical.swiper-container-css-mode > .swiper-wrapper\": {\r\n        scrollSnapType: \"y mandatory\",\r\n      },\r\n      \".swiper-button-prev, .swiper-button-next\": {\r\n        position: \"absolute\",\r\n        top: \"50%\",\r\n        width: \"calc(var(--swiper-navigation-size) / 44 * 27)\",\r\n        height: \"var(--swiper-navigation-size)\",\r\n        marginTop: \"calc(-1 * var(--swiper-navigation-size) / 2)\",\r\n        zIndex: \"10\",\r\n        cursor: \"pointer\",\r\n        display: \"flex\",\r\n        alignItems: \"center\",\r\n        justifyContent: \"center\",\r\n        color: \"var(--swiper-navigation-color, var(--swiper-theme-color))\",\r\n      },\r\n      \".swiper-button-prev.swiper-button-disabled, .swiper-button-next.swiper-button-disabled\": {\r\n        opacity: \"0.35\",\r\n        cursor: \"auto\",\r\n        pointerEvents: \"none\",\r\n      },\r\n      \".swiper-button-prev:after, .swiper-button-next:after\": {\r\n        fontFamily: \"swiper-icons\",\r\n        fontSize: \"var(--swiper-navigation-size)\",\r\n        textTransform: \"none\",\r\n        letterSpacing: \"0\",\r\n        fallbacks: [\r\n          {\r\n            textTransform: \"none !important\",\r\n          },\r\n        ],\r\n        fontVariant: \"initial\",\r\n        lineHeight: \"1\",\r\n      },\r\n      \".swiper-button-prev, .swiper-container-rtl .swiper-button-next\": {\r\n        left: 10,\r\n        right: \"auto\",\r\n      },\r\n      \".swiper-button-prev:after, .swiper-container-rtl .swiper-button-next:after\": {\r\n        content: \"'prev'\",\r\n      },\r\n      \".swiper-button-next, .swiper-container-rtl .swiper-button-prev\": {\r\n        right: 10,\r\n        left: \"auto\",\r\n      },\r\n      \".swiper-button-next:after, .swiper-container-rtl .swiper-button-prev:after\": {\r\n        content: \"'next'\",\r\n      },\r\n      \".swiper-button-prev.swiper-button-white, .swiper-button-next.swiper-button-white\": {\r\n        swiperNavigationColor: \"#fff\",\r\n      },\r\n      \".swiper-button-prev.swiper-button-black, .swiper-button-next.swiper-button-black\": {\r\n        swiperNavigationColor: \"#000\",\r\n      },\r\n      \".swiper-button-lock\": {\r\n        display: \"none\",\r\n      },\r\n      \".swiper-pagination\": {\r\n        position: \"absolute\",\r\n        textAlign: \"center\",\r\n        transition: \"300ms opacity\",\r\n        transform: \"translate3d(0, 0, 0)\",\r\n        zIndex: \"10\",\r\n      },\r\n      \".swiper-pagination.swiper-pagination-hidden\": {\r\n        opacity: \"0\",\r\n      },\r\n      \".swiper-pagination-fraction, .swiper-pagination-custom, .swiper-container-horizontal > .swiper-pagination-bullets\": {\r\n        bottom: 10,\r\n        left: \"0\",\r\n        width: \"100%\",\r\n      },\r\n      \".swiper-pagination-bullets-dynamic\": {\r\n        overflow: \"hidden\",\r\n        fontSize: \"0\",\r\n      },\r\n      \".swiper-pagination-bullets-dynamic .swiper-pagination-bullet\": {\r\n        transform: \"scale(0.33)\",\r\n        position: \"relative\",\r\n      },\r\n      \".swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active\": {\r\n        transform: \"scale(1)\",\r\n      },\r\n      \".swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-main\": {\r\n        transform: \"scale(1)\",\r\n      },\r\n      \".swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-prev\": {\r\n        transform: \"scale(0.66)\",\r\n      },\r\n      \".swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-prev-prev\": {\r\n        transform: \"scale(0.33)\",\r\n      },\r\n      \".swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-next\": {\r\n        transform: \"scale(0.66)\",\r\n      },\r\n      \".swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-next-next\": {\r\n        transform: \"scale(0.33)\",\r\n      },\r\n      \".swiper-pagination-bullet\": {\r\n        width: 8,\r\n        height: 8,\r\n        display: \"inline-block\",\r\n        borderRadius: \"50%\",\r\n        background: \"#000\",\r\n        opacity: \"0.2\",\r\n      },\r\n      \"button.swiper-pagination-bullet\": {\r\n        border: \"none\",\r\n        margin: \"0\",\r\n        padding: \"0\",\r\n        boxShadow: \"none\",\r\n        webkitAppearance: \"none\",\r\n        mozAppearance: \"none\",\r\n        appearance: \"none\",\r\n      },\r\n      \".swiper-pagination-clickable .swiper-pagination-bullet\": {\r\n        cursor: \"pointer\",\r\n      },\r\n      \".swiper-pagination-bullet-active\": {\r\n        opacity: \"1\",\r\n        background: \"var(--swiper-pagination-color, var(--swiper-theme-color))\",\r\n      },\r\n      \".swiper-container-vertical > .swiper-pagination-bullets\": {\r\n        right: 10,\r\n        top: \"50%\",\r\n        transform: \"translate3d(0px, -50%, 0)\",\r\n      },\r\n      \".swiper-container-vertical > .swiper-pagination-bullets .swiper-pagination-bullet\": {\r\n        margin: \"6px 0\",\r\n        display: \"block\",\r\n      },\r\n      \".swiper-container-vertical > .swiper-pagination-bullets.swiper-pagination-bullets-dynamic\": {\r\n        top: \"50%\",\r\n        transform: \"translateY(-50%)\",\r\n        width: 8,\r\n      },\r\n      \".swiper-container-vertical > .swiper-pagination-bullets.swiper-pagination-bullets-dynamic .swiper-pagination-bullet\": {\r\n        display: \"inline-block\",\r\n        transition: \"200ms transform, 200ms top\",\r\n      },\r\n      \".swiper-container-horizontal > .swiper-pagination-bullets .swiper-pagination-bullet\": {\r\n        margin: \"0 4px\",\r\n      },\r\n      \".swiper-container-horizontal > .swiper-pagination-bullets.swiper-pagination-bullets-dynamic\": {\r\n        left: \"50%\",\r\n        transform: \"translateX(-50%)\",\r\n        whiteSpace: \"nowrap\",\r\n      },\r\n      \".swiper-container-horizontal > .swiper-pagination-bullets.swiper-pagination-bullets-dynamic .swiper-pagination-bullet\": {\r\n        transition: \"200ms transform, 200ms left\",\r\n      },\r\n      \".swiper-container-horizontal.swiper-container-rtl > .swiper-pagination-bullets-dynamic .swiper-pagination-bullet\": {\r\n        transition: \"200ms transform, 200ms right\",\r\n      },\r\n      \".swiper-pagination-progressbar\": {\r\n        background: \"rgba(0, 0, 0, 0.25)\",\r\n        position: \"absolute\",\r\n      },\r\n      \".swiper-pagination-progressbar .swiper-pagination-progressbar-fill\": {\r\n        background: \"var(--swiper-pagination-color, var(--swiper-theme-color))\",\r\n        position: \"absolute\",\r\n        left: \"0\",\r\n        top: \"0\",\r\n        width: \"100%\",\r\n        height: \"100%\",\r\n        transform: \"scale(0)\",\r\n        transformOrigin: \"left top\",\r\n      },\r\n      \".swiper-container-rtl .swiper-pagination-progressbar .swiper-pagination-progressbar-fill\": {\r\n        transformOrigin: \"right top\",\r\n      },\r\n      \".swiper-container-horizontal > .swiper-pagination-progressbar, .swiper-container-vertical > .swiper-pagination-progressbar.swiper-pagination-progressbar-opposite\": {\r\n        width: \"100%\",\r\n        height: 4,\r\n        left: \"0\",\r\n        top: \"0\",\r\n      },\r\n      \".swiper-container-vertical > .swiper-pagination-progressbar, .swiper-container-horizontal > .swiper-pagination-progressbar.swiper-pagination-progressbar-opposite\": {\r\n        width: 4,\r\n        height: \"100%\",\r\n        left: \"0\",\r\n        top: \"0\",\r\n      },\r\n      \".swiper-pagination-white\": {\r\n        swiperPaginationColor: \"#fff\",\r\n      },\r\n      \".swiper-pagination-black\": {\r\n        swiperPaginationColor: \"#000\",\r\n      },\r\n      \".swiper-pagination-lock\": {\r\n        display: \"none\",\r\n      },\r\n      \".swiper-scrollbar\": {\r\n        borderRadius: 10,\r\n        position: \"relative\",\r\n        msTouchAction: \"none\",\r\n        background: \"rgba(0, 0, 0, 0.1)\",\r\n      },\r\n      \".swiper-container-horizontal > .swiper-scrollbar\": {\r\n        position: \"absolute\",\r\n        left: \"1%\",\r\n        bottom: 3,\r\n        zIndex: \"50\",\r\n        height: 5,\r\n        width: \"98%\",\r\n      },\r\n      \".swiper-container-vertical > .swiper-scrollbar\": {\r\n        position: \"absolute\",\r\n        right: 3,\r\n        top: \"1%\",\r\n        zIndex: \"50\",\r\n        width: 5,\r\n        height: \"98%\",\r\n      },\r\n      \".swiper-scrollbar-drag\": {\r\n        height: \"100%\",\r\n        width: \"100%\",\r\n        position: \"relative\",\r\n        background: \"rgba(0, 0, 0, 0.5)\",\r\n        borderRadius: 10,\r\n        left: \"0\",\r\n        top: \"0\",\r\n      },\r\n      \".swiper-scrollbar-cursor-drag\": {\r\n        cursor: \"move\",\r\n      },\r\n      \".swiper-scrollbar-lock\": {\r\n        display: \"none\",\r\n      },\r\n      \".swiper-zoom-container\": {\r\n        width: \"100%\",\r\n        height: \"100%\",\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\",\r\n        textAlign: \"center\",\r\n      },\r\n      \".swiper-zoom-container > img, .swiper-zoom-container > svg, .swiper-zoom-container > canvas\": {\r\n        maxWidth: \"100%\",\r\n        maxHeight: \"100%\",\r\n        objectFit: \"contain\",\r\n      },\r\n      \".swiper-slide-zoomed\": {\r\n        cursor: \"move\",\r\n      },\r\n      \".swiper-lazy-preloader\": {\r\n        width: 42,\r\n        height: 42,\r\n        position: \"absolute\",\r\n        left: \"50%\",\r\n        top: \"50%\",\r\n        marginLeft: -21,\r\n        marginTop: -21,\r\n        zIndex: \"10\",\r\n        transformOrigin: \"50%\",\r\n        animation: \"swiper-preloader-spin 1s infinite linear\",\r\n        boxSizing: \"border-box\",\r\n        border: \"4px solid var(--swiper-preloader-color, var(--swiper-theme-color))\",\r\n        borderRadius: \"50%\",\r\n        borderTopColor: \"transparent\",\r\n      },\r\n      \".swiper-lazy-preloader-white\": {\r\n        swiperPreloaderColor: \"#fff\",\r\n      },\r\n      \".swiper-lazy-preloader-black\": {\r\n        swiperPreloaderColor: \"#000\",\r\n      },\r\n      \"@keyframes swiper-preloader-spin\": {\r\n        \"100%\": {\r\n          transform: \"rotate(360deg)\",\r\n        },\r\n      },\r\n      \".swiper-container .swiper-notification\": {\r\n        position: \"absolute\",\r\n        left: \"0\",\r\n        top: \"0\",\r\n        pointerEvents: \"none\",\r\n        opacity: \"0\",\r\n        zIndex: \"-1000\",\r\n      },\r\n      \".swiper-container-fade.swiper-container-free-mode .swiper-slide\": {\r\n        transitionTimingFunction: \"ease-out\",\r\n      },\r\n      \".swiper-container-fade .swiper-slide\": {\r\n        pointerEvents: \"none\",\r\n        transitionProperty: \"opacity\",\r\n      },\r\n      \".swiper-container-fade .swiper-slide .swiper-slide\": {\r\n        pointerEvents: \"none\",\r\n      },\r\n      \".swiper-container-fade .swiper-slide-active, .swiper-container-fade .swiper-slide-active .swiper-slide-active\": {\r\n        pointerEvents: \"auto\",\r\n      },\r\n      \".swiper-container-cube\": {\r\n        overflow: \"visible\",\r\n      },\r\n      \".swiper-container-cube .swiper-slide\": {\r\n        pointerEvents: \"none\",\r\n        webkitBackfaceVisibility: \"hidden\",\r\n        backfaceVisibility: \"hidden\",\r\n        zIndex: \"1\",\r\n        visibility: \"hidden\",\r\n        transformOrigin: \"0 0\",\r\n        width: \"100%\",\r\n        height: \"100%\",\r\n      },\r\n      \".swiper-container-cube .swiper-slide .swiper-slide\": {\r\n        pointerEvents: \"none\",\r\n      },\r\n      \".swiper-container-cube.swiper-container-rtl .swiper-slide\": {\r\n        transformOrigin: \"100% 0\",\r\n      },\r\n      \".swiper-container-cube .swiper-slide-active, .swiper-container-cube .swiper-slide-active .swiper-slide-active\": {\r\n        pointerEvents: \"auto\",\r\n      },\r\n      \".swiper-container-cube .swiper-slide-active, .swiper-container-cube .swiper-slide-next, .swiper-container-cube .swiper-slide-prev, .swiper-container-cube .swiper-slide-next + .swiper-slide\": {\r\n        pointerEvents: \"auto\",\r\n        visibility: \"visible\",\r\n      },\r\n      \".swiper-container-cube .swiper-slide-shadow-top, .swiper-container-cube .swiper-slide-shadow-bottom, .swiper-container-cube .swiper-slide-shadow-left, .swiper-container-cube .swiper-slide-shadow-right\": {\r\n        zIndex: \"0\",\r\n        webkitBackfaceVisibility: \"hidden\",\r\n        backfaceVisibility: \"hidden\",\r\n      },\r\n      \".swiper-container-cube .swiper-cube-shadow\": {\r\n        position: \"absolute\",\r\n        left: \"0\",\r\n        bottom: 0,\r\n        width: \"100%\",\r\n        height: \"100%\",\r\n        opacity: \"0.6\",\r\n        zIndex: \"0\",\r\n      },\r\n      \".swiper-container-cube .swiper-cube-shadow:before\": {\r\n        content: \"''\",\r\n        background: \"#000\",\r\n        position: \"absolute\",\r\n        left: \"0\",\r\n        top: \"0\",\r\n        bottom: \"0\",\r\n        right: \"0\",\r\n        webkitFilter: \"blur(50px)\",\r\n        filter: \"blur(50px)\",\r\n      },\r\n      \".swiper-container-flip\": {\r\n        overflow: \"visible\",\r\n      },\r\n      \".swiper-container-flip .swiper-slide\": {\r\n        pointerEvents: \"none\",\r\n        webkitBackfaceVisibility: \"hidden\",\r\n        backfaceVisibility: \"hidden\",\r\n        zIndex: \"1\",\r\n      },\r\n      \".swiper-container-flip .swiper-slide .swiper-slide\": {\r\n        pointerEvents: \"none\",\r\n      },\r\n      \".swiper-container-flip .swiper-slide-active, .swiper-container-flip .swiper-slide-active .swiper-slide-active\": {\r\n        pointerEvents: \"auto\",\r\n      },\r\n      \".swiper-container-flip .swiper-slide-shadow-top, .swiper-container-flip .swiper-slide-shadow-bottom, .swiper-container-flip .swiper-slide-shadow-left, .swiper-container-flip .swiper-slide-shadow-right\": {\r\n        zIndex: \"0\",\r\n        webkitBackfaceVisibility: \"hidden\",\r\n        backfaceVisibility: \"hidden\",\r\n      },\r\n    },\r\n  }),\r\n  { name: \"CSwiper\" }\r\n);\r\n","import React from \"react\";\r\nimport SwiperCore, {\r\n  Navigation,\r\n  Pagination,\r\n  Scrollbar,\r\n  //   A11y,\r\n  EffectFade,\r\n  EffectCoverflow,\r\n  EffectCube,\r\n  EffectFlip,\r\n  Autoplay,\r\n} from \"swiper\";\r\nimport { Swiper, SwiperSlide } from \"swiper/react\";\r\nimport { Swiper as SwiperObj } from \"swiper\";\r\nimport { Swiper as SwiperOptions } from \"swiper/swiper-react\";\r\nimport { useSwiperGlobalStyles } from \"./SwiperCss/CSwiperJss\";\r\n\r\n// install Swiper modules\r\nSwiperCore.use([\r\n  Navigation,\r\n  Pagination,\r\n  Scrollbar,\r\n  EffectCoverflow,\r\n  EffectFade,\r\n  EffectCube,\r\n  EffectFlip,\r\n  Autoplay,\r\n  //   A11y,\r\n]);\r\n\r\nexport interface CSwiperSlidePropTypes extends React.HTMLProps<HTMLDivElement> {\r\n  bgImgSrc?: string;\r\n  divContent?: React.ReactNode;\r\n}\r\nexport interface CSwiperPropTypes extends Omit<SwiperOptions, \"height\" | \"initialSlide\"> {\r\n  activeSlide?: number;\r\n  accentColor?: string;\r\n  CssBackgroundSize?: React.CSSProperties[\"backgroundSize\"];\r\n  height?: React.CSSProperties[\"height\"];\r\n  maxWidth?: React.CSSProperties[\"maxWidth\"];\r\n  slides?: CSwiperSlidePropTypes[];\r\n  onSlideChange?: ((swiper: SwiperObj) => void) | undefined;\r\n}\r\n\r\nconst cswiperDefaultProps: CSwiperPropTypes = {\r\n  // wrapped props - swiper.js doesnt seem to accept explicit \"undefined\" for some props\r\n  autoHeight: false,\r\n  autoplay: false,\r\n  centeredSlides: false, // centered slide, not content (if slide's width is smaller than swiper container)\r\n  effect: \"slide\",\r\n  freeMode: false,\r\n  loop: false,\r\n  loopFillGroupWithBlank: false,\r\n  navigation: true, // deviate from swiper.js default\r\n  pagination: { clickable: true }, // deviate from swiper.js default\r\n  preloadImages: true,\r\n  slideToClickedSlide: false,\r\n  slidesOffsetAfter: 0,\r\n  slidesOffsetBefore: 0,\r\n  slidesPerGroup: 1,\r\n  slidesPerView: 1, // if \"auto\" will disable SlidesPerGroup\r\n  spaceBetween: 0,\r\n  speed: 300,\r\n  // additional props used to faciliate usage\r\n  accentColor: \"#007aff\",\r\n  activeSlide: 0, //replaces initialSlide, becoming reactive\r\n  CssBackgroundSize: \"cover\",\r\n  height: \"100%\",\r\n  maxWidth: \"100%\",\r\n};\r\n\r\nexport const CSwiper: React.FunctionComponent<CSwiperPropTypes> = (props) => {\r\n  const {\r\n    // wrapped props\r\n    autoHeight,\r\n    autoplay,\r\n    breakpoints,\r\n    centeredSlides,\r\n    effect,\r\n    freeMode,\r\n    loop,\r\n    loopFillGroupWithBlank,\r\n    navigation,\r\n    pagination,\r\n    preloadImages,\r\n    slideToClickedSlide,\r\n    slidesOffsetAfter,\r\n    slidesOffsetBefore,\r\n    slidesPerGroup,\r\n    slidesPerView,\r\n    spaceBetween,\r\n    speed,\r\n    // additional props used to faciliate usage\r\n    accentColor,\r\n    activeSlide,\r\n    CssBackgroundSize,\r\n    height,\r\n    maxWidth,\r\n    slides,\r\n    onSlideChange,\r\n    ...other\r\n  } = props;\r\n\r\n  const ActiveSlideRef = React.useRef<number>(!!activeSlide ? activeSlide : 0);\r\n  const SwiperInst = React.useRef<SwiperObj | null>(null);\r\n  const swiperGlobalClasses = useSwiperGlobalStyles();\r\n\r\n  React.useEffect(() => {\r\n    if (!!SwiperInst.current && activeSlide !== undefined) {\r\n      if (activeSlide >= 0 && activeSlide < SwiperInst.current.slides.length) {\r\n        if (activeSlide !== ActiveSlideRef.current) {\r\n          SwiperInst.current.slideTo(activeSlide);\r\n        }\r\n      }\r\n    }\r\n  }, [activeSlide]);\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Swiper\r\n        spaceBetween={spaceBetween}\r\n        slidesPerView={slidesPerView}\r\n        centeredSlides={centeredSlides}\r\n        slidesPerGroup={slidesPerGroup}\r\n        initialSlide={activeSlide}\r\n        speed={speed}\r\n        effect={effect}\r\n        autoplay={autoplay}\r\n        autoHeight={autoHeight}\r\n        slideToClickedSlide={slideToClickedSlide}\r\n        freeMode={freeMode}\r\n        breakpoints={breakpoints}\r\n        loop={loop}\r\n        loopFillGroupWithBlank={loopFillGroupWithBlank}\r\n        preloadImages={preloadImages}\r\n        slidesOffsetBefore={slidesOffsetBefore}\r\n        slidesOffsetAfter={slidesOffsetAfter}\r\n        navigation={navigation}\r\n        pagination={pagination}\r\n        onSwiper={(swiper) => {\r\n          SwiperInst.current = swiper;\r\n        }}\r\n        onSlideChange={(swiper) => {\r\n          ActiveSlideRef.current = swiper.activeIndex;\r\n          onSlideChange?.(swiper);\r\n        }}\r\n        //\r\n        style={{\r\n          height: height,\r\n          maxWidth: maxWidth,\r\n        }}\r\n        {...other}\r\n      >\r\n        {!!slides\r\n          ? slides.map((slide, slideIdx) => {\r\n              const { bgImgSrc, divContent, style: slideStyle, ...slideOtherProps } = slide;\r\n              return (\r\n                <SwiperSlide\r\n                  key={slideIdx}\r\n                  style={{ ...slideStyle, boxSizing: \"border-box\", backgroundImage: `url(${bgImgSrc})` }}\r\n                  {...slideOtherProps}\r\n                >\r\n                  {divContent}\r\n                </SwiperSlide>\r\n              );\r\n            })\r\n          : null}\r\n      </Swiper>\r\n    </React.Fragment>\r\n  );\r\n};\r\nCSwiper.defaultProps = cswiperDefaultProps;\r\nexport default CSwiper;\r\n","import React from \"react\";\r\n\r\nexport interface DiscountTagPropTypes {\r\n  time?: string;\r\n  discount?: string;\r\n  size?: number;\r\n  paddingPercentOfSize?: number;\r\n  bgImgUrl?: string;\r\n}\r\n\r\nconst discountsDefaultProps: DiscountTagPropTypes = {\r\n  time: \"\",\r\n  discount: \"\",\r\n  size: 65,\r\n  paddingPercentOfSize: 15,\r\n  bgImgUrl: \"https://raw.githubusercontent.com/carmnk/resources/main/ens/images/discounts.png\",\r\n};\r\n\r\nexport const DiscountTag = (props: DiscountTagPropTypes = discountsDefaultProps) => {\r\n  const { time, discount, size = 65, bgImgUrl, paddingPercentOfSize=15 } = props;\r\n\r\n  const padding = Math.round(paddingPercentOfSize/100 * size);\r\n  const upperTextHeightPercent = 45;\r\n  const lowerTextHeightPercent = 55;\r\n  const heightUpperText = Math.round((((size - 2 * padding) * upperTextHeightPercent) / 100) * 0.6);\r\n  const heightLowerText = Math.round((((size - 2 * padding) * lowerTextHeightPercent) / 100) * 0.75);\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        height: size,\r\n        width: size,\r\n        maxWidth: size,\r\n        background: `url(${bgImgUrl})`,\r\n        backgroundSize: \"cover\",\r\n        textAlign: \"center\",\r\n        padding: padding,\r\n        boxSizing: \"border-box\",\r\n        color: \"#fff\",\r\n        display: \"grid\",\r\n        gridTemplateRows: `${upperTextHeightPercent}% ${lowerTextHeightPercent}%`,\r\n        gridTemplateColumns: \"1fr\",\r\n        alignItems: \"center\",\r\n        margin: 0,\r\n      }}\r\n      \r\n    >\r\n      <div>\r\n        <p style={{ fontSize: heightUpperText, margin: 0 }}>{time}</p>\r\n      </div>\r\n      <div>\r\n        <p style={{ fontSize: heightLowerText, margin: 0, fontWeight: 500 }}>{discount}</p>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\nDiscountTag.defaultProps = discountsDefaultProps;\r\nexport default DiscountTag;\r\n","import React from \"react\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport Card, { CardProps } from \"@material-ui/core/Card\";\r\nimport CardActionArea, { CardActionAreaProps } from \"@material-ui/core/CardActionArea\";\r\nimport CardActions, { CardActionsProps } from \"@material-ui/core/CardActions\";\r\nimport CardContent, { CardContentProps } from \"@material-ui/core/CardContent\";\r\nimport CardMedia, { CardMediaProps } from \"@material-ui/core/CardMedia\";\r\nimport CardHeader, { CardHeaderProps } from \"@material-ui/core/CardHeader\";\r\n\r\nconst useStyles = makeStyles({\r\n  headerAction: {\r\n    margin: 0,\r\n  },\r\n});\r\n\r\n/** CCardPropTypes */\r\nexport interface CCardPropTypes {\r\n  /** max-width of whole card */\r\n  cardMaxWidth?: number;\r\n  /** content displayed (below header and media/image)*/\r\n  content?: React.ReactNode;\r\n  /** [Mui paper elevation](https://material-ui.com/api/paper/)*/\r\n  elevation?: number;\r\n  /** content displayed in static footer*/\r\n  footerContent?: React.ReactNode;\r\n  /** content (typically IconButton) to display in right section of header*/\r\n  headerAction?: React.ReactNode;\r\n  /** content (typically Avatar) to display in left section of header*/\r\n  headerAvatar?: React.ReactNode;\r\n  /** header subtitle*/\r\n  headerSubTitle?: React.ReactNode;\r\n  /** header title*/\r\n  headerTitle?: React.ReactNode;\r\n  /** src for image*/\r\n  imageSrc?: string;\r\n  /** image hover tooltip*/\r\n  imageToolTip?: string;\r\n  /** overlay content for media section */\r\n  mediaContent?: React.ReactNode;\r\n  /** height  of media/image */\r\n  mediaHeight?: number;\r\n  /** [material ui CardActionAreaProps](https://material-ui.com/api/card-action-area/)\r\n   * @nospec\r\n   */\r\n  muiCardActionAreaProps?: CardActionAreaProps;\r\n  /** [material ui CardActionsProps](https://material-ui.com/api/card-actions/)\r\n   * @nospec\r\n   */\r\n  muiCardActionsProps?: CardActionsProps;\r\n  /** [material ui CardContentProps](https://material-ui.com/api/card-content/)\r\n   * @nospec\r\n   */\r\n  muiCardContentProps?: CardContentProps;\r\n  /** [material ui CardHeaderProps](https://material-ui.com/api/card-header/)\r\n   * @nospec\r\n   */\r\n  muiCardHeaderProps?: CardHeaderProps;\r\n  /** [material ui CardMediaProps](https://material-ui.com/api/card-media/)\r\n   * @nospec\r\n   */\r\n  muiCardMediaProps?: CardMediaProps;\r\n  /** [material ui CardMediaProps](https://material-ui.com/api/card/)\r\n   * @nospec\r\n   */\r\n  muiCardProps?: CardProps;\r\n  /** use mui ActionArea for Click/Tap events covering Media and Content */\r\n  useActionArea?: boolean;\r\n  /** use content section */\r\n  useContent?: boolean;\r\n  /** use static footer */\r\n  useFooter?: boolean;\r\n  /** use card header */\r\n  useHeader?: boolean;\r\n  /** use media section */\r\n  useMedia?: boolean;\r\n  /** callback fired when ActionArea is clicked */\r\n  onActionAreaClick?: ((event: React.MouseEvent<HTMLButtonElement, MouseEvent>) => void) | undefined;\r\n}\r\n\r\nconst ccardDefaultProps: CCardPropTypes = {\r\n  cardMaxWidth: 320,\r\n  content: null,\r\n  elevation: 8,\r\n  footerContent: null,\r\n  headerAction: null,\r\n  headerAvatar: null,\r\n  headerSubTitle: null,\r\n  headerTitle: null,\r\n  imageSrc: \"#\",\r\n  imageToolTip: \"\",\r\n  mediaContent: null,\r\n  mediaHeight: 240,\r\n  muiCardActionAreaProps: {},\r\n  muiCardActionsProps: {},\r\n  muiCardContentProps: {},\r\n  muiCardHeaderProps: {},\r\n  muiCardMediaProps: {},\r\n  muiCardProps: {},\r\n  useActionArea: true,\r\n  useContent: true,\r\n  useFooter: true,\r\n  useHeader: true,\r\n  useMedia: true,\r\n  onActionAreaClick: undefined,\r\n};\r\n\r\n/** CCard Component\r\n * @remark A simple card component using Material UI's Card component\r\n * @docu\r\n */\r\nexport const CCard = (props: CCardPropTypes) => {\r\n  const {\r\n    cardMaxWidth,\r\n    content,\r\n    elevation,\r\n    footerContent,\r\n    headerAction,\r\n    headerAvatar,\r\n    headerSubTitle,\r\n    headerTitle,\r\n    imageSrc,\r\n    imageToolTip,\r\n    mediaContent,\r\n    mediaHeight,\r\n    muiCardActionAreaProps,\r\n    muiCardActionsProps,\r\n    muiCardContentProps,\r\n    muiCardHeaderProps,\r\n    muiCardMediaProps,\r\n    muiCardProps,\r\n    useActionArea,\r\n    useContent,\r\n    useFooter,\r\n    useHeader,\r\n    useMedia,\r\n    onActionAreaClick = undefined,\r\n  } = props;\r\n\r\n  const classes = useStyles();\r\n\r\n  const headerProps: any = {};\r\n  if (!!headerAvatar) headerProps.avatar = headerAvatar;\r\n  if (!!headerAction) headerProps.action = headerAction;\r\n  if (!!headerTitle) headerProps.title = headerTitle;\r\n  if (!!headerSubTitle) headerProps.subheader = headerSubTitle;\r\n\r\n  const cardContent = (\r\n    <React.Fragment>\r\n      {useMedia ? (\r\n        <CardMedia\r\n          image={imageSrc}\r\n          title={imageToolTip}\r\n          style={{ height: mediaHeight, position: \"relative\", top: 0 }}\r\n          {...muiCardMediaProps}\r\n        >\r\n          {mediaContent}\r\n        </CardMedia>\r\n      ) : null}\r\n      {useContent ? <CardContent {...muiCardContentProps}>{content}</CardContent> : null}\r\n    </React.Fragment>\r\n  );\r\n\r\n  return (\r\n    <Card elevation={elevation} style={{ maxWidth: cardMaxWidth }} {...muiCardProps}>\r\n      {useHeader ? (\r\n        <CardHeader classes={{ action: classes.headerAction }} {...headerProps} {...muiCardHeaderProps} />\r\n      ) : null}\r\n      {useActionArea ? (\r\n        <CardActionArea onClick={onActionAreaClick} {...muiCardActionAreaProps}>\r\n          {cardContent}\r\n        </CardActionArea>\r\n      ) : (\r\n        cardContent\r\n      )}\r\n      {useFooter ? <CardActions {...muiCardActionsProps}>{footerContent}</CardActions> : null}\r\n    </Card>\r\n  );\r\n};\r\nCCard.defaultProps = ccardDefaultProps;\r\nexport default CCard;\r\n","import { mdiCurrencyEur } from \"@mdi/js\";\r\nimport { Icon } from \"@mdi/react\";\r\nimport React from \"react\";\r\nimport DiscountTag from \"./Components/Specific/DiscountTag\";\r\nimport CCard from \"./Components/CCard\";\r\nimport CSwiper from \"./Components/CSwiper\";\r\nimport { Chip, Theme, Typography } from \"@material-ui/core\";\r\nimport { Link, useHistory } from \"react-router-dom\";\r\n\r\nexport const createDiscountTagsSlides = (discounts: any) => {\r\n  const result = [];\r\n  for (let discount of discounts) {\r\n    result.push({\r\n      divContent: <DiscountTag time={discount.time} discount={discount.discount} size={65} />,\r\n      style: { width: 85 },\r\n    });\r\n  }\r\n  return result;\r\n};\r\n\r\nexport const createPriceIcons = (price: number, color: string) => {\r\n  const priceElements = [];\r\n  for (let i = 0; i < price; i++) {\r\n    priceElements.push(\r\n      <Icon\r\n        key={i}\r\n        path={mdiCurrencyEur}\r\n        size={\"13px\"}\r\n        color=\"#fff\"\r\n        style={{ border: `4px solid ${color}`, borderRadius: \"50%\", background: color }}\r\n      />\r\n    );\r\n  }\r\n  return priceElements;\r\n};\r\n\r\nexport const createProviderCard = (providerData: any, theme: Theme, routeTo?: () => void) => {\r\n  return (\r\n    <div style={{ padding: \"20px 10px\", boxSizing: \"border-box\" }}>\r\n      <CCard\r\n        useHeader={false}\r\n        useFooter={false}\r\n        mediaHeight={192}\r\n        cardMaxWidth={256}\r\n        elevation={2}\r\n        imageSrc={providerData.img}\r\n        imageToolTip={providerData.name}\r\n        onActionAreaClick={(e) => {\r\n          routeTo?.();\r\n          console.log(routeTo);\r\n        }}\r\n        mediaContent={\r\n          <div\r\n            style={{\r\n              position: \"absolute\",\r\n              bottom: 0,\r\n              width: \"100%\",\r\n              height: 75,\r\n              overflow: \"hidden\",\r\n              zIndex: 15021987,\r\n            }}\r\n            title=\"discount badges are at top of card stack!\"\r\n            onClick={(e) => {\r\n              e.stopPropagation();\r\n            }}\r\n          >\r\n            <CSwiper\r\n              onClick={(swiper) => {\r\n                alert(\r\n                  \"slide No.\" +\r\n                    swiper.clickedIndex +\r\n                    \" clicked, value is: \" +\r\n                    providerData.discountVals[swiper.clickedIndex].time +\r\n                    \" @ \" +\r\n                    providerData.discountVals[swiper.clickedIndex].discount\r\n                );\r\n              }}\r\n              slidesPerView={\"auto\"}\r\n              navigation={false}\r\n              pagination={false}\r\n              slides={createDiscountTagsSlides(providerData.discountVals)}\r\n            ></CSwiper>\r\n          </div>\r\n        }\r\n        content={\r\n          <React.Fragment>\r\n            <Typography gutterBottom variant=\"h5\" component=\"h2\">\r\n              {providerData.name}\r\n            </Typography>\r\n            <div style={{ display: \"grid\", gridTemplateColumns: \"auto 66px\" }}>\r\n              <div>\r\n                <Typography variant=\"body2\" color=\"textSecondary\" component=\"p\">\r\n                  {providerData.info}\r\n                </Typography>\r\n              </div>\r\n              <div>\r\n                {createPriceIcons(providerData.price, theme.palette.primary.main).map((priceEl, priceElIdx) => priceEl)}\r\n              </div>\r\n            </div>\r\n          </React.Fragment>\r\n        }\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const createSkillChipSlide = (title: string, style?: any, onClick?: () => void) => {\r\n  return {\r\n    style: {\r\n      width: \"max-content\",\r\n    },\r\n    divContent: (\r\n      <Chip\r\n        label={<Typography>{title}</Typography>}\r\n        clickable={true}\r\n        variant=\"outlined\"\r\n        size=\"medium\"\r\n        style={style}\r\n        onClick={onClick}\r\n      />\r\n    ),\r\n  };\r\n};\r\n","import {\r\n  Container,\r\n  IconButton,\r\n  List,\r\n  ListItem,\r\n  ListItemIcon,\r\n  ListItemText,\r\n  Typography,\r\n  useMediaQuery,\r\n  useTheme,\r\n} from \"@material-ui/core\";\r\nimport {\r\n  mdiAccount,\r\n  mdiClipboardCheck,\r\n  mdiCodeTags,\r\n  mdiFire,\r\n  mdiGithub,\r\n  mdiLinkedin,\r\n  mdiMail,\r\n  mdiMapMarker,\r\n} from \"@mdi/js\";\r\nimport Icon from \"@mdi/react\";\r\nimport React from \"react\";\r\nimport { createSkillChipSlide } from \"../ComponentFactory\";\r\nimport CSwiper from \"../Components/CSwiper\";\r\n\r\nexport const Search = (props: any) => {\r\n  const now = new Date();\r\n  const hour = now.getHours();\r\n  let inTwoHours = hour + 2;\r\n  let day = \"today\";\r\n  if (hour + 2 > 24) {\r\n    inTwoHours = hour + 2 - 24;\r\n    day = \"tomrrow\";\r\n  }\r\n\r\n  const theme = useTheme();\r\n  const matches = useMediaQuery(theme.breakpoints.up(\"sm\"));\r\n  return (\r\n    <div >\r\n      <div\r\n        style={{\r\n          display: \"grid\",\r\n          gridTemplateColumns: \"auto 128px\",\r\n          alignItems: \"center\",\r\n          marginTop: !!matches ? theme.spacing(6) : theme.spacing(2.5),\r\n        }}\r\n      >\r\n        <div>\r\n          <List component=\"nav\" aria-label=\"main mailbox folders\">\r\n            <ListItem button style={{ margin: `${theme.spacing(1)} 0` }}>\r\n              <ListItemIcon>\r\n                <Icon path={mdiFire} color={theme.palette.primary.main} size={\"40px\"} />\r\n              </ListItemIcon>\r\n              <Typography variant=\"h6\" component=\"nav\">\r\n                News\r\n              </Typography>\r\n            </ListItem>\r\n            <ListItem button style={{ margin: `${theme.spacing(1)} 0` }}>\r\n              <ListItemIcon>\r\n                <Icon path={mdiClipboardCheck} color={theme.palette.primary.main} size={\"32px\"} />\r\n              </ListItemIcon>\r\n              <Typography variant=\"h6\" component=\"nav\">\r\n                Projects\r\n              </Typography>\r\n            </ListItem>\r\n            <ListItem button style={{ margin: `${theme.spacing(1)} 0` }}>\r\n              <ListItemIcon>\r\n                <Icon path={mdiAccount} color={theme.palette.primary.main} size={\"32px\"} />\r\n              </ListItemIcon>\r\n              <Typography variant=\"h6\" component=\"nav\">\r\n                About Me\r\n              </Typography>\r\n            </ListItem>\r\n            <ListItem button style={{ margin: `${theme.spacing(1)} 0` }}>\r\n              <ListItemIcon>\r\n                <Icon path={mdiCodeTags} color={theme.palette.primary.main} size={\"32px\"} />\r\n              </ListItemIcon>\r\n              <Typography variant=\"h6\" component=\"nav\">\r\n                Coding\r\n              </Typography>\r\n            </ListItem>\r\n          </List>\r\n        </div>\r\n        <div style={{ justifySelf: \"center\" }}>\r\n          <img\r\n            src=\"https://github.com/carmnk/resources/raw/main/images/profil.jpg\"\r\n            style={{ borderRadius: \"50%\", width: 96 }}\r\n          />\r\n        </div>\r\n      </div>\r\n      <div style={{ marginTop: !!matches ? theme.spacing(5) : theme.spacing(1) }}>\r\n        <CSwiper\r\n          spaceBetween={10}\r\n          slidesPerView={\"auto\"}\r\n          navigation={false}\r\n          pagination={{ type: \"progressbar\" }}\r\n          freeMode={true}\r\n          height={50}\r\n          slides={[\r\n            createSkillChipSlide(\"Fullstack\", { background: theme.palette.primary.main }),\r\n            createSkillChipSlide(\"Typescript\", { background: theme.palette.primary.main }),\r\n            createSkillChipSlide(\"React\", { background: theme.palette.primary.main }),\r\n            createSkillChipSlide(\"Node.js\", { background: theme.palette.primary.main }),\r\n            createSkillChipSlide(\"Mongo/NoSQL\", { background: theme.palette.primary.main }),\r\n            createSkillChipSlide(\"Vanilla JS\", { background: \"#fff\" }),\r\n            createSkillChipSlide(\"CSS/JSS\", { background: \"#fff\" }),\r\n            createSkillChipSlide(\"HTML\", { background: \"#fff\" }),\r\n          ]}\r\n        />\r\n      </div>\r\n      <div\r\n        style={{\r\n          display: \"grid\",\r\n          alignItems: \"center\",\r\n          justifyItems: \"center\",\r\n          marginTop: !!matches ? theme.spacing(3) : theme.spacing(1),\r\n        }}\r\n      >\r\n        <div>\r\n          <IconButton color=\"primary\" size=\"small\" onClick={() => {}}>\r\n            <Icon path={mdiLinkedin} size={\"48px\"} />\r\n          </IconButton>\r\n          <IconButton color=\"primary\" size=\"small\" onClick={() => {}}>\r\n            <Icon path={mdiGithub} size=\"48px\" />\r\n          </IconButton>\r\n          <IconButton color=\"primary\" size=\"small\" onClick={() => {}}>\r\n            <Icon path={mdiMapMarker} size=\"48px\" />\r\n          </IconButton>\r\n          <IconButton color=\"primary\" size=\"medium\" onClick={() => {}}>\r\n            <Icon path={mdiMail} size=\"48px\" />\r\n          </IconButton>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\nexport default Search;\r\n","import React from \"react\";\r\nimport { Container, Fab, IconButton, Paper, Typography, useMediaQuery, useTheme } from \"@material-ui/core\";\r\nimport Icon from \"@mdi/react\";\r\nimport { mdiChevronUp, mdiClose, mdiMenu } from \"@mdi/js\";\r\nimport Menu from \"./Pages/Menu\";\r\n\r\n\r\nexport const Layout = (props: any) => {\r\n    const { menuOpen, setMenuOpen } = props;\r\n    // const MenuOpenRef = React.useRef(menuOpen);\r\n\r\n    // React.useEffect(() => {\r\n    //     if (menuOpen !== MenuOpenRef.current) MenuOpenRef.current = menuOpen;\r\n    // }, [menuOpen])\r\n\r\n    const theme = useTheme(); \r\n    const matches = useMediaQuery(theme.breakpoints.up(\"sm\"));\r\n    console.log(menuOpen)\r\n    const imgHeader = !menuOpen ? \"Want your coding job done in no time?\" : \"carmnk - web and app developer\";\r\n    return (\r\n      <div style={{ position: \"absolute\", top: 0, left: 0, width: \"100%\", height: \"100%\", overflowY: \"scroll\" }}>\r\n        <div style={{ position: \"absolute\", top: 0, left: 0, width: \"100%\", height: \"100%\" }}>{props.children}</div>\r\n        <div style={{ position: \"absolute\", top: 0, left: 0, width: \"100%\", height: \"100%\", zIndex: 2000 }}>\r\n          {/* <Container maxWidth=\"md\" disableGutters> */}\r\n          <div\r\n            style={{\r\n              visibility: !menuOpen ? \"hidden\" : \"visible\",\r\n              position: \"absolute\",\r\n              top: 0,\r\n              width: \"100%\",\r\n              height: !!matches ? 544 : 448,\r\n              background: \"#333\",\r\n            }}\r\n          >\r\n            <Container maxWidth=\"md\" style={{ position: \"relative\", top: 0 }} disableGutters>\r\n              <Menu />\r\n            </Container>\r\n          </div>\r\n        </div>\r\n        <div\r\n          style={{\r\n            position: \"absolute\",\r\n            top: 0,\r\n            width: \"100%\",\r\n            height: 544,\r\n            zIndex: 15021987,\r\n            paddingTop: !menuOpen ? 100 : 0,\r\n            transition: `padding 0.1s ease, width 0.1s ease`,\r\n          }}\r\n          onClick={() => {\r\n            setMenuOpen(true);\r\n          }}\r\n        >\r\n          <Container maxWidth=\"md\" style={{ position: \"relative\", top: 0, boxSizing: \"border-box\" }} disableGutters>\r\n            <Paper\r\n              style={{\r\n                padding: \"10px 0\",\r\n                borderRadius: 100,\r\n                width: !menuOpen ? \"100%\" : \"calc(100% - 50px)\",\r\n\r\n                height: 30,\r\n                textAlign: \"center\",\r\n                transition: `padding 0.1s ease, width 0.1s ease`,\r\n              }}\r\n              onClick={() => {\r\n                setMenuOpen?.(true);\r\n                console.log(setMenuOpen);\r\n              }}\r\n            >\r\n              <Typography variant=\"h5\" color=\"primary\">\r\n                {imgHeader}\r\n              </Typography>\r\n            </Paper>\r\n            <div style={{ display: !menuOpen ? \"none\" : \"block\", position: \"absolute\", top: 0, right: 0, width: 48 }}>\r\n              <IconButton\r\n                color=\"primary\"\r\n                size=\"small\"\r\n                style={{ padding: 0 }}\r\n                onClick={(e) => {\r\n                    e.stopPropagation();\r\n                    setMenuOpen?.(false);\r\n                    \r\n                }}\r\n              >\r\n                <Icon path={mdiClose} size=\"48px\" />\r\n              </IconButton>\r\n            </div>\r\n          </Container>\r\n        </div>\r\n\r\n        <Fab color=\"secondary\" aria-label=\"add\" style={{ position: \"fixed\", bottom: 20, right: 70 }}>\r\n          <Icon color=\"white\" path={mdiChevronUp} size=\"32px\" />\r\n        </Fab>\r\n        <Fab color=\"secondary\" aria-label=\"add\" style={{ position: \"fixed\", bottom: 20, right: 20 }}>\r\n          <Icon color=\"white\" path={mdiMenu} size=\"32px\" />\r\n        </Fab>\r\n      </div>\r\n    );\r\n};\r\nexport default Layout;\r\n","import React from \"react\";\r\nimport CSwiper from \"../Components/CSwiper\";\r\nimport { createSkillChipSlide } from \"../ComponentFactory\";\r\nimport {\r\n  Chip,\r\n  Container,\r\n  IconButton,\r\n  makeStyles,\r\n  Paper,\r\n  Theme,\r\n  Typography,\r\n  useMediaQuery,\r\n  useTheme,\r\n} from \"@material-ui/core\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport { mdiFire } from \"@mdi/js\";\r\nimport Icon from \"@mdi/react\";\r\nimport { Link, useHistory } from \"react-router-dom\";\r\nimport Layout from \"../Layout\";\r\n\r\nconst useSwiperStyles = makeStyles((theme: Theme) => ({\r\n  \"@global\": {\r\n    \".swiper-pagination-progressbar-fill\": {\r\n      background: theme.palette.primary.main + \" !important\",\r\n    },\r\n    \".swiper-pagination\": {\r\n      bottom: \"0px !important\",\r\n      top: \"45px !important\",\r\n      height: \"2px !important\",\r\n    },\r\n  },\r\n}));\r\n\r\nexport const Home = (props: any) => {\r\n  const { menuOpen, setMenuOpen } = props;\r\n  const theme = useTheme();\r\n  const [Toggle, setToggle] = React.useState(true);\r\n  // const [ActiveLocation, setActiveLocation] = React.useState(0);\r\n  // const history = useHistory();\r\n  const matches = useMediaQuery(theme.breakpoints.up(\"sm\"));\r\n  // const [IsSearching, setIsSearching] = React.useState(false);\r\n  useSwiperStyles();\r\n  const activeLocationStyle = { background: theme.palette.primary.main };\r\n  const imgHeader = !menuOpen ? \"Want your coding job done in no time?\" : \"carmnk - web and app developer\";\r\n  return (\r\n    <React.Fragment>\r\n      <Layout menuOpen={menuOpen} setMenuOpen={setMenuOpen}>\r\n        <div style={{ position: \"relative\", top: 0, background: \"#333\", paddingBottom: !!matches ? 32 : 64 }}>\r\n          <Container style={{ position: \"relative\", top: 0, boxSizing: \"border-box\" }} disableGutters maxWidth=\"md\">\r\n            <div\r\n              style={{\r\n                height: !!matches ? 512 : 384,\r\n                opacity: !menuOpen ? 1 : 0,\r\n                position: \"relative\",\r\n                top: 0,\r\n                backgroundSize: \"cover\",\r\n                boxSizing: \"border-box\",\r\n                backgroundImage: \"url(https://github.com/carmnk/resources/raw/main/images/IMG_20200806_115021.jpg)\",\r\n                backgroundPosition: \"bottom\",\r\n                borderRadius: 10,\r\n              }}\r\n            />\r\n          </Container>\r\n        </div>\r\n\r\n        <div style={{ textAlign: \"center\", margin: 20 }}>\r\n          <Typography color=\"secondary\" variant=\"h2\" component=\"h1\">\r\n            Hi I'm carmnk, web and app developer\r\n          </Typography>\r\n          <Typography color=\"textSecondary\" variant=\"h3\" component=\"h2\">\r\n            focussing on React projects\r\n          </Typography>\r\n        </div>\r\n        <Container maxWidth=\"md\" style={{ marginTop: 20, paddingBottom: 20 }}>\r\n          <CSwiper\r\n            spaceBetween={10}\r\n            slidesPerView={\"auto\"}\r\n            navigation={false}\r\n            pagination={{ type: \"progressbar\" }}\r\n            freeMode={true}\r\n            height={50}\r\n            slides={[\r\n              createSkillChipSlide(\"Fullstack\", activeLocationStyle),\r\n              createSkillChipSlide(\"Typescript\", activeLocationStyle),\r\n              createSkillChipSlide(\"React\", activeLocationStyle),\r\n              createSkillChipSlide(\"Node.js\", activeLocationStyle),\r\n              createSkillChipSlide(\"Mongo/NoSQL\", activeLocationStyle),\r\n              createSkillChipSlide(\"Vanilla JS\", {}),\r\n              createSkillChipSlide(\"CSS/JSS\"),\r\n              createSkillChipSlide(\"HTML\", {}),\r\n            ]}\r\n          />\r\n          <div\r\n            style={{\r\n              display: \"grid\",\r\n              gridTemplateColumns: \"32px auto max-content\",\r\n              marginTop: 20,\r\n              alignItems: \"center\",\r\n            }}\r\n          >\r\n            <div>\r\n              <Icon path={mdiFire} color={theme.palette.primary.main} size={\"32px\"} />\r\n            </div>\r\n            <div>\r\n              <Typography component=\"span\">Trending</Typography>\r\n            </div>\r\n            <div>\r\n              <Typography component=\"span\" color=\"primary\">\r\n                view all\r\n              </Typography>\r\n            </div>\r\n          </div>\r\n          <div>\r\n            <Button\r\n              color=\"primary\"\r\n              onClick={() => {\r\n                setToggle(!Toggle);\r\n              }}\r\n            >\r\n              Toggle\r\n            </Button>\r\n          </div>\r\n          <Typography variant=\"h1\">Typo Header H1</Typography>\r\n          <Typography variant=\"h2\">Typo Header H2</Typography>\r\n          <Typography variant=\"h3\">Typo Header H3</Typography>\r\n          <Typography variant=\"h4\">Typo Header H3</Typography>\r\n          <Typography variant=\"h5\">Typo Header H3</Typography>\r\n          <Typography variant=\"h6\">Typo Header H3</Typography>\r\n          <Typography variant=\"body1\">Typo Header Body1</Typography>\r\n          <Typography variant=\"body2\">Typo Header Body2</Typography>\r\n        </Container>\r\n      </Layout>\r\n    </React.Fragment>\r\n  );\r\n};\r\nexport default Home;\r\n","/** Data types */\r\n\r\nimport {\r\n  CommonGestureState,\r\n  Coordinates,\r\n  DragState,\r\n  FullGestureState,\r\n  SharedGestureState,\r\n} from \"react-use-gesture/dist/types\";\r\nimport { ExcludeEmpty, ReducerActionTaskType, ReducerActionType } from \"../ChartState/CChartStateReducer\";\r\nimport { ChartPeriodType, DateStatType } from \"./CChartTimeTypes\";\r\nimport { ChartDataSeries, ChartDataset, DataSeries, IndicatorDataSeries, IndicatorDataset } from \"./CChartTypes\";\r\n\r\nexport type UseGestureStateType = {\r\n  drag: CommonGestureState & Coordinates & DragState & SharedGestureState;\r\n  move: Omit<FullGestureState<\"move\">, \"event\"> & {\r\n    event: React.PointerEvent<Element> | PointerEvent;\r\n  };\r\n  hover: Omit<FullGestureState<\"move\">, \"event\"> & {\r\n    event: React.PointerEvent<Element> | PointerEvent;\r\n  };\r\n  wheel: CommonGestureState & Coordinates;\r\n  dragEnd: CommonGestureState & Coordinates & DragState & SharedGestureState;\r\n};\r\n\r\n/** Interactive State */\r\nexport type InteractiveContainerSizeType = {\r\n  top: number;\r\n  left: number;\r\n  width: number;\r\n  height: number;\r\n  init: boolean;\r\n};\r\n\r\nexport type InteractivePointerType = {\r\n  isHovering: boolean;\r\n  move: { isMoving: boolean; xy: [number, number] };\r\n  drag: {\r\n    isDragging: boolean;\r\n    xy: [number, number];\r\n    initial: [number, number];\r\n    delta: [number, number];\r\n    first: boolean;\r\n    last: boolean;\r\n    movementInitial: [number, number];\r\n  };\r\n  dragPointerUp: {\r\n    isDragPointerUp: boolean;\r\n    xy: [number, number];\r\n    initial: [number, number];\r\n    first: boolean;\r\n    last: boolean;\r\n    movementInitial: [number, number];\r\n  };\r\n  wheel: { isWheeling: boolean; delta: [number, number] };\r\n  chartPointer: {\r\n    move: {\r\n      pixX: number;\r\n      pixXSnap: number;\r\n      pixY: number;\r\n      x: number|null;\r\n      xUnlimited : number;\r\n      xDateString: string;\r\n      subchartIdx: number;\r\n      snapDatasets: {\r\n        yaxisIdx: number;\r\n        graphIdx: number;\r\n        y: number;\r\n        ySnap: string | null;\r\n        pixYSnap: number | null;\r\n        data: ChartDataset | IndicatorDataset;\r\n        dateString: string;\r\n      }[];\r\n    };\r\n    click: {\r\n      clickedSubchartIdx: number | null;\r\n    };\r\n  };\r\n};\r\n\r\nexport type InteractiveXaxisCalcs = {\r\n  xStart: number;\r\n  pixXStart: number;\r\n  xEnd: number;\r\n  pixXEnd: number;\r\n  widthPerTick: number;\r\n  startNoDataPeriod: number;\r\n  endNoDataPeriod: number;\r\n  noDataPeriodPortion: number;\r\n  xAxisTicks: { x: number; dateString: string }[];\r\n  optPeriodRes: ChartPeriodType | null;\r\n};\r\n\r\nexport type InteractiveXaxisType = {\r\n  totalTranslatedX: number;\r\n  totalScaleX: number; //only int\r\n  scaledWidthPerTick: number;\r\n} & InteractiveXaxisCalcs;\r\n\r\nexport type InteractiveStateType = {\r\n  pointer: InteractivePointerType;\r\n  containerSize: InteractiveContainerSizeType;\r\n  xaxis: InteractiveXaxisType;\r\n};\r\n\r\n///////////////////////////////////////\r\n\r\nexport type ChartPreStateRefType = InteractiveStateType & {\r\n  lastUpdate: Date;\r\n  shallUpdate: (\"drag\" | \"pointerMove\" | \"wheel\" | \"dragEnd\" | \"containerResize\" | \"deps\")[];\r\n  tmp: {\r\n    scaleInitWidthPerTick: number | null;\r\n    scaleInitTranslatedX: number;\r\n    dragActionType:\r\n      | null\r\n      | { type: \"translate\" | \"scale\" }\r\n      | { type: \"resizeSubchart\"; res: number; initBottom: number }\r\n      | { type: \"editTool\"; res: [number, number, number, number][]; init: [number, number] }\r\n      | { type: \"drawTool\"; init: [number, number] };\r\n  };\r\n  userInteractedChartState: any;\r\n};\r\n\r\n/** SubCharts State */\r\nexport type GraphStateType<AdditionalGraphProps = {}> = {\r\n  data: DataSeries;\r\n  style: {\r\n    strokeColor: string[];\r\n  };\r\n  name: string;\r\n  type: \"chart\" | \"indicator\" | \"formula\";\r\n  decimals: number;\r\n  curData?: GraphStateType[\"data\"];\r\n  yMax: number;\r\n  yMaxExact: number;\r\n  yMin: number;\r\n  yMinExact: number;\r\n  // drawPixXy: [number, number][];\r\n  datasets: {\r\n    first: {\r\n      x: number;\r\n      pixX: number;\r\n      data: ChartDataset | IndicatorDataset;\r\n      dateString: string;\r\n    } | null;\r\n    last: {\r\n      x: number;\r\n      pixX: number;\r\n      data: ChartDataset | IndicatorDataset;\r\n      dateString: string;\r\n    } | null;\r\n  };\r\n} & AdditionalGraphProps;\r\n\r\nexport type AdditionalChartGraphStateType = {\r\n  data: ChartDataSeries;\r\n  dateStat: DateStatType;\r\n  meta: {\r\n    nData: number;\r\n    chartPeriod: ChartPeriodType | null;\r\n    dataPeriod: number;\r\n    periodGuessConfidence: number;\r\n    tradingDaysPerWeek: number;\r\n    tradingDaysPerWeekGuessConfidence: number;\r\n    type: \"candlechart\" | \"linechart\";\r\n  };\r\n  style: {\r\n    candleStrokeColor: string;\r\n    candleDownColor: string;\r\n    candleUpColor: string;\r\n  };\r\n};\r\n\r\nexport type AdditionalIndicatorGraphStateType = {\r\n  data: IndicatorDataSeries;\r\n  indicator: {\r\n    name: string;\r\n    params: { name: string; val: number }[];\r\n    type: \"line\" | \"bars\";\r\n    default: {\r\n      params: { name: string; val: number }[];\r\n      newSubchart: boolean;\r\n      fixedYScale?: [number, number]; //\r\n      decimals?: number; //\r\n    };\r\n    indicatorFn: (chartData: ChartDataset[], chartName: string, ...other: any[]) => IndicatorDataSeries;\r\n    \r\n  };\r\n};\r\n\r\nexport type ChartGraphStateType = GraphStateType<AdditionalChartGraphStateType>;\r\nexport type IndicatorGraphStateType = Omit<GraphStateType, \"data\" | \"style\"> &\r\n  AdditionalIndicatorGraphStateType & {\r\n    style: {\r\n      strokeColor: string[];\r\n    };\r\n  };\r\n\r\nexport const isIndicatorGraph = (graph: GraphStateType): graph is GraphStateType<AdditionalIndicatorGraphStateType> => {\r\n  if (graph.type === \"indicator\") return true;\r\n  return false;\r\n};\r\nexport const isChartGraph = (graph: GraphStateType): graph is GraphStateType<AdditionalChartGraphStateType> => {\r\n  if (graph.type === \"chart\") return true;\r\n  return false;\r\n};\r\nexport type DrawingTool = {\r\n  xy: [number, number][];\r\n  type: \"hline\" | \"vline\" | \"trendline\";\r\n  style: {\r\n    strokeColor: string;\r\n    anchorColor: string;\r\n  };\r\n  params?: { [key: string]: any };\r\n};\r\n\r\nexport type userInteractsSubchartStateType = {\r\n  yaxis: {\r\n    graphs: {\r\n      data?: DataSeries;\r\n      style: {\r\n        strokeColor: string[];\r\n      };\r\n      name: string;\r\n      type: \"chart\" | \"indicator\" | \"formula\";\r\n      decimals: number;\r\n    }[];\r\n    tools: Pick<DrawingTool, \"params\" | \"type\" | \"style\">[];\r\n    decimals: number;\r\n  }[];\r\n  // top: number;\r\n  // bottom: number;\r\n}[];\r\n\r\nexport type SubchartStateType = {\r\n  yaxis: YaxisStateType[];\r\n  top: number;\r\n  bottom: number;\r\n};\r\n\r\nexport type YaxisStateType<pure = \"false\"> = {\r\n  graphs: GraphStateType[];\r\n  tools: DrawingTool[];\r\n  decimals: number;\r\n\r\n  optIntervalY: number;\r\n  heightPerPt: number; // yaxis\r\n  translatedY: number; // yaxis\r\n  drawTicks: { pixY: number; label: string }[];\r\n};\r\n\r\n/** ChartState */\r\n\r\nexport type ChartStateType = {\r\n  xaxis: {\r\n    heightXAxis: number;\r\n    heightTickMarkLines: number;\r\n    style: {\r\n      fillColor: string;\r\n      strokeColor: string;\r\n      fontColor: string;\r\n      fontSize: number;\r\n      fontName: string;\r\n    };\r\n  };\r\n  yaxis: {\r\n    widthYAxis: number;\r\n    widthTickmarkLines: number;\r\n    style: {\r\n      fillColor: string;\r\n      strokeColor: string;\r\n      fontColor: string;\r\n      fontSize: number;\r\n      fontName: string;\r\n    };\r\n  };\r\n  grid: {\r\n    useGridX: boolean;\r\n    useGridY: boolean;\r\n    style: {\r\n      strokeColor: string;\r\n      strokeStyle: string;\r\n    };\r\n  };\r\n  backgroundColor: string;\r\n  fullscreen: boolean;\r\n  subCharts: SubchartStateType[];\r\n  draw: Partial<Omit<DrawingTool, \"xy\">> & { isDrawing: boolean; pixXy: [number, number][] };\r\n} & InteractiveStateType;\r\n\r\n/** CalculatedChartState and Hook */\r\n\r\nexport type CalculatedChartStateType = ChartStateType & {\r\n  methods: {\r\n    addSubchart: (\r\n      chartSeries: DataSeries,\r\n      chartName: string,\r\n      indicator?: AdditionalIndicatorGraphStateType[\"indicator\"]\r\n    ) => void;\r\n    addGraph: (\r\n      chartSeries: ChartDataset[],\r\n      chartName: string,\r\n      subchartIdx: number,\r\n      indicator?: AdditionalIndicatorGraphStateType[\"indicator\"]\r\n    ) => void;\r\n    getSubchart: (subchartIdx: number) => SubchartStateType;\r\n    getYaxis: (subchartIdx: number, yaxisIdx: number) => YaxisStateType;\r\n    getGraph: (subchartIdx: number, yaxisIdx: number, graphIdx: number) => GraphStateType;\r\n    xToPix: (x: number, translatedX?: number) => number;\r\n    pixToX: (pixX: number, translatedX?: number) => number;\r\n    yToPix: (y: number, subchartIdx: number, yaxisIdx: number, translatedY?: number) => number;\r\n    pixToY: (pixY: number, subchartIdx: number, yaxisIdx: number, translatedY?: number) => number;\r\n  };\r\n  // drawProps: { graphs: number[][]; yaxis: { y: number; label: string }[][] }[];\r\n};\r\nexport type TypedDispatcher<Action extends ReducerActionTaskType> = React.Dispatch<ReducerActionType<Action>>;\r\nexport type ChartStateHookType<Action extends ReducerActionTaskType = ReducerActionTaskType> = [\r\n  CalculatedChartStateType,\r\n  TypedDispatcher<Action>\r\n];\r\n","export const singleChartDataSchema = {\r\n  type: \"object\",\r\n  properties: {\r\n    data: {\r\n      type: \"array\",\r\n      nullable: false,\r\n      minItems: 2,\r\n      items: {\r\n        type: \"object\",\r\n        nullable: false,\r\n        properties: {\r\n          date: {\r\n            type: \"object\",\r\n            nullable: false,\r\n            // format: \"date-time\",\r\n          },\r\n          open: { type: \"number\", nullable: false },\r\n          high: { type: \"number\", nullable: false },\r\n          low: { type: \"number\", nullable: false },\r\n          close: { type: \"number\", nullable: false },\r\n        },\r\n        required: [\"date\", \"close\"],\r\n      },\r\n    },\r\n    name: { type: \"string\", nullable: false },\r\n  },\r\n  required: [\"data\", \"name\"],\r\n};\r\nexport const chartDataSchema = {\r\n  type: \"array\",\r\n  minItems: 1,\r\n  // additionalItems: true,\r\n  items: singleChartDataSchema,\r\n};\r\n","// /** Data types */\r\n// types for single datasets\r\nexport type LineChartDataset = {\r\n  date: Date;\r\n  close: number;\r\n  volume?: number;\r\n};\r\nexport type CandleChartDataset = LineChartDataset & {\r\n  open: number;\r\n  high: number;\r\n  low: number;\r\n};\r\nexport type ChartDataset = LineChartDataset | CandleChartDataset;\r\nexport type IndicatorDataset = {\r\n  prices: (number | null)[];\r\n  date: Date;\r\n  priceLabels?: string[];\r\n};\r\nexport type Dataset = ChartDataset | IndicatorDataset;\r\n\r\n// type for dataseries\r\nexport type ChartDataSeries = ChartDataset[];\r\nexport type IndicatorDataSeries = IndicatorDataset[];\r\nexport type DataSeries = (ChartDataset | IndicatorDataset)[];\r\n\r\n// type guard for candle chart\r\nexport const isCandleChartDataset = (dataset: Dataset): dataset is CandleChartDataset => {\r\n  if (\"open\" in dataset && \"high\" in dataset && \"low\" in dataset && \"close\" in dataset) return true;\r\n  return false;\r\n};\r\n// doesn't exclude datasets with close property (like CandleChartDataset -> e.g. a CandleChartDataset will also return true)\r\nexport const isLineChartDataset = (dataset: Dataset): dataset is LineChartDataset => {\r\n  // if (!dataset) return false; \r\n  if (\"close\" in dataset) return true;\r\n  return false;\r\n};\r\nexport const isVolumeDataset = (dataset: Dataset): dataset is ChartDataset & { volume: number } => {\r\n  if (\"volume\" in dataset) return true;\r\n  return false;\r\n};\r\n\r\nexport const isIndicatorDataset = (dataset: Dataset): dataset is IndicatorDataset => {\r\n  if (\"prices\" in dataset) return true;\r\n  return false;\r\n};\r\n\r\n/** CChart Prop types */\r\n// type for chartData prop\r\nexport type ChartDataProp = { data: ChartDataset[]; name: string }[];\r\n\r\n// todo -> chart styling props\r\nexport type StyleProp = \"TODO\"; \r\n\r\n// type of CChart props\r\nexport type CChartProps = {\r\n  chartData: ChartDataProp;\r\n  style: StyleProp;\r\n  width?: number;\r\n  height?: number;\r\n  viewMode?: \"static\" | \"responsive\" | \"fullscreen\"\r\n};\r\n","import { Button, Typography } from \"@material-ui/core\";\r\nimport { mdiChartBellCurve, mdiChartLine } from \"@mdi/js\";\r\nimport Icon from \"@mdi/react\";\r\nimport React from \"react\";\r\nimport { ChartDataset, Dataset, isCandleChartDataset, isIndicatorDataset } from \"./Types/CChartTypes\";\r\n\r\nexport const CChartLabel = (props: {\r\n  name: string;\r\n  dataset: Dataset;\r\n  decimals?: number;\r\n  onClick?: (name?: string) => any;\r\n  top: number;\r\n}) => {\r\n  const { dataset, name, decimals, onClick, top } = props;\r\n  if (!dataset) return null;\r\n\r\n  return (\r\n    <div style={{ position: \"absolute\", top: 10 + top, left: 10 }}>\r\n      <Button\r\n        style={{textTransform: \"none\"}}\r\n        onClick={() => {\r\n          onClick?.(name);\r\n        }}\r\n        startIcon={<Icon path={isIndicatorDataset(dataset) ? mdiChartBellCurve : mdiChartLine} size={1.0} color=\"#333\" />}\r\n      >\r\n      {isIndicatorDataset(dataset) ? (\r\n        <Typography>{`${name}:${dataset.prices.map((price) => price?.toFixed(decimals)).join(\", \") || \"\"}`}</Typography>\r\n      ) : (\r\n        <Typography variant=\"body1\">\r\n          {isCandleChartDataset(dataset)\r\n            ? `${name}\r\n                O:${dataset.open.toFixed(decimals)}\r\n                H:${dataset.high.toFixed(decimals)}\r\n                L:${dataset.low.toFixed(decimals)}\r\n                C:${dataset.close.toFixed(decimals)}`\r\n            : `${name}\r\n                C:${dataset.close.toFixed(decimals)}`}\r\n        </Typography>\r\n      )}\r\n      </Button>\r\n    </div>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { Line, Rect, Shape } from \"react-konva\";\r\nimport { chartStateReducer } from \"./ChartState/CChartStateReducer\";\r\nimport { isIndicatorGraph, CalculatedChartStateType } from \"./Types/CChartStateTypes\";\r\nimport { getDecimals } from \"./utils\";\r\n\r\nexport const CChartCrosshair = (props: { fullState: CalculatedChartStateType }) => {\r\n  const { fullState } = props;\r\n  const containerWidth = fullState.containerSize.width - 1;\r\n  const containerHeight = fullState.containerSize.height - 1;\r\n  const { widthYAxis } = fullState.yaxis;\r\n  const { heightXAxis, heightTickMarkLines } = fullState.xaxis;\r\n\r\n  let pixYSnap: number | null = null;\r\n  let ySnap: string | null = null;\r\n  if (!!fullState.pointer.move) {\r\n    pixYSnap = fullState.pointer.move.xy[1];\r\n  }\r\n  for (let i = 0; i < fullState.subCharts.length; i++) {\r\n    const subchart = fullState.subCharts[i];\r\n    for (let j = 0; j < subchart.yaxis[0].graphs.length; j++) {\r\n      const graph = subchart.yaxis[0].graphs[j];\r\n      if (!!fullState.pointer?.chartPointer?.move?.snapDatasets?.[0])\r\n        if (fullState.pointer.chartPointer.move?.snapDatasets[0].pixYSnap !== null) {\r\n          pixYSnap = fullState.pointer.chartPointer.move.snapDatasets[0].pixYSnap;\r\n          ySnap = fullState.pointer.chartPointer.move.snapDatasets[0].ySnap;\r\n        }\r\n    }\r\n  }\r\n  let subchartIdx = -1;\r\n  if (!!fullState.pointer.move) {\r\n    const xy = fullState.pointer.move.xy[1];\r\n    subchartIdx = fullState.subCharts.findIndex((val) => val.bottom >= xy && val.top <= xy);\r\n  }\r\n  if (!ySnap && subchartIdx !== -1)\r\n    ySnap = fullState.methods\r\n      .pixToY(fullState.pointer.move?.xy[1] as number, subchartIdx, 0)\r\n      .toFixed(fullState.subCharts[subchartIdx].yaxis[0].decimals);\r\n  if (!!ySnap && subchartIdx !== -1) {\r\n    const curgraph = fullState.subCharts[subchartIdx].yaxis[0].graphs[0];\r\n    if (isIndicatorGraph(curgraph)) {\r\n      if (!!curgraph.indicator.default.decimals)\r\n        ySnap = (\r\n          Math.round(parseFloat(ySnap) * Math.pow(10, curgraph.indicator.default.decimals)) /\r\n          Math.pow(10, curgraph.indicator.default.decimals)\r\n        ).toString();\r\n    }\r\n  }\r\n\r\n  // console.log(fullState.pointer?.chartPointer?.move?.xUnlimited, fullState.xaxis.xEnd, fullState.xaxis.xStart);\r\n  // console.log(fullState.pointer.move.xy[1], fullState.subCharts[fullState.subCharts.length - 1].bottom);\r\n\r\n  return !!fullState.pointer.move && !!pixYSnap ? (\r\n    <React.Fragment>\r\n      <Line // crosshair x\r\n        x={0}\r\n        y={0}\r\n        points={[\r\n          fullState.methods.xToPix(Math.round(fullState.methods.pixToX(fullState.pointer.move.xy[0]))),\r\n          0,\r\n          fullState.methods.xToPix(Math.round(fullState.methods.pixToX(fullState.pointer.move.xy[0]))),\r\n          containerHeight - heightXAxis + heightTickMarkLines,\r\n        ]}\r\n        stroke=\"black\"\r\n        strokeWidth={1}\r\n      />\r\n\r\n      {fullState.pointer.move.xy[1] <= fullState.subCharts[fullState.subCharts.length - 1].bottom ? (\r\n        <React.Fragment>\r\n          <Line // crosshair y\r\n            x={0}\r\n            y={0}\r\n            points={[0, pixYSnap, containerWidth - widthYAxis, pixYSnap]}\r\n            stroke=\"black\"\r\n            strokeWidth={1}\r\n          />\r\n          <Shape // yaxis marker\r\n            sceneFunc={(context, shape) => {\r\n              const ctx = context._context;\r\n              if (!fullState.pointer.move) return;\r\n              const yStart = pixYSnap as number;\r\n              ctx.moveTo(containerWidth - widthYAxis, yStart);\r\n              ctx.lineTo(containerWidth - widthYAxis + 10, yStart + 10);\r\n              ctx.lineTo(containerWidth, yStart + 10);\r\n              ctx.lineTo(containerWidth, yStart + 1);\r\n              ctx.lineTo(containerWidth, yStart - 10);\r\n              ctx.lineTo(containerWidth - widthYAxis + 10, yStart - 10);\r\n              ctx.lineTo(containerWidth - widthYAxis, yStart);\r\n              // (!) Konva specific method, it is very important\r\n              context.fillStrokeShape(shape);\r\n            }}\r\n            stroke=\"black\"\r\n            fill=\"rgba(199, 0, 57, 1)\"\r\n            strokeWidth={1}\r\n          />\r\n          <Shape // yaxis marker text\r\n            sceneFunc={(context, shape) => {\r\n              const ctx = context._context;\r\n              if (!fullState.pointer.move) return;\r\n              const yStart = pixYSnap as number;\r\n              ctx.font = fullState.yaxis.style.fontSize + \"px \" + fullState.yaxis.style.fontName;\r\n              ctx.fillStyle = fullState.yaxis.style.fontColor;\r\n              ctx.textAlign = \"left\";\r\n              ctx.textBaseline = \"middle\";\r\n              ctx.fillText(\r\n                ySnap as string,\r\n                containerWidth - widthYAxis + fullState.yaxis.widthTickmarkLines + 5,\r\n                yStart // additional 5px distance to end of tickmark\r\n              );\r\n              // (!) Konva specific method, it is very important\r\n              context.fillStrokeShape(shape);\r\n            }}\r\n            // stroke=\"black\"\r\n            // strokeWidth={1}\r\n          />\r\n        </React.Fragment>\r\n      ) : null}\r\n\r\n      {fullState.pointer?.chartPointer?.move?.xUnlimited <= fullState.xaxis.xEnd &&\r\n      fullState.pointer?.chartPointer?.move?.xUnlimited >= fullState.xaxis.xStart ? (\r\n        <React.Fragment>\r\n          <Rect // xaxis marker rect\r\n            x={fullState.methods.xToPix(Math.round(fullState.methods.pixToX(fullState.pointer.move?.xy[0]))) - 25}\r\n            y={containerHeight - heightXAxis + heightTickMarkLines + 0.5}\r\n            width={50}\r\n            height={25}\r\n            fill=\"white\"\r\n            stroke=\"black\"\r\n            strokeWidth={1}\r\n          />\r\n          <Shape // xaxis marker text\r\n            sceneFunc={(context, shape) => {\r\n              const ctx = context._context;\r\n              if (!fullState.pointer.move) return;\r\n              ctx.font = fullState.xaxis.style.fontSize + \"px \" + fullState.xaxis.style.fontName;\r\n              ctx.fillStyle = fullState.xaxis.style.fontColor;\r\n              ctx.textAlign = \"center\";\r\n              ctx.textBaseline = \"top\";\r\n\r\n              ctx.fillText(\r\n                !!fullState.pointer?.chartPointer?.move?.snapDatasets?.[0]\r\n                  ? (fullState.pointer.chartPointer.move.snapDatasets[0].dateString as string)\r\n                  : Math.round(fullState.methods.pixToX(fullState.pointer.move.xy[0])).toString(),\r\n                fullState.methods.xToPix(Math.round(fullState.methods.pixToX(fullState.pointer.move.xy[0]))),\r\n                containerHeight - heightXAxis + heightTickMarkLines + 5 + 0.5 // additional 5px distance to end of tickmark\r\n              );\r\n              // (!) Konva specific method, it is very important\r\n              context.fillStrokeShape(shape);\r\n            }}\r\n            // stroke=\"black\"\r\n            // strokeWidth={1}\r\n          />\r\n        </React.Fragment>\r\n      ) : null}\r\n\r\n      {/* ) : null} */}\r\n    </React.Fragment>\r\n  ) : null;\r\n};\r\n","import React from \"react\";\r\nimport { Shape } from \"react-konva\";\r\nimport { CandleChartDataset } from \"../Types/CChartTypes\";\r\nimport { CalculatedChartStateType, isChartGraph } from \"../Types/CChartStateTypes\";\r\n\r\nexport type CCandleChartType = {\r\n  fullState: CalculatedChartStateType;\r\n};\r\n\r\nexport const CCandleChart = (props: CCandleChartType) => {\r\n  const { fullState } = props;\r\n  const yaxis = fullState.subCharts[0].yaxis[0];\r\n  const graph = fullState.subCharts[0].yaxis[0].graphs[0];\r\n  if (!isChartGraph(graph) || !graph || !graph.curData) return null;\r\n\r\n  let curData: (CandleChartDataset & {\r\n    idx: number;\r\n  })[] = [];\r\n  let dxHalfCandle = 0;\r\n  if (0 in fullState.subCharts)\r\n    if (0 in fullState.subCharts[0].yaxis)\r\n      if (0 in fullState.subCharts[0].yaxis[0].graphs) {\r\n        curData = graph.curData as unknown as (CandleChartDataset & {\r\n          idx: number;\r\n        })[];\r\n        curData.forEach((val, valIdx) => (val.idx = valIdx));\r\n        dxHalfCandle =\r\n          fullState.xaxis.widthPerTick <= 2 ? 0 : Math.floor(0.35 * (fullState.xaxis.widthPerTick - 1));\r\n      }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Shape // candle wicks\r\n        sceneFunc={(context, shape) => {\r\n          context.beginPath();\r\n          (graph.curData as CandleChartDataset[]).forEach((dataset, datasetIdx) => {\r\n            const xPix = fullState.methods.xToPix(datasetIdx, 0) + fullState.xaxis.pixXStart;\r\n            const yPixHigh = Math.round(\r\n              fullState.methods.yToPix(dataset.high, 0, 0)\r\n            );\r\n            const yPixLow = Math.round(\r\n              fullState.methods.yToPix(dataset.low, 0, 0)\r\n            );\r\n            const yPixClose = Math.round(\r\n              fullState.methods.yToPix(dataset.close, 0, 0)\r\n            );\r\n            context.moveTo(xPix + 0.5, yPixLow + 0.5);\r\n            context.lineTo(xPix + 0.5, yPixHigh + 0.5);\r\n            if (dataset.close === dataset.open) {\r\n              context.moveTo(xPix - 2, yPixClose);\r\n              context.lineTo(xPix + 2, yPixClose);\r\n            }\r\n          });\r\n          // (!) Konva specific method, it is very important\r\n          context.closePath();\r\n          context.fillStrokeShape(shape);\r\n        }}\r\n        stroke={graph.style.candleStrokeColor}\r\n        strokeWidth={1}\r\n      />\r\n      <Shape // candle bodys upward\r\n        sceneFunc={(context, shape) => {\r\n          context.beginPath();\r\n          curData\r\n            .filter((val) => val.close >= val.open)\r\n            .forEach((gainDataset, gainDatasetIdx) => {\r\n              const xPix =\r\n                fullState.methods.xToPix(gainDataset.idx, 0) + fullState.xaxis.pixXStart;\r\n              const yPixOpen = Math.round(\r\n                fullState.methods.yToPix(\r\n                  gainDataset.open,\r\n                  0,\r\n                  0,\r\n                )\r\n              );\r\n              const yPixClose = Math.round(\r\n                fullState.methods.yToPix(\r\n                  gainDataset.close,\r\n                  0,\r\n                  0,\r\n                )\r\n              );\r\n              if (gainDataset.close !== gainDataset.open) {\r\n                if (dxHalfCandle !== 0) {\r\n                  const maxWidth =\r\n                    xPix + dxHalfCandle > fullState.xaxis.pixXEnd\r\n                      ? fullState.xaxis.pixXEnd - xPix + dxHalfCandle\r\n                      : dxHalfCandle * 2;\r\n                  context.rect(xPix + 0.5 - dxHalfCandle, yPixOpen + 0.5, maxWidth, yPixClose - yPixOpen);\r\n                } else if (dxHalfCandle === 0) {\r\n                  context.moveTo(xPix + 0.5, yPixClose);\r\n                  context.lineTo(xPix + 0.5, yPixOpen);\r\n                }\r\n              }\r\n              context.closePath();\r\n              context.fillStrokeShape(shape);\r\n            });\r\n        }}\r\n        stroke={graph.style.candleStrokeColor}\r\n        fill={graph.style.candleUpColor}\r\n        strokeWidth={1}\r\n      />\r\n      <Shape // candle bodys downward\r\n        sceneFunc={(context, shape) => {\r\n          context.beginPath();\r\n          curData\r\n            .filter((val) => val.close < val.open)\r\n            .forEach((gainDataset, gainDatasetIdx) => {\r\n              const xPix =\r\n                fullState.methods.xToPix(gainDataset.idx, 0) + fullState.xaxis.pixXStart;\r\n              const yPixOpen = Math.round(\r\n                fullState.methods.yToPix(\r\n                  gainDataset.open,\r\n                  0,\r\n                  0,\r\n                )\r\n              );\r\n              const yPixClose = Math.round(\r\n                fullState.methods.yToPix(\r\n                  gainDataset.close,\r\n                  0,\r\n                  0,\r\n                )\r\n              );\r\n              if (gainDataset.close !== gainDataset.open) {\r\n                if (dxHalfCandle !== 0) {\r\n                  const maxWidth =\r\n                    xPix + dxHalfCandle > fullState.xaxis.pixXEnd\r\n                      ? fullState.xaxis.pixXEnd - xPix + dxHalfCandle\r\n                      : dxHalfCandle * 2;\r\n                  context.rect(xPix + 0.5 - dxHalfCandle, yPixOpen + 0.5, maxWidth, yPixClose - yPixOpen);\r\n                } else if (dxHalfCandle === 0) {\r\n                  context.moveTo(xPix + 0.5, yPixClose);\r\n                  context.lineTo(xPix + 0.5, yPixOpen);\r\n                }\r\n              }\r\n              context.closePath();\r\n              context.fillStrokeShape(shape);\r\n            });\r\n        }}\r\n        stroke={graph.style.candleStrokeColor}\r\n        fill={graph.style.candleDownColor}\r\n        strokeWidth={1}\r\n      />\r\n    </React.Fragment>\r\n  );\r\n};\r\n","import { MutableRefObject, RefObject } from \"react\";\r\n\r\n/** Null/Undefined  */\r\nexport const isNullish = (val: any): val is undefined | null => {\r\n  if (val === undefined || val === null) return true;\r\n  if (typeof val === \"number\") if (isNaN(val)) return true;\r\n  return false;\r\n};\r\n\r\n/** Number utils */\r\nexport const getDecimals = (val: number) => {\r\n  if (Math.floor(val) === val) return 0;\r\n  return val.toString().split(\".\")[1].length || 0;\r\n};\r\n\r\n/** React */\r\n// export const isValidRef = (\r\n//   ref: MutableRefObject<any | null> | RefObject<any>\r\n// ): ref is MutableRefObject<any> | (RefObject<any> & { readonly current: any }) => {\r\n//   if (!ref || !ref.current) return false;\r\n//   return true;\r\n// };\r\n// export const isEmptyRef = (ref: MutableRefObject<any | null> |  RefObject<any>): ref is MutableRefObject<null> | RefObject<null> => {\r\n//   if (!ref || !ref.current) return true;\r\n//   return false;\r\n// };\r\n\r\n// export const isEmptyDOMRef = (\r\n//   ref: RefObject<any>\r\n// ): ref is {current: null} => {\r\n//   if (!ref || !ref.current) return true;\r\n//   return false;\r\n// };\r\n\r\n// Object / Array utils\r\n// export const editDeepProp = (srcObj: {[key: string]: any} | any[], path: (number | string)[], propName: number | string) => {\r\n\r\nexport const includesOne = (array: any[], ...params: any[]): boolean => {\r\n  let res = false;\r\n  params.forEach((param) => {\r\n    if (array.includes(param)) res = true;\r\n  });\r\n  return res;\r\n};\r\n\r\n//   let newObj = srcObj;\r\n//   path.forEach((addr, addrIdx) => {\r\n//     if (typeof newObj !== \"object\") return;\r\n//     if (Array.isArray(newObj) && typeof addr === \"number\") {\r\n//       newObj= newObj[addr]\r\n//     }\r\n//     else if (typeof  newObj === \"object\" && typeof addr === \"string\"){\r\n//       newObj = (newObj as { [key: string]: any })[addr];\r\n//     }\r\n//   })\r\n//   const editedSubcharts: ChartStateType[\"subCharts\"] = [\r\n//     ...srcObj.slice(0, toolsSubIdx),\r\n//     {\r\n//       ...srcObj[toolsSubIdx],\r\n//       yaxis: [\r\n//         ...srcObj[toolsSubIdx].yaxis.slice(0, toolsYaxisIdx),\r\n//         {\r\n//           ...srcObj[toolsSubIdx].yaxis[toolsYaxisIdx],\r\n//           tools: [\r\n//             ...srcObj[toolsSubIdx].yaxis[toolsYaxisIdx].tools.slice(0, toolIdx),\r\n//             {\r\n//               ...srcObj[toolsSubIdx].yaxis[toolsYaxisIdx].tools[toolIdx],\r\n//               xy: [\r\n//                 ...srcObj[toolsSubIdx].yaxis[toolsYaxisIdx].tools[toolIdx].xy.slice(0, anchorIdx),\r\n//                 [newX, newY],\r\n//                 ...srcObj[toolsSubIdx].yaxis[toolsYaxisIdx].tools[toolIdx].xy.slice(anchorIdx + 1),\r\n//               ],\r\n//             },\r\n//             ...srcObj[toolsSubIdx].yaxis[toolsYaxisIdx].tools.slice(toolIdx + 1),\r\n//           ],\r\n//         },\r\n//         ...srcObj[toolsSubIdx].yaxis.slice(toolsYaxisIdx + 1),\r\n//       ],\r\n//     },\r\n//     ...srcObj.slice(toolsSubIdx + 1),\r\n//   ];\r\n// }\r\n\r\nconst colorNames: {[key: string]: string} = {\r\n  aliceblue: \"#f0f8ff\",\r\n  antiquewhite: \"#faebd7\",\r\n  aqua: \"#00ffff\",\r\n  aquamarine: \"#7fffd4\",\r\n  azure: \"#f0ffff\",\r\n  beige: \"#f5f5dc\",\r\n  bisque: \"#ffe4c4\",\r\n  black: \"#000000\",\r\n  blanchedalmond: \"#ffebcd\",\r\n  blue: \"#0000ff\",\r\n  blueviolet: \"#8a2be2\",\r\n  brown: \"#a52a2a\",\r\n  burlywood: \"#deb887\",\r\n  cadetblue: \"#5f9ea0\",\r\n  chartreuse: \"#7fff00\",\r\n  chocolate: \"#d2691e\",\r\n  coral: \"#ff7f50\",\r\n  cornflowerblue: \"#6495ed\",\r\n  cornsilk: \"#fff8dc\",\r\n  crimson: \"#dc143c\",\r\n  cyan: \"#00ffff\",\r\n  darkblue: \"#00008b\",\r\n  darkcyan: \"#008b8b\",\r\n  darkgoldenrod: \"#b8860b\",\r\n  darkgray: \"#a9a9a9\",\r\n  darkgreen: \"#006400\",\r\n  darkkhaki: \"#bdb76b\",\r\n  darkmagenta: \"#8b008b\",\r\n  darkolivegreen: \"#556b2f\",\r\n  darkorange: \"#ff8c00\",\r\n  darkorchid: \"#9932cc\",\r\n  darkred: \"#8b0000\",\r\n  darksalmon: \"#e9967a\",\r\n  darkseagreen: \"#8fbc8f\",\r\n  darkslateblue: \"#483d8b\",\r\n  darkslategray: \"#2f4f4f\",\r\n  darkturquoise: \"#00ced1\",\r\n  darkviolet: \"#9400d3\",\r\n  deeppink: \"#ff1493\",\r\n  deepskyblue: \"#00bfff\",\r\n  dimgray: \"#696969\",\r\n  dodgerblue: \"#1e90ff\",\r\n  firebrick: \"#b22222\",\r\n  floralwhite: \"#fffaf0\",\r\n  forestgreen: \"#228b22\",\r\n  fuchsia: \"#ff00ff\",\r\n  gainsboro: \"#dcdcdc\",\r\n  ghostwhite: \"#f8f8ff\",\r\n  gold: \"#ffd700\",\r\n  goldenrod: \"#daa520\",\r\n  gray: \"#808080\",\r\n  green: \"#008000\",\r\n  greenyellow: \"#adff2f\",\r\n  honeydew: \"#f0fff0\",\r\n  hotpink: \"#ff69b4\",\r\n  \"indianred \": \"#cd5c5c\",\r\n  indigo: \"#4b0082\",\r\n  ivory: \"#fffff0\",\r\n  khaki: \"#f0e68c\",\r\n  lavender: \"#e6e6fa\",\r\n  lavenderblush: \"#fff0f5\",\r\n  lawngreen: \"#7cfc00\",\r\n  lemonchiffon: \"#fffacd\",\r\n  lightblue: \"#add8e6\",\r\n  lightcoral: \"#f08080\",\r\n  lightcyan: \"#e0ffff\",\r\n  lightgoldenrodyellow: \"#fafad2\",\r\n  lightgrey: \"#d3d3d3\",\r\n  lightgreen: \"#90ee90\",\r\n  lightpink: \"#ffb6c1\",\r\n  lightsalmon: \"#ffa07a\",\r\n  lightseagreen: \"#20b2aa\",\r\n  lightskyblue: \"#87cefa\",\r\n  lightslategray: \"#778899\",\r\n  lightsteelblue: \"#b0c4de\",\r\n  lightyellow: \"#ffffe0\",\r\n  lime: \"#00ff00\",\r\n  limegreen: \"#32cd32\",\r\n  linen: \"#faf0e6\",\r\n  magenta: \"#ff00ff\",\r\n  maroon: \"#800000\",\r\n  mediumaquamarine: \"#66cdaa\",\r\n  mediumblue: \"#0000cd\",\r\n  mediumorchid: \"#ba55d3\",\r\n  mediumpurple: \"#9370d8\",\r\n  mediumseagreen: \"#3cb371\",\r\n  mediumslateblue: \"#7b68ee\",\r\n  mediumspringgreen: \"#00fa9a\",\r\n  mediumturquoise: \"#48d1cc\",\r\n  mediumvioletred: \"#c71585\",\r\n  midnightblue: \"#191970\",\r\n  mintcream: \"#f5fffa\",\r\n  mistyrose: \"#ffe4e1\",\r\n  moccasin: \"#ffe4b5\",\r\n  navajowhite: \"#ffdead\",\r\n  navy: \"#000080\",\r\n  oldlace: \"#fdf5e6\",\r\n  olive: \"#808000\",\r\n  olivedrab: \"#6b8e23\",\r\n  orange: \"#ffa500\",\r\n  orangered: \"#ff4500\",\r\n  orchid: \"#da70d6\",\r\n  palegoldenrod: \"#eee8aa\",\r\n  palegreen: \"#98fb98\",\r\n  paleturquoise: \"#afeeee\",\r\n  palevioletred: \"#d87093\",\r\n  papayawhip: \"#ffefd5\",\r\n  peachpuff: \"#ffdab9\",\r\n  peru: \"#cd853f\",\r\n  pink: \"#ffc0cb\",\r\n  plum: \"#dda0dd\",\r\n  powderblue: \"#b0e0e6\",\r\n  purple: \"#800080\",\r\n  rebeccapurple: \"#663399\",\r\n  red: \"#ff0000\",\r\n  rosybrown: \"#bc8f8f\",\r\n  royalblue: \"#4169e1\",\r\n  saddlebrown: \"#8b4513\",\r\n  salmon: \"#fa8072\",\r\n  sandybrown: \"#f4a460\",\r\n  seagreen: \"#2e8b57\",\r\n  seashell: \"#fff5ee\",\r\n  sienna: \"#a0522d\",\r\n  silver: \"#c0c0c0\",\r\n  skyblue: \"#87ceeb\",\r\n  slateblue: \"#6a5acd\",\r\n  slategray: \"#708090\",\r\n  snow: \"#fffafa\",\r\n  springgreen: \"#00ff7f\",\r\n  steelblue: \"#4682b4\",\r\n  tan: \"#d2b48c\",\r\n  teal: \"#008080\",\r\n  thistle: \"#d8bfd8\",\r\n  tomato: \"#ff6347\",\r\n  turquoise: \"#40e0d0\",\r\n  violet: \"#ee82ee\",\r\n  wheat: \"#f5deb3\",\r\n  white: \"#ffffff\",\r\n  whitesmoke: \"#f5f5f5\",\r\n  yellow: \"#ffff00\",\r\n  yellowgreen: \"#9acd32\",\r\n};\r\n// colors\r\nexport const colorNameToHex = (name: string) => {\r\n  if (!(name in colorNames)) return null;\r\n  return colorNames[\"name\"];\r\n};\r\nexport const colorNameToRGB = (name: string) => {\r\n  if (!(name in colorNames)) return null;\r\n  return hexToRgb(colorNames[\"name\"]);\r\n};\r\n\r\nexport const hexToRgb = (hex: string) => {\r\n  if (!hex) return null;\r\n  // Expand shorthand form (e.g. \"03F\") to full form (e.g. \"0033FF\")\r\n  var shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\r\n  hex = hex.replace(shorthandRegex, function (m, r, g, b) {\r\n    return r + r + g + g + b + b;\r\n  });\r\n\r\n  var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n  return result\r\n    ? {\r\n        r: parseInt(result[1], 16),\r\n        g: parseInt(result[2], 16),\r\n        b: parseInt(result[3], 16),\r\n      }\r\n    : null;\r\n};\r\n","import React from \"react\";\r\nimport { Line } from \"react-konva\";\r\nimport { isIndicatorDataset } from \"../Types/CChartTypes\";\r\nimport { CalculatedChartStateType, isIndicatorGraph } from \"../Types/CChartStateTypes\";\r\nimport { isNullish } from \"../utils\";\r\n\r\nexport type ClineChartType = {\r\n  fullState: CalculatedChartStateType;\r\n  subchartIdx: number;\r\n  yaxisIdx: number;\r\n  graphIdx: number;\r\n  indSeriesIdx?: number;\r\n};\r\nexport const CLineChart = (props: ClineChartType) => {\r\n  const { fullState, subchartIdx, yaxisIdx, graphIdx, indSeriesIdx: indSeriesIdxIn } = props;\r\n  const indSeriesIdx = isNullish(indSeriesIdxIn) ? 0 : indSeriesIdxIn;\r\n  const yaxis = fullState.subCharts[subchartIdx].yaxis[yaxisIdx];\r\n  const graph = fullState.subCharts[subchartIdx].yaxis[yaxisIdx].graphs[graphIdx];\r\n  const graphVals: (number | null)[] = [];\r\n  if (Array.isArray(graph.curData) && graph.curData.length > 1) {\r\n    graphVals.push(\r\n      ...(graph.curData\r\n        .map((val, idx) => {\r\n          let price;\r\n          if (isIndicatorDataset(val)) price = val.prices[indSeriesIdx];\r\n          else price = val.close;\r\n          if (price === null) return [null, null];\r\n          return [fullState.xaxis.widthPerTick * idx, fullState.methods.yToPix(price, subchartIdx, 0, 0)];\r\n        })\r\n        .flat()\r\n        .filter((val) => val !== null) as number[])\r\n    );\r\n  }\r\n  const graphValsNN = graphVals.filter((val) => val !== null) as number[];\r\n\r\n  return (\r\n    <Line\r\n      key={`sub${subchartIdx}_graph${graphIdx}`}\r\n      x={fullState.xaxis.pixXStart}\r\n      y={fullState.methods.yToPix(0, subchartIdx, 0) - fullState.subCharts[subchartIdx].bottom}\r\n      points={[...graphValsNN]}\r\n      stroke={isIndicatorGraph(graph) ? graph.style.strokeColor[indSeriesIdx] : graph.style.strokeColor[0]}\r\n      strokeWidth={1}\r\n    />\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { Shape } from \"react-konva\";\r\nimport { LineChartDataset } from \"../Types/CChartTypes\";\r\nimport { CalculatedChartStateType, isIndicatorGraph } from \"../Types/CChartStateTypes\";\r\n\r\nexport type CBarChartType = {\r\n  fullState: CalculatedChartStateType;\r\n  subchartIdx: number;\r\n  yaxisIdx: number;\r\n  graphIdx: number;\r\n  // stroke: string;\r\n  // strokeWidth: number;\r\n};\r\nexport const CBarChart = (props: CBarChartType) => {\r\n  const { fullState, subchartIdx, yaxisIdx, graphIdx } = props;\r\n  const strokeWidth = 1;\r\n  const graph = fullState.subCharts[subchartIdx].yaxis[yaxisIdx].graphs[graphIdx];\r\n  return (\r\n    <Shape\r\n      sceneFunc={(context, shape) => {\r\n        context.beginPath();\r\n        (fullState.subCharts[0].yaxis[0].graphs[0].curData as LineChartDataset[]).forEach((dataset, datasetIdx) => {\r\n          if (!dataset.volume) return;\r\n          const xPix = fullState.methods.xToPix(datasetIdx, 0) + fullState.xaxis.pixXStart;\r\n          const yPixVol = Math.round(fullState.methods.yToPix(dataset.volume, subchartIdx, yaxisIdx, 0));\r\n          const yPix0 = Math.round(fullState.methods.yToPix(0, subchartIdx, yaxisIdx, 0));\r\n\r\n          context.moveTo(xPix + 0.5, yPix0 + 0.5);\r\n          context.lineTo(xPix + 0.5, yPixVol + 0.5);\r\n        });\r\n        // (!) Konva specific method, it is very important\r\n        context.closePath();\r\n        context.fillStrokeShape(shape);\r\n      }}\r\n    \r\n      stroke={isIndicatorGraph(graph) ? graph.style.strokeColor[0] : graph.style.strokeColor[0]}\r\n      strokeWidth={strokeWidth}\r\n    />\r\n  );\r\n};\r\n","import { PeriodsConstType } from \"../Types/CChartTimeTypes\";\r\nimport { format, getDate, getHours, getISOWeek, getMinutes, getMonth, getYear } from \"date-fns\";\r\n\r\nexport const getDateString = (date: Date, period: keyof PeriodsConstType): string => {\r\n  switch (period) {\r\n    case \"minutes\":\r\n      return format(date, \"mm\");\r\n    case \"hours\":\r\n      return format(date, \"HH\");\r\n    case \"days\":\r\n      return format(date, \"dd\");\r\n    case \"weeks\":\r\n      return format(date, \"dd\");\r\n    case \"months\":\r\n      return format(date, \"MMM\");\r\n    case \"years\":\r\n      return format(date, \"yyyy\");\r\n    default:\r\n      return \"|\";\r\n  }\r\n}; \r\n\r\nexport const getDateSubValue = (date: Date, period: keyof PeriodsConstType): number => {\r\n  switch (period) {\r\n    case \"minutes\":\r\n      return getMinutes(date);\r\n    case \"hours\":\r\n      return getHours(date);\r\n    case \"days\":\r\n      return getDate(date);\r\n    case \"weeks\":\r\n      return getISOWeek(date);\r\n    case \"months\":\r\n      return getMonth(date);\r\n    case \"years\":\r\n      return getYear(date);\r\n    default:\r\n      return 0;\r\n  }\r\n};\r\nexport const getDateObject = (date: Date) => ({\r\n  minute: getDateSubValue(date, \"minutes\"),\r\n  hour: getDateSubValue(date, \"hours\"),\r\n  day: getDateSubValue(date, \"days\"),\r\n  week: getDateSubValue(date, \"weeks\"),\r\n  month: getDateSubValue(date, \"months\"),\r\n  year: getDateSubValue(date, \"years\"),\r\n});\r\n","import { getDateObject, getDateSubValue } from \"./CChartDateTime\";\r\nimport { ChartPeriodType, DateStatType, PeriodsConstType } from \"../Types/CChartTimeTypes\";\r\nimport { DataSeries } from \"../Types/CChartTypes\";\r\nimport { ChartGraphStateType } from \"../Types/CChartStateTypes\";\r\n\r\nexport const chartPeriods: PeriodsConstType = {\r\n  minutes: { period: 60000, scaleMultiplys: [2, 5, 15, 30], range: [60000, 60000] },\r\n  hours: { period: 3600000, scaleMultiplys: [2, 4, 12], range: [3600000, 3600000] },\r\n  days: { period: 86400000, scaleMultiplys: [2], range: [86400000, 86400000] }, // special threatment!\r\n  weeks: { period: 86400000 * 7, scaleMultiplys: [2], range: [259200000, 950400000] }, // only 1 and 2 wheras 2 means 1/2 month\r\n  months: { period: 86400000 * 31, scaleMultiplys: [2, 3, 6], range: [2419200000, 2678400000] }, // months have 28-31 day :/\r\n  years: { period: 86400000 * 365, scaleMultiplys: [], range: [31536000000, 31622400000] },\r\n};\r\n\r\n/** determines chartPeriod (restrictions apply, otherwise return null) based on dataPeriod (dataPeriod repres. period with most occurances) */\r\nexport const getChartPeriod = (dataPeriod: number): ChartPeriodType | null => {\r\n  const dataPeriodKeys = Object.keys(chartPeriods) as (keyof PeriodsConstType)[];\r\n  for (let i = 0; i < dataPeriodKeys.length; i++) {\r\n    const chartPeriodKey = dataPeriodKeys[i];\r\n    const chartPeriod = chartPeriods[chartPeriodKey].period;\r\n    const chartPeriodRange = chartPeriods[chartPeriodKey].range;\r\n    if (typeof chartPeriod === \"number\")\r\n      if (dataPeriod === chartPeriod || (dataPeriod >= chartPeriodRange[0] && dataPeriod <= chartPeriodRange[1]))\r\n        return { chartPeriodName: chartPeriodKey, periodsConstIdx: i, chartPeriod: chartPeriod, multiply: 1 };\r\n  }\r\n  return null;\r\n};\r\n\r\nexport const getOptimalPeriod = (\r\n  data: DataSeries,\r\n  xStart: number,\r\n  xEnd: number,\r\n  metaData: ChartGraphStateType[\"meta\"],\r\n  noDataPortion: number,\r\n  dateStat: DateStatType\r\n): ChartPeriodType | null => {\r\n  if (!metaData.chartPeriod) return null;\r\n  const { chartPeriod, periodsConstIdx, chartPeriodName } = metaData.chartPeriod;\r\n\r\n  // const dateStat = getDateStat(data, xStart, xEnd);\r\n  const nCurrent = xEnd - xStart + 1;\r\n\r\n  const curDateStat = Object.assign({}, dateStat); //{ ...dateStat };\r\n  const nInDateStat = curDateStat.accAmt[chartPeriodName];\r\n  Object.keys(curDateStat.accAmt).forEach((key, keyIdx) => {\r\n    curDateStat.accAmt[key as keyof DateStatType[\"accAmt\"]] =\r\n      (curDateStat.accAmt[key as keyof DateStatType[\"accAmt\"]] / nInDateStat) * nCurrent;\r\n  });\r\n  const targetIntervals = 10 * (1 - noDataPortion);\r\n  let opt = null;\r\n  let optPeriod = chartPeriodName;\r\n  let optMultiply = 1;\r\n  let optConstIdx = 0;\r\n  for (let i = periodsConstIdx; i < Object.keys(chartPeriods).length; i++) {\r\n    const key = Object.keys(chartPeriods)[i] as keyof PeriodsConstType;\r\n    // higherPeriods += key + \", \";\r\n    if (key in curDateStat.accAmt) {\r\n      for (let multiply of [1, ...chartPeriods[key].scaleMultiplys]) {\r\n        if (opt !== null) {\r\n          if (\r\n            Math.abs(curDateStat.accAmt[key] / multiply - targetIntervals) <\r\n            Math.abs(opt / optMultiply - targetIntervals)\r\n          ) {\r\n            opt = curDateStat.accAmt[key];\r\n            optMultiply = multiply;\r\n            optPeriod = key;\r\n          }\r\n        } else {\r\n          // opt is just once null multiply is in first iteration always 1\r\n          opt = curDateStat.accAmt[key];\r\n          optMultiply = multiply;\r\n          optPeriod = key;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return {\r\n    chartPeriodName: optPeriod,\r\n    multiply: optMultiply,\r\n    chartPeriod: chartPeriods[optPeriod].period,\r\n    periodsConstIdx: optConstIdx,\r\n  };\r\n};\r\n\r\nexport const isNewYear = (date: Date, curYearDateStat: DateStatType[\"years\"], periodMultiply: 1 = 1) => {\r\n  // , periodMultiply?: number to be added as parameter -> multiply currently not supported for years\r\n  if (curYearDateStat.length > 1) return false;\r\n  const { day, week, month, year } = getDateObject(date);\r\n  const thisMonthStat = curYearDateStat[0].months[0];\r\n  if (\r\n    thisMonthStat.weeks[0].days[0].day === day &&\r\n    thisMonthStat.weeks[0].week === week &&\r\n    thisMonthStat.month === month\r\n  )\r\n    return true;\r\n  return false;\r\n};\r\n\r\nconst isNewMonth = (\r\n  date: Date,\r\n  curYearDateStat: DateStatType[\"years\"],\r\n  curMonthIdx: number,\r\n  periodMultiply: 1 | 2 | 3 | 6 = 1\r\n) => {\r\n  if (curYearDateStat.length > 1) return false;\r\n  const { day, week, month, year } = getDateObject(date);\r\n  if ((curMonthIdx + 1) % periodMultiply !== 0) return false;\r\n  if (\r\n    curYearDateStat[0].months[curMonthIdx].weeks[0].days[0].day === day &&\r\n    curYearDateStat[0].months[curMonthIdx].weeks[0].week === week\r\n  )\r\n    return true;\r\n  return false;\r\n};\r\n\r\nconst isNewIsoWeek = (\r\n  date: Date,\r\n  curYearDateStat: DateStatType[\"years\"],\r\n  curMonthIdx: number,\r\n  curWeekIdx: number,\r\n  periodMultiply: 1 | 2 = 1\r\n) => {\r\n  if (curYearDateStat.length > 1) return false;\r\n  const { day, week, month, year } = getDateObject(date);\r\n  if (\r\n    curYearDateStat[0].months[curMonthIdx].weeks[curWeekIdx].days[0].day === day &&\r\n    curYearDateStat[0].months[curMonthIdx].weeks[curWeekIdx].week === week\r\n  ) {\r\n    if (periodMultiply === 2) {\r\n      let daysInMonth = 0;\r\n      curYearDateStat[0].months[curMonthIdx].weeks.forEach((val) => (daysInMonth += val.days.length));\r\n      let curDays = 0;\r\n      let opt = 0;\r\n      let optWeekIdx = 0;\r\n      const optimalDaysTarget = Math.round(daysInMonth / 2);\r\n      for (let i = 0; i < curYearDateStat[0].months[curMonthIdx].weeks.length; i++) {\r\n        const weekInMonth = curYearDateStat[0].months[curMonthIdx].weeks[i];\r\n        if (Math.abs(curDays + weekInMonth.days.length - optimalDaysTarget) < Math.abs(opt - optimalDaysTarget)) {\r\n          opt = curDays + weekInMonth.days.length;\r\n          optWeekIdx = i + 1;\r\n        }\r\n        curDays += weekInMonth.days.length;\r\n      }\r\n      if (curWeekIdx === optWeekIdx) return true;\r\n      return false;\r\n    } else if (periodMultiply === 1) {\r\n      if (curWeekIdx === 1 && curYearDateStat[0].months[curMonthIdx].weeks[0].days.length < 3) return false;\r\n      if (\r\n        curWeekIdx === curYearDateStat[0].months[curMonthIdx].weeks.length - 1 &&\r\n        curYearDateStat[0].months[curMonthIdx].weeks[curWeekIdx].days.length < 3\r\n      )\r\n        return false;\r\n      return true;\r\n    }\r\n  }\r\n  return false;\r\n};\r\n\r\nconst isNewDay = (\r\n  date: Date,\r\n  curYearDateStat: DateStatType[\"years\"],\r\n  curMonthIdx: number,\r\n  curWeekIdx: number,\r\n  curDayIdx: number,\r\n  periodMultiply: 1 | 2 = 1\r\n) => {\r\n  const day = getDateSubValue(date, \"days\");\r\n  if (curYearDateStat[0].months[curMonthIdx].weeks[curWeekIdx].days[curDayIdx].day === day && periodMultiply === 1)\r\n    return true;\r\n  if (curYearDateStat[0].months[curMonthIdx].weeks[curWeekIdx].days[curDayIdx].day === day && periodMultiply === 2) {\r\n    if (curYearDateStat[0].months[curMonthIdx].weeks[curWeekIdx].days.length <= 3) return false; // weeks with up to 3 days are not diveded\r\n    if (\r\n      (curYearDateStat[0].months[curMonthIdx].weeks[curWeekIdx].days.length === 4 &&\r\n        (curDayIdx === 0 || curDayIdx === 2)) ||\r\n      (curYearDateStat[0].months[curMonthIdx].weeks[curWeekIdx].days.length === 5 &&\r\n        (curDayIdx === 0 || curDayIdx === 2)) ||\r\n      (curYearDateStat[0].months[curMonthIdx].weeks[curWeekIdx].days.length === 6 &&\r\n        (curDayIdx === 0 || curDayIdx === 2 || curDayIdx === 4)) ||\r\n      (curYearDateStat[0].months[curMonthIdx].weeks[curWeekIdx].days.length === 7 &&\r\n        (curDayIdx === 0 || curDayIdx === 2 || curDayIdx === 5))\r\n    )\r\n      return true;\r\n  }\r\n  return false;\r\n};\r\n\r\nexport const isNewPeriod = (\r\n  //   data: ChartData,\r\n  date: Date,\r\n  dateStat: DateStatType,\r\n  chartPeriod: ChartPeriodType,\r\n  optPeriod: ChartPeriodType\r\n  //   xStart: number,\r\n  //   xEnd: number\r\n) => {\r\n  if (!chartPeriod || !optPeriod || !dateStat) return null;\r\n  const { chartPeriodName: optPeriodName, multiply: optMultiply } = optPeriod;\r\n  const year = getDateSubValue(date, \"years\");\r\n  const month = getDateSubValue(date, \"months\");\r\n  const week = getDateSubValue(date, \"weeks\");\r\n  const day = getDateSubValue(date, \"days\");\r\n\r\n  const curYearStat = dateStat.years.filter((e) => e.year === year);\r\n  // console.log(month, curYearStat, dateStat);\r\n  const curMonthStat = curYearStat[0].months.filter((e) => e.month === month);\r\n  const curMonthStatIdx = curYearStat[0].months.indexOf(curMonthStat[0]);\r\n\r\n  const curWeekStat = curMonthStat[0].weeks.filter((e) => e.week === week);\r\n  const curWeekStatIdx = curYearStat[0].months[curMonthStatIdx].weeks.indexOf(curWeekStat[0]);\r\n  const curDayStat = curWeekStat[0].days.filter((e) => e.day === day);\r\n  const curDayStatIdx = curYearStat[0].months[curMonthStatIdx].weeks[curWeekStatIdx].days.indexOf(curDayStat[0]);\r\n\r\n  if (chartPeriod.chartPeriodName === optPeriodName && optMultiply === 1) return optPeriodName;\r\n  // if (chartPeriod.chartPeriodName === optPeriodName && optMultiply !== 1) return optPeriodName; //// TODO\r\n  if (optPeriodName === \"days\") {\r\n    if (isNewYear(date, curYearStat)) return \"years\";\r\n    if (isNewMonth(date, curYearStat, curMonthStatIdx, 1)) return \"months\";\r\n    if (isNewIsoWeek(date, curYearStat, curMonthStatIdx, curWeekStatIdx, optMultiply as 1 | 2)) return \"weeks\";\r\n    if (isNewDay(date, curYearStat, curMonthStatIdx, curWeekStatIdx, curDayStatIdx, optMultiply as 1 | 2))\r\n      return \"days\";\r\n    return null;\r\n  }\r\n  if (optPeriodName === \"weeks\") {\r\n    if (isNewYear(date, curYearStat)) return \"years\";\r\n    if (isNewMonth(date, curYearStat, curMonthStatIdx, 1)) return \"months\";\r\n    if (isNewIsoWeek(date, curYearStat, curMonthStatIdx, curWeekStatIdx, optMultiply as 1 | 2)) return optPeriodName;\r\n    return null;\r\n  }\r\n  if (optPeriodName === \"months\") {\r\n    if (curMonthStat[0].weeks[0].days[0].day === day) return optPeriodName;\r\n    else return null;\r\n  }\r\n  if (optPeriodName === \"years\") {\r\n    if (curYearStat[0].months[0].weeks[0].days[0].day === day) return optPeriodName;\r\n    return null;\r\n  }\r\n  return null;\r\n};\r\n","import { getISOWeek } from \"date-fns\";\r\nimport { getDateStat } from \"./Time/CChartDateStat\";\r\nimport { getDateSubValue } from \"./Time/CChartDateTime\";\r\nimport { getChartPeriod } from \"./Time/CChartPeriod\";\r\nimport { DataSeries, ChartDataset, IndicatorDataset, isCandleChartDataset, IndicatorDataSeries } from \"./Types/CChartTypes\";\r\nimport {\r\n  isIndicatorGraph,\r\n  SubchartStateType,\r\n  YaxisStateType,\r\n  AdditionalIndicatorGraphStateType,\r\n  IndicatorGraphStateType,\r\n  ChartGraphStateType,\r\n  GraphStateType,\r\n} from \"./Types/CChartStateTypes\";\r\nimport { getDecimals } from \"./utils\";\r\n// import { getDataDateStat } from \"./CChartDate\";\r\n// import { CandleChartDataset, CChartViewerInternalState, ChartDataset, GraphProps } from \"./CChartViewer\";\r\n\r\nexport const getGraphMetaData = (dataSeries: ChartDataset[]): ChartGraphStateType[\"meta\"] & { decimals: number } => {\r\n  // get nData\r\n  const nData = dataSeries.length;\r\n\r\n  // local function, ts seems not to accept Date types as number\r\n  const getDeltaT = (dataPoint1: ChartDataset, dataPoint0: ChartDataset) =>\r\n    (dataPoint1.date as unknown as number) - (dataPoint0.date as unknown as number);\r\n\r\n  // loop data -> guess period, tradingDaysPerWeek (and confidence level=occurences in percent) and get decimals\r\n  const dT1 = getDeltaT(dataSeries[1], dataSeries[0]);\r\n  let deltaPeriods = [{ dT: dT1, amt: 1 }];\r\n  let decimals = 0;\r\n  let curWeek = getDateSubValue(dataSeries[0].date, \"weeks\"); //  getISOWeek(dataSeries[0].date);\r\n  let curYear = getDateSubValue(dataSeries[0].date, \"years\"); //dataSeries[0].date.getFullYear();\r\n  let curWeekDays = 0;\r\n  let weekDays: { amtDays: number; occ: number }[] = [];\r\n  for (let i = 0; i < nData; i++) {\r\n    // heuristic guess of period using simple stat of delta Periods (N=n-1)\r\n    if (i >= 2) {\r\n      // start with 2, iteration i=1 is done outside for loop\r\n      const deltaPeriod = getDeltaT(dataSeries[i], dataSeries[i - 1]);\r\n      // loop thru deltaPeriods already determined in prev iterations\r\n      for (let j = 0; j < deltaPeriods.length; j++) {\r\n        const savedDeltaPeriod = deltaPeriods[j];\r\n        if (savedDeltaPeriod.dT === deltaPeriod) {\r\n          deltaPeriods[j].amt++;\r\n          break;\r\n        } else if (j === deltaPeriods.length - 1) deltaPeriods.push({ dT: deltaPeriod, amt: 1 });\r\n      }\r\n    }\r\n    // heuristic guess of tradingDaysPerWeek\r\n    const iDataWeek = getISOWeek(dataSeries[i].date);\r\n    const iyear = getDateSubValue(dataSeries[i].date, \"years\"); //.getFullYear(); ;\r\n    if (iDataWeek > curWeek || iyear > curYear || i === nData - 1) {\r\n      // eslint-disable-next-line no-loop-func\r\n      const weekDaysFiltered = weekDays.filter((e) => e.amtDays === curWeekDays);\r\n      if (weekDaysFiltered.length > 0) {\r\n        if (weekDaysFiltered.length > 1) console.log(\"warning - internal error determing GraphMetaData\");\r\n        const weekDayIdx = weekDays.indexOf(weekDaysFiltered[0]);\r\n        weekDays[weekDayIdx].occ++;\r\n      } else if (weekDaysFiltered.length === 0) {\r\n        weekDays.push({ amtDays: curWeekDays, occ: 1 });\r\n      }\r\n      curWeek = iDataWeek;\r\n      curWeekDays = 1;\r\n      curYear = iyear;\r\n    } else {\r\n      curWeekDays++;\r\n    }\r\n\r\n    // determine max amount of decimals found in data\r\n    const datasetDecimals = [getDecimals(dataSeries[i].close)];\r\n    const curDataset = dataSeries[i]; //ts seems not to cast\r\n    if (isCandleChartDataset(curDataset)) {\r\n      datasetDecimals.push(getDecimals(curDataset.open));\r\n      datasetDecimals.push(getDecimals(curDataset.high));\r\n      datasetDecimals.push(getDecimals(curDataset.low));\r\n    }\r\n    const maxDecimals = Math.max(...datasetDecimals);\r\n    if (maxDecimals > decimals) decimals = maxDecimals;\r\n  }\r\n\r\n  // extract desired period data from deltaPeriod stat\r\n  let deltaTs = deltaPeriods.map((item) => item.dT);\r\n  let amts = deltaPeriods.map((item) => item.amt);\r\n  let maxIdx = amts.reduce((maxIdx, val, i, arr) => (val > arr[maxIdx] ? i : maxIdx), 0); //\r\n  // extract desired tradingDaysPerWeek data from weekDays stat\r\n  const maxDaysPerWeekOccurences = weekDays.map((val) => val.occ);\r\n  let totalOcc = 0;\r\n  weekDays.forEach((val) => (totalOcc += val.occ));\r\n  const maxDaysPerWeekOccIdx = maxDaysPerWeekOccurences.reduce(\r\n    (maxIdx, val, i, arr) => (val > arr[maxIdx] ? i : maxIdx),\r\n    0\r\n  );\r\n  const maxDaysPerWeek = weekDays[maxDaysPerWeekOccIdx].amtDays;\r\n  const maxDaysPerWeekGuessConfidence = weekDays[maxDaysPerWeekOccIdx].occ / totalOcc;\r\n\r\n  // get chartperiod\r\n  const chartPeriod = getChartPeriod(deltaTs[maxIdx]);\r\n  return {\r\n    nData: nData,\r\n    dataPeriod: deltaTs[maxIdx],\r\n    chartPeriod: chartPeriod,\r\n    periodGuessConfidence: amts[maxIdx] / nData,\r\n    tradingDaysPerWeek: maxDaysPerWeek,\r\n    tradingDaysPerWeekGuessConfidence: maxDaysPerWeekGuessConfidence,\r\n    type: \"candlechart\",\r\n    decimals: decimals,\r\n  };\r\n};\r\n\r\nexport const createSubChartModel = (\r\n  top: number,\r\n  bottom: number,\r\n  chartData: ChartDataset[],\r\n  chartName: string,\r\n  style?: ChartGraphStateType[\"style\"] | IndicatorGraphStateType[\"style\"],\r\n  indicator?: AdditionalIndicatorGraphStateType[\"indicator\"]\r\n): SubchartStateType => {\r\n  return {\r\n    yaxis: [createYaxisModel(chartData, chartName, style, indicator)],\r\n    top: top,\r\n    bottom: bottom,\r\n  };\r\n};\r\n\r\nexport const createYaxisModel = (\r\n  chartData: ChartDataset[],\r\n  chartName: string,\r\n  style?: ChartGraphStateType[\"style\"] | IndicatorGraphStateType[\"style\"],\r\n  indicator?: AdditionalIndicatorGraphStateType[\"indicator\"]\r\n): YaxisStateType => {\r\n  const newGraph = !!indicator\r\n    ? createIndicatorGraphModel(chartData, chartName, indicator, style as IndicatorGraphStateType[\"style\"])\r\n    : createChartGraphModel(chartData, chartName, style as ChartGraphStateType[\"style\"]);\r\n  return {\r\n    graphs: [{ ...(newGraph as any) }],\r\n    decimals: newGraph.decimals,\r\n    tools: [],\r\n    translatedY: 0,\r\n    optIntervalY: 0,\r\n    heightPerPt: 0,\r\n    drawTicks: [],\r\n  };\r\n};\r\n\r\nexport const createChartGraphModel = (\r\n  chartData: ChartDataset[],\r\n  chartName: string,\r\n  style?: GraphStateType[\"style\"]\r\n): ChartGraphStateType => {\r\n  const { decimals, ...graphProps } = getGraphMetaData(chartData);\r\n  const dateStat = getDateStat(chartData, 0, chartData.length - 1);\r\n  return {\r\n    data: chartData,\r\n    meta: graphProps,\r\n    // dateStat: dateStat,\r\n    style: {\r\n      strokeColor: [\"#000\"],\r\n      candleStrokeColor: \"#666\",\r\n      candleDownColor: \"rgb(199, 0, 57)\",\r\n      candleUpColor: \"#009688\",\r\n      ...style,\r\n    },\r\n    yMax: 0,\r\n    yMaxExact: 0,\r\n    yMin: 0,\r\n    yMinExact: 0,\r\n    // drawPixXy: [],\r\n    datasets: { first: null, last: null },\r\n    dateStat: dateStat,\r\n    type: \"chart\",\r\n    name: chartName,\r\n    decimals: decimals,\r\n  };\r\n  \r\n};\r\nexport const createIndicatorGraphModel = (\r\n  chartData: ChartDataset[],\r\n  chartName: string,\r\n  indicator: AdditionalIndicatorGraphStateType[\"indicator\"],\r\n  style?: IndicatorGraphStateType[\"style\"]\r\n): IndicatorGraphStateType => {\r\n  const indicatorData: IndicatorDataSeries = indicator.indicatorFn?.(\r\n    chartData,\r\n    chartName,\r\n    ...indicator.params.map((val) => val.val)\r\n  );\r\n  const { decimals: decimalsData, ...graphProps } = getGraphMetaData(chartData); //only decimals necessary!\r\n  const decimals = !!indicator.default.decimals ? indicator.default.decimals : decimalsData;\r\n  // const dateStat = getDateStat(chartData, 0, chartData.length - 1);\r\n  return {\r\n    data: indicatorData,\r\n    type: \"indicator\",\r\n    name: indicator.name, //chartName,\r\n    decimals: decimals,\r\n    style: {\r\n      ...style,\r\n      strokeColor: style?.strokeColor || [\"#00ffff\"],\r\n    },\r\n    yMax: 0,\r\n    yMaxExact: 0,\r\n    yMin: 0,\r\n    yMinExact: 0,\r\n    // drawPixXy: [],\r\n    datasets: { first: null, last: null },\r\n    indicator,\r\n  };\r\n};\r\n","import { getDateSubValue } from \"./CChartDateTime\";\r\nimport {\r\n  DateStatType,\r\n  PeriodsConstType,\r\n  DateStatYearType,\r\n  DateStatMonthType,\r\n  DateStatWeekType,\r\n  DateStatDayType,\r\n} from \"../Types/CChartTimeTypes\";\r\nimport { DataSeries } from \"../Types/CChartTypes\";\r\n\r\nexport const getDateStat = (data: DataSeries, xStart: number, xEnd: number) => {\r\n  let stat: DateStatType = { years: [], accAmt: { years: 0, months: 0, weeks: 0, days: 0, hours: 0, minutes: 0 } };\r\n\r\n  const makeSingleDayStat = (day: number): DateStatDayType => ({ day: day, hours: [] });\r\n  const makeSingleWeekStat = (week: number, day: number): DateStatWeekType => ({\r\n    week: week,\r\n    days: [makeSingleDayStat(day)],\r\n  });\r\n  const makeSingleMonthStat = (month: number, week: number, day: number): DateStatMonthType => ({\r\n    month: month,\r\n    weeks: [makeSingleWeekStat(week, day)],\r\n  });\r\n  const makeSingleYearStat = (year: number, month: number, week: number, day: number): DateStatYearType => ({\r\n    year: year,\r\n    months: [makeSingleMonthStat(month, week, day)],\r\n  });\r\n  const incrementPeriodAccAmt = (period: keyof PeriodsConstType) => {\r\n    if (period === \"years\") stat.accAmt.years++;\r\n    if ([\"years\", \"months\"].includes(period)) stat.accAmt.months++;\r\n    if ([\"years\", \"months\", \"weeks\"].includes(period)) stat.accAmt.weeks++;\r\n    if ([\"years\", \"months\", \"weeks\", \"days\"].includes(period)) stat.accAmt.days++;\r\n  };\r\n\r\n  for (let i = xStart; i <= xEnd; i++) {\r\n    const year = getDateSubValue(data[i].date, \"years\");\r\n    const month = getDateSubValue(data[i].date, \"months\");\r\n    const week = getDateSubValue(data[i].date, \"weeks\");\r\n    const day = getDateSubValue(data[i].date, \"days\");\r\n\r\n    const addPeriod = (period: keyof PeriodsConstType, curStatIdx: number[]) => {\r\n      if (period === \"years\") stat.years.push(makeSingleYearStat(year, month, week, day));\r\n      if (period === \"months\") stat.years[curStatIdx[0]].months.push(makeSingleMonthStat(month, week, day));\r\n      if (period === \"weeks\") stat.years[curStatIdx[0]].months[curStatIdx[1]].weeks.push(makeSingleWeekStat(week, day));\r\n      if (period === \"days\")\r\n        stat.years[curStatIdx[0]].months[curStatIdx[1]].weeks[curStatIdx[2]].days.push(makeSingleDayStat(day));\r\n    };\r\n\r\n    const addOrIncrementPeriod = (\r\n      period: keyof PeriodsConstType,\r\n      periodStat: DateStatType,\r\n      curStatIdx: number[] = []\r\n    ): null | true => {\r\n      // search current Data's date in stat (resp it's sub-period-value)\r\n      let periodStatFilter: DateStatYearType[] | DateStatDayType[] | DateStatWeekType[] | DateStatMonthType[] | null =\r\n        null;\r\n      let filteredStatIdx = -1;\r\n      if (period === \"years\") {\r\n        periodStatFilter = (periodStat.years as DateStatYearType[]).filter((e) => e.year === year);\r\n        if (0 in periodStatFilter) filteredStatIdx = stat.years.indexOf(periodStatFilter[0]);\r\n      } else if (period === \"months\") {\r\n        if (curStatIdx.length < 1) return null;\r\n        const monthsStat = periodStat.years[curStatIdx[0]].months as DateStatMonthType[];\r\n        periodStatFilter = monthsStat.filter((e) => e.month === month);\r\n        if (0 in periodStatFilter) filteredStatIdx = stat.years[curStatIdx[0]].months.indexOf(periodStatFilter[0]);\r\n      } else if (period === \"weeks\") {\r\n        if (curStatIdx.length < 2) return null;\r\n        const weeksStat = periodStat.years[curStatIdx[0]].months[curStatIdx[1]].weeks as DateStatWeekType[];\r\n        periodStatFilter = weeksStat.filter((e) => e.week === week);\r\n        if (0 in periodStatFilter)\r\n          filteredStatIdx = stat.years[curStatIdx[0]].months[curStatIdx[1]].weeks.indexOf(periodStatFilter[0]);\r\n      } else if (period === \"days\") {\r\n        if (curStatIdx.length < 3) return null;\r\n        const daysStat = periodStat.years[curStatIdx[0]].months[curStatIdx[1]].weeks[curStatIdx[2]]\r\n          .days as DateStatDayType[];\r\n        periodStatFilter = daysStat.filter((e) => e.day === day);\r\n        if (0 in periodStatFilter)\r\n          filteredStatIdx = stat.years[curStatIdx[0]].months[curStatIdx[1]].weeks[curStatIdx[2]].days.indexOf(\r\n            periodStatFilter[0]\r\n          );\r\n      }\r\n      if (!periodStatFilter) return null; // will not occure if period is provided acc. to it's type\r\n\r\n      // period doesn't exist yet in stat\r\n      if (periodStatFilter.length === 0) {\r\n        incrementPeriodAccAmt(period);\r\n        const newPeriodStat =\r\n          period === \"years\"\r\n            ? makeSingleYearStat(year, month, week, day)\r\n            : period === \"months\"\r\n            ? makeSingleMonthStat(month, week, day)\r\n            : period === \"weeks\"\r\n            ? makeSingleWeekStat(week, day)\r\n            : period === \"days\"\r\n            ? makeSingleDayStat(day)\r\n            : null;\r\n        if (!newPeriodStat) return null; // will not occure if period is provided acc. to it's type\r\n        addPeriod(period, curStatIdx);\r\n        return true;\r\n      } else {\r\n        // period already exists in stat -> check next lower subperiod\r\n        const nextLowerPeriod =\r\n          period === \"years\" ? \"months\" : period === \"months\" ? \"weeks\" : period === \"weeks\" ? \"days\" : null;\r\n        if (!nextLowerPeriod) return null;\r\n        if (filteredStatIdx === -1) return null;\r\n        return addOrIncrementPeriod(nextLowerPeriod, periodStat, [...curStatIdx, filteredStatIdx]);\r\n      }\r\n    };\r\n    addOrIncrementPeriod(\"years\", stat);\r\n  }\r\n  return stat;\r\n};\r\n","import { createChartGraphModel, createIndicatorGraphModel, createSubChartModel } from \"../CChartModel\";\r\n// import { getGraphColors, graphColorsLight } from \"../Archiv/CChartVals\";\r\nimport { ChartDataSeries, ChartDataset, DataSeries } from \"../Types/CChartTypes\";\r\n\r\nimport {\r\n  AdditionalChartGraphStateType,\r\n  AdditionalIndicatorGraphStateType,\r\n  ChartGraphStateType,\r\n  ChartStateType,\r\n  GraphStateType,\r\n  IndicatorGraphStateType,\r\n  isChartGraph,\r\n  isIndicatorGraph,\r\n} from \"../Types/CChartStateTypes\";\r\nexport type AtLeastOne<T, U = { [K in keyof T]: Pick<T, K> }> = Partial<T> & U[keyof U];\r\nexport type ExcludeEmpty<T> = T extends AtLeastOne<T> ? T : never;\r\n\r\nexport const graphColorsLight: string[] = [\"#666\", \"#0693E3\", \"#f50057\", \"#00D084\", \"#FF6900\", \"#bd10e0\", \"#bbb\"];\r\nexport const getGraphColors = (colorArr: string[], idx: number) => colorArr[idx % colorArr.length];\r\nexport const getLightGraphColors = (idx: number) => getGraphColors(graphColorsLight, idx);\r\n\r\nexport type ReducerActionTaskType =\r\n  | \"addSubchart\"\r\n  | \"addGraph\"\r\n  // | \"draw\"\r\n  | \"setBackgroundColor\"\r\n  | \"setAxisFillColor\"\r\n  | \"setAxisStrokeColor\"\r\n  | \"setAxisTextColor\"\r\n  | \"toggleXaxisGrid\"\r\n  | \"toggleYaxisGrid\"\r\n  | \"setGridStrokeColor\"\r\n  | \"setLineChartStrokeColor\"\r\n  | \"setCandleChartUpColor\"\r\n  | \"setCandleChartDownColor\"\r\n  | \"setCandleChartStrokeColor\"\r\n  | \"setIndicatorParam\"\r\n  | \"updateInteractionState\"\r\n  | \"setToolStrokeColor\"\r\n  | \"setToolchorColor\"\r\n  | \"setHlineYlevel\"\r\n  | \"toggleFullscreen\"\r\n  | \"removeSubchart\"\r\n  | \"removeGraph\"\r\n  | {};\r\n\r\nexport type ReducerActionType<T extends ReducerActionTaskType = {}> = {\r\n  task: T;\r\n  params: T extends \"addSubchart\"\r\n    ? {\r\n        chartSeries: DataSeries;\r\n        chartName: string;\r\n        indicator?: AdditionalIndicatorGraphStateType[\"indicator\"];\r\n        containerHeight: number; // should not be\r\n      }\r\n    : T extends \"removeSubchart\"\r\n    ? {\r\n        subchartIdx: number;\r\n      }\r\n    : T extends \"removeGraph\"\r\n    ? {\r\n        subchartIdx: number;\r\n        yaxisIdx: number;\r\n        graphIdx: number;\r\n      }\r\n    : T extends \"addGraph\"\r\n    ? {\r\n        chartSeries: DataSeries;\r\n        chartName: string;\r\n        subchartIdx: number;\r\n        indicator?: AdditionalIndicatorGraphStateType[\"indicator\"];\r\n      }\r\n    : T extends \"draw\"\r\n    ? {\r\n        type?: ChartStateType[\"draw\"][\"type\"];\r\n        xy?: [number, number];\r\n        subchartIdx: number;\r\n      }\r\n    : T extends\r\n        | \"setBackgroundColor\"\r\n        | \"setAxisFillColor\"\r\n        | \"setAxisStrokeColor\"\r\n        | \"setAxisTextColor\"\r\n        | \"setGridStrokeColor\"\r\n    ? { color: string }\r\n    : T extends \"toggleXaxisGrid\" | \"toggleYaxisGrid\" | \"toggleFullscreen\"\r\n    ? {}\r\n    : T extends\r\n        | \"setLineChartStrokeColor\"\r\n        | \"setCandleChartUpColor\"\r\n        | \"setCandleChartDownColor\"\r\n        | \"setCandleChartStrokeColor\"\r\n    ? { color: string; subchartIdx: number; yaxisIdx: number; graphIdx: number }\r\n    : T extends \"setToolStrokeColor\" | \"setToolAnchorColor\"\r\n    ? { color: string; subchartIdx: number; yaxisIdx: number; toolIdx: number }\r\n    : T extends \"setIndicatorParam\"\r\n    ? {\r\n        subchartIdx: number;\r\n        yaxisIdx: number;\r\n        graphIdx: number;\r\n        paramIdx: number;\r\n        val: any;\r\n      }\r\n    : T extends \"setHlineYlevel\"\r\n    ? { subchartIdx: number; yaxisIdx: number; toolIdx: number; val: number }\r\n    : T extends \"updateInteractionState\"\r\n    ? {\r\n        newState: ChartStateType;\r\n        // resizeSubchartObj?: {\r\n        //   subchartIdx: number;\r\n        //   newBottom: number;\r\n        // } | null;\r\n        // editToolObj?: {\r\n        //   resizeInitSubchartIdx: [number, number, number, number][];\r\n        //   newPosition: [number, number];\r\n        // } | null;\r\n      }\r\n    : {};\r\n};\r\n\r\nexport const isAddSubchartAction = (action: ReducerActionType): action is ReducerActionType<\"addSubchart\"> =>\r\n  action.task === \"addSubchart\";\r\nexport const isAddGraphAction = (action: ReducerActionType): action is ReducerActionType<\"addGraph\"> =>\r\n  action.task === \"addGraph\";\r\n// export const isDrawAction = (action: ReducerActionType): action is ReducerActionType<\"draw\"> => action.task === \"draw\";\r\nexport const isSetBackgroundColorAction = (\r\n  action: ReducerActionType\r\n): action is ReducerActionType<\"setBackgroundColor\"> => action.task === \"setBackgroundColor\";\r\nexport const isSetAxisFillColorAction = (action: ReducerActionType): action is ReducerActionType<\"setAxisFillColor\"> =>\r\n  action.task === \"setAxisFillColor\";\r\nexport const isSetAxisStrokeColorAction = (\r\n  action: ReducerActionType\r\n): action is ReducerActionType<\"setAxisStrokeColor\"> => action.task === \"setAxisStrokeColor\";\r\nexport const isSetAxisTextColorAction = (action: ReducerActionType): action is ReducerActionType<\"setAxisTextColor\"> =>\r\n  action.task === \"setAxisTextColor\";\r\nexport const isToggleXaxisGridAction = (action: ReducerActionType): action is ReducerActionType<\"toggleXaxisGrid\"> =>\r\n  action.task === \"toggleXaxisGrid\";\r\nexport const isToggleYaxisGridAction = (action: ReducerActionType): action is ReducerActionType<\"toggleYaxisGrid\"> =>\r\n  action.task === \"toggleYaxisGrid\";\r\nexport const isSetLineChartStrokeColor = (\r\n  action: ReducerActionType\r\n): action is ReducerActionType<\"setLineChartStrokeColor\"> => action.task === \"setLineChartStrokeColor\";\r\nexport const isSetCandleChartUpColor = (\r\n  action: ReducerActionType\r\n): action is ReducerActionType<\"setCandleChartUpColor\"> => action.task === \"setCandleChartUpColor\";\r\nexport const isSetCandleChartDownColor = (\r\n  action: ReducerActionType\r\n): action is ReducerActionType<\"setCandleChartDownColor\"> => action.task === \"setCandleChartDownColor\";\r\nexport const isSetCandleChartStrokeColor = (\r\n  action: ReducerActionType\r\n): action is ReducerActionType<\"setCandleChartStrokeColor\"> => action.task === \"setCandleChartStrokeColor\";\r\nexport const isSetIndicatorParam = (action: ReducerActionType): action is ReducerActionType<\"setIndicatorParam\"> =>\r\n  action.task === \"setIndicatorParam\";\r\nexport const isUpdateInteractionState = (\r\n  action: ReducerActionType\r\n): action is ReducerActionType<\"updateInteractionState\"> => action.task === \"updateInteractionState\";\r\nexport const isSetToolStrokeColorAction = (\r\n  action: ReducerActionType\r\n): action is ReducerActionType<\"setToolStrokeColor\"> => action.task === \"setToolStrokeColor\";\r\nexport const isSetToolAnchorColor = (action: ReducerActionType): action is ReducerActionType<\"setToolAnchorColor\"> =>\r\n  action.task === \"setToolAnchorColor\";\r\nexport const isSetHlineYlevelAction = (action: ReducerActionType): action is ReducerActionType<\"setHlineYlevel\"> =>\r\n  action.task === \"setHlineYlevel\";\r\nexport const isDrawAction = (action: ReducerActionType): action is ReducerActionType<\"draw\"> => action.task === \"draw\";\r\nexport const isToggleFullscreenAction = (action: ReducerActionType): action is ReducerActionType<\"toggleFullscreen\"> =>\r\n  action.task === \"toggleFullscreen\";\r\nexport const isRemoveSubchartAction = (action: ReducerActionType): action is ReducerActionType<\"removeSubchart\"> =>\r\n  action.task === \"removeSubchart\";\r\nexport const isRemoveGraphAction = (action: ReducerActionType): action is ReducerActionType<\"removeGraph\"> =>\r\n  action.task === \"removeGraph\";\r\nexport const isSetGridStrokeColorAction = (\r\n  action: ReducerActionType\r\n): action is ReducerActionType<\"setGridStrokeColor\"> => action.task === \"setGridStrokeColor\";\r\n\r\nexport const chartStateReducer = <T>(current: ChartStateType, action: ReducerActionType<T>): ChartStateType => {\r\n  // addSubchart\r\n  if (isAddSubchartAction(action)) {\r\n    // currently all new subcharts are indicators!\r\n    const chartSeries = action.params.chartSeries;\r\n    const chartName = action.params.chartName;\r\n    const indicator = action.params.indicator;\r\n    const containerHeight = action.params.containerHeight;\r\n    const bottom = containerHeight - current.xaxis.heightXAxis;\r\n    const minMainHeight = 250;\r\n    const heightNewSubchart = Math.min(150, (bottom - minMainHeight) / (current.subCharts.length - 1 + 1));\r\n    const top = current.subCharts.length === 0 ? 0 : bottom - Math.round(heightNewSubchart);\r\n    const style = !!indicator\r\n      ? { strokeColor: [getGraphColors(graphColorsLight, 0)] }\r\n      : { strokeColor: getGraphColors(graphColorsLight, 0) };\r\n\r\n    if (current.subCharts.length === 0)\r\n      return {\r\n        ...current,\r\n        subCharts: [\r\n          createSubChartModel(\r\n            top,\r\n            bottom,\r\n            chartSeries as ChartDataset[],\r\n            chartName,\r\n            style as ChartGraphStateType[\"style\"] | IndicatorGraphStateType[\"style\"]\r\n          ),\r\n        ],\r\n      };\r\n    else {\r\n      const mainHeight = current.subCharts[0].bottom - current.subCharts[0].top;\r\n      const maxHeight =\r\n        mainHeight - heightNewSubchart < minMainHeight\r\n          ? (bottom - minMainHeight - heightNewSubchart) / (current.subCharts.length - 1)\r\n          : null;\r\n\r\n      const subchart = createSubChartModel(\r\n        top,\r\n        bottom,\r\n        chartSeries as ChartDataset[],\r\n        chartName,\r\n        style as ChartGraphStateType[\"style\"] | IndicatorGraphStateType[\"style\"],\r\n        indicator\r\n      );\r\n      const newGraph = subchart.yaxis[0].graphs[0];\r\n\r\n      if (isIndicatorGraph(newGraph) && newGraph.data[newGraph.data.length - 1].prices.length > 1)\r\n        (newGraph as unknown as IndicatorGraphStateType).style.strokeColor = newGraph.data[\r\n          newGraph.data.length - 1\r\n        ].prices.map((x, idx) => getGraphColors(graphColorsLight, idx));\r\n\r\n      return {\r\n        ...current,\r\n        subCharts: [\r\n          ...current.subCharts.map((subChart, subChartIdx) => {\r\n            if (subChartIdx === 0) {\r\n              subChart.bottom = Math.max(subChart.bottom - heightNewSubchart, minMainHeight);\r\n              subChart.top = 0;\r\n            } else if (subChartIdx === current.subCharts.length - 1) {\r\n              subChart.top = current.subCharts[subChartIdx - 1].bottom;\r\n              subChart.bottom = top;\r\n            } else {\r\n              subChart.top = current.subCharts[subChartIdx - 1].bottom;\r\n              subChart.bottom = !!maxHeight\r\n                ? Math.round(subChart.top + maxHeight)\r\n                : subChart.bottom - heightNewSubchart;\r\n            }\r\n            return subChart;\r\n          }),\r\n          subchart,\r\n        ],\r\n      };\r\n    }\r\n  } else if (isRemoveSubchartAction(action)) {\r\n    const subchartIdx = action.params.subchartIdx;\r\n    const dHeight = current.subCharts[subchartIdx].bottom - current.subCharts[subchartIdx].top;\r\n    const dHeightEach = Math.floor(dHeight / (current.subCharts.length - 1));\r\n    const dHeightRest = dHeight % (current.subCharts.length - 1);\r\n    return {\r\n      ...current,\r\n      subCharts: [\r\n        ...current.subCharts.slice(0, subchartIdx).map((subchartSliced, subchartSlicedIdx) => ({\r\n          ...subchartSliced,\r\n          top: subchartSliced.top === 0 ? 0 : subchartSliced.top + dHeightRest + (subchartIdx - 2) * dHeightEach,\r\n          bottom:\r\n            subchartSlicedIdx === 0\r\n              ? subchartSliced.bottom + dHeightEach + dHeightRest\r\n              : subchartSliced.bottom + dHeightEach + dHeightRest + (subchartIdx - 1) * dHeightEach,\r\n        })),\r\n        ...current.subCharts.slice(subchartIdx + 1).map((subchartSliced, subchartSlicedIdx) => ({\r\n          ...subchartSliced,\r\n          top: subchartSliced.top - (subchartSlicedIdx + 1) * dHeightEach,\r\n          bottom:\r\n            subchartSlicedIdx === current.subCharts.slice(subchartIdx + 1).length - 1\r\n              ? subchartSliced.bottom\r\n              : subchartSliced.bottom - (subchartSlicedIdx + 1) * dHeightEach,\r\n        })),\r\n      ],\r\n    };\r\n  } else if (isRemoveGraphAction(action)) {\r\n    const { subchartIdx, yaxisIdx, graphIdx } = action.params;\r\n    if (graphIdx === 0 && current.subCharts[subchartIdx].yaxis[yaxisIdx].graphs.length === 1) {\r\n      // do same like removeSubchart\r\n      const dHeight = current.subCharts[subchartIdx].bottom - current.subCharts[subchartIdx].top;\r\n      const dHeightEach = Math.floor(dHeight / (current.subCharts.length - 1));\r\n      const dHeightRest = dHeight % (current.subCharts.length - 1);\r\n      return {\r\n        ...current,\r\n        subCharts: [\r\n          ...current.subCharts.slice(0, subchartIdx).map((subchartSliced, subchartSlicedIdx) => ({\r\n            ...subchartSliced,\r\n            top: subchartSliced.top === 0 ? 0 : subchartSliced.top + dHeightRest + (subchartIdx - 2) * dHeightEach,\r\n            bottom:\r\n              subchartSlicedIdx === 0\r\n                ? subchartSliced.bottom + dHeightEach + dHeightRest\r\n                : subchartSliced.bottom + dHeightEach + dHeightRest + (subchartIdx - 1) * dHeightEach,\r\n          })),\r\n          ...current.subCharts.slice(subchartIdx + 1).map((subchartSliced, subchartSlicedIdx) => ({\r\n            ...subchartSliced,\r\n            top: subchartSliced.top - (subchartSlicedIdx + 1) * dHeightEach,\r\n            bottom:\r\n              subchartSlicedIdx === current.subCharts.slice(subchartIdx + 1).length - 1\r\n                ? subchartSliced.bottom\r\n                : subchartSliced.bottom - (subchartSlicedIdx + 1) * dHeightEach,\r\n          })),\r\n        ],\r\n      };\r\n    } else {\r\n      return {\r\n        ...current,\r\n        subCharts: [\r\n          ...current.subCharts.slice(0, subchartIdx),\r\n          {\r\n            ...current.subCharts[subchartIdx],\r\n            yaxis: [\r\n              ...current.subCharts[subchartIdx].yaxis.slice(0, yaxisIdx),\r\n              {\r\n                ...current.subCharts[subchartIdx].yaxis[yaxisIdx],\r\n                graphs: [\r\n                  ...current.subCharts[subchartIdx].yaxis[yaxisIdx].graphs.slice(0, graphIdx),\r\n                  // { ...current.subCharts[subchartIdx].yaxis[yaxisIdx].graphs[graphIdx] },\r\n                  ...current.subCharts[subchartIdx].yaxis[yaxisIdx].graphs.slice(graphIdx + 1),\r\n                ],\r\n              },\r\n              ...current.subCharts[subchartIdx].yaxis.slice(yaxisIdx + 1),\r\n            ],\r\n          },\r\n          ...current.subCharts.slice(subchartIdx + 1),\r\n        ],\r\n      };\r\n    }\r\n  } else if (isAddGraphAction(action)) {\r\n    const chartSeries = action.params.chartSeries;\r\n    const chartName = action.params.chartName;\r\n    const indicator = !!action.params.indicator ? action.params.indicator : null;\r\n    const subchartIdx = action.params.subchartIdx;\r\n    // const style = {\r\n    //   strokeColor: getGraphColors(graphColorsLight, current.subCharts[subchartIdx].yaxis[0].graphs.length),\r\n    // };\r\n    const style = !!indicator\r\n      ? { strokeColor: [getGraphColors(graphColorsLight, current.subCharts[subchartIdx].yaxis[0].graphs.length)] }\r\n      : { strokeColor: getGraphColors(graphColorsLight, current.subCharts[subchartIdx].yaxis[0].graphs.length) };\r\n\r\n    const newGraph = !!indicator\r\n      ? createIndicatorGraphModel(\r\n          chartSeries as ChartDataSeries,\r\n          chartName,\r\n          indicator,\r\n          style as unknown as IndicatorGraphStateType[\"style\"]\r\n        )\r\n      : createChartGraphModel(chartSeries as ChartDataSeries, chartName, style as ChartGraphStateType[\"style\"]);\r\n    const graph = newGraph as GraphStateType;\r\n    if (isIndicatorGraph(graph) && graph.data[newGraph.data.length - 1].prices.length > 1)\r\n      (graph as unknown as IndicatorGraphStateType).style.strokeColor = graph.data[newGraph.data.length - 1].prices.map(\r\n        (x, idx) => getGraphColors(graphColorsLight, idx)\r\n      );\r\n\r\n    return {\r\n      ...current,\r\n      subCharts: [\r\n        ...current.subCharts.map((subChart, subChartIdx) => {\r\n          if (subChartIdx === subchartIdx)\r\n            return {\r\n              ...subChart,\r\n              yaxis: [{ ...subChart.yaxis[0], graphs: [...subChart.yaxis[0].graphs, { ...(newGraph as any) }] }],\r\n            };\r\n          else return subChart;\r\n        }),\r\n      ],\r\n    };\r\n  } else if (isDrawAction(action)) {\r\n    const xy = action.params.xy;\r\n    const subchartIdx = action.params.subchartIdx;\r\n    const defaultDrawState: ChartStateType[\"draw\"] = { isDrawing: false, pixXy: [] };\r\n    const nPoints = !action.params.type\r\n      ? 0\r\n      : [\"hline\", \"vline\"].includes(action.params.type)\r\n      ? 1\r\n      : [\"trendline\"].includes(action.params.type)\r\n      ? 2\r\n      : 0;\r\n    // console.log(\"HI\", xy, subchartIdx, nPoints, action);\r\n\r\n    if (!nPoints || !action.params.type) {\r\n      return { ...current, draw: defaultDrawState };\r\n    }\r\n    // init draw command -> switch to draw mode\r\n    else if (!xy && !!action.params.type) {\r\n      return { ...current, draw: { isDrawing: true, pixXy: [], type: action.params.type } };\r\n    }\r\n    return current;\r\n  } else if (isSetBackgroundColorAction(action)) {\r\n    const color = action.params.color;\r\n    return { ...current, backgroundColor: color };\r\n  } else if (isSetGridStrokeColorAction(action)) {\r\n    const color = action.params.color;\r\n    return {\r\n      ...current,\r\n      grid: { ...current.grid, style: { ...current.grid.style, strokeColor: color } },\r\n    };\r\n  } else if (isSetAxisFillColorAction(action)) {\r\n    const color = action.params.color;\r\n    return {\r\n      ...current,\r\n      xaxis: {\r\n        ...current.xaxis,\r\n        style: { ...current.xaxis.style, fillColor: color },\r\n      },\r\n      yaxis: { ...current.yaxis, style: { ...current.yaxis.style, fillColor: color } },\r\n    };\r\n  } else if (isSetAxisStrokeColorAction(action)) {\r\n    const color = action.params.color;\r\n    return {\r\n      ...current,\r\n      xaxis: {\r\n        ...current.xaxis,\r\n        style: { ...current.xaxis.style, strokeColor: color },\r\n      },\r\n      yaxis: { ...current.yaxis, style: { ...current.yaxis.style, strokeColor: color } },\r\n    };\r\n  } else if (isSetAxisTextColorAction(action)) {\r\n    const color = action.params.color;\r\n    return {\r\n      ...current,\r\n      xaxis: {\r\n        ...current.xaxis,\r\n        style: { ...current.xaxis.style, fontColor: color },\r\n      },\r\n      yaxis: { ...current.yaxis, style: { ...current.yaxis.style, fontColor: color } },\r\n    };\r\n  } else if (isToggleXaxisGridAction(action)) {\r\n    return {\r\n      ...current,\r\n      grid: { ...current.grid, useGridX: !current.grid.useGridX },\r\n    };\r\n  } else if (isToggleYaxisGridAction(action)) {\r\n    return {\r\n      ...current,\r\n      grid: { ...current.grid, useGridY: !current.grid.useGridY },\r\n    };\r\n  } else if (isToggleFullscreenAction(action)) {\r\n    return { ...current, fullscreen: !current.fullscreen };\r\n  } else if (isSetLineChartStrokeColor(action)) {\r\n    const subchartIdx = action.params.subchartIdx;\r\n    const yaxisIdx = action.params.yaxisIdx;\r\n    const graphIdx = action.params.graphIdx;\r\n    const color = action.params.color;\r\n    const graph = current.subCharts[subchartIdx].yaxis[yaxisIdx].graphs[graphIdx];\r\n    return {\r\n      ...current,\r\n      subCharts: [\r\n        ...current.subCharts.slice(0, subchartIdx),\r\n        {\r\n          ...current.subCharts[subchartIdx],\r\n          yaxis: [\r\n            {\r\n              ...current.subCharts[subchartIdx].yaxis[yaxisIdx],\r\n              graphs: [\r\n                ...current.subCharts[subchartIdx].yaxis[yaxisIdx].graphs.slice(0, graphIdx),\r\n                {\r\n                  ...current.subCharts[subchartIdx].yaxis[yaxisIdx].graphs[graphIdx],\r\n                  style: {\r\n                    ...current.subCharts[subchartIdx].yaxis[yaxisIdx].graphs[graphIdx].style,\r\n                    strokeColor: [color],\r\n                  },\r\n                },\r\n                ...current.subCharts[subchartIdx].yaxis[yaxisIdx].graphs.slice(graphIdx + 1),\r\n              ],\r\n            },\r\n          ],\r\n        },\r\n        ...current.subCharts.slice(subchartIdx + 1),\r\n      ],\r\n    };\r\n  } else if (\r\n    isSetCandleChartUpColor(action) ||\r\n    isSetCandleChartDownColor(action) ||\r\n    isSetCandleChartStrokeColor(action)\r\n  ) {\r\n    const subchartIdx = action.params.subchartIdx;\r\n    const yaxisIdx = action.params.yaxisIdx;\r\n    const graphIdx = action.params.graphIdx;\r\n    const color = action.params.color;\r\n    const prop = isSetCandleChartUpColor(action)\r\n      ? \"candleUpColor\"\r\n      : isSetCandleChartDownColor(action)\r\n      ? \"candleDownColor\"\r\n      : isSetCandleChartStrokeColor(action)\r\n      ? \"candleStrokeColor\"\r\n      : null;\r\n    if (!prop) return current;\r\n    return {\r\n      ...current,\r\n      subCharts: [\r\n        ...current.subCharts.slice(0, subchartIdx),\r\n        {\r\n          ...current.subCharts[subchartIdx],\r\n          yaxis: [\r\n            {\r\n              ...current.subCharts[subchartIdx].yaxis[yaxisIdx],\r\n              graphs: [\r\n                ...current.subCharts[subchartIdx].yaxis[yaxisIdx].graphs.slice(0, graphIdx),\r\n                {\r\n                  ...current.subCharts[subchartIdx].yaxis[yaxisIdx].graphs[graphIdx],\r\n                  style: {\r\n                    ...current.subCharts[subchartIdx].yaxis[yaxisIdx].graphs[graphIdx].style,\r\n                    [prop]: color,\r\n                  },\r\n                },\r\n                ...current.subCharts[subchartIdx].yaxis[yaxisIdx].graphs.slice(graphIdx + 1),\r\n              ],\r\n            },\r\n          ],\r\n        },\r\n        ...current.subCharts.slice(subchartIdx + 1),\r\n      ],\r\n    };\r\n  } else if (isSetToolStrokeColorAction(action) || isSetToolAnchorColor(action)) {\r\n    const subchartIdx = action.params.subchartIdx;\r\n    const yaxisIdx = action.params.yaxisIdx;\r\n    const graphIdx = action.params.toolIdx;\r\n    const color = action.params.color;\r\n    const prop = isSetToolStrokeColorAction(action)\r\n      ? \"strokeColor\"\r\n      : isSetToolAnchorColor(action)\r\n      ? \"anchorColor\"\r\n      : null;\r\n    if (!prop) return current;\r\n    return {\r\n      ...current,\r\n      subCharts: [\r\n        ...current.subCharts.slice(0, subchartIdx),\r\n        {\r\n          ...current.subCharts[subchartIdx],\r\n          yaxis: [\r\n            {\r\n              ...current.subCharts[subchartIdx].yaxis[yaxisIdx],\r\n              tools: [\r\n                ...current.subCharts[subchartIdx].yaxis[yaxisIdx].tools.slice(0, graphIdx),\r\n                {\r\n                  ...current.subCharts[subchartIdx].yaxis[yaxisIdx].tools[graphIdx],\r\n                  style: {\r\n                    ...current.subCharts[subchartIdx].yaxis[yaxisIdx].tools[graphIdx].style,\r\n                    [prop]: color,\r\n                  },\r\n                },\r\n                ...current.subCharts[subchartIdx].yaxis[yaxisIdx].tools.slice(graphIdx + 1),\r\n              ],\r\n            },\r\n          ],\r\n        },\r\n        ...current.subCharts.slice(subchartIdx + 1),\r\n      ],\r\n    };\r\n  } else if (isSetIndicatorParam(action)) {\r\n    const subchartIdx = action.params.subchartIdx;\r\n    const yaxisIdx = action.params.yaxisIdx;\r\n    const graphIdx = action.params.graphIdx;\r\n    const paramIdx = action.params.paramIdx;\r\n    const val = action.params.val;\r\n\r\n    const indicatorGraph = current.subCharts[subchartIdx].yaxis[yaxisIdx].graphs[graphIdx];\r\n\r\n    if (!isIndicatorGraph(indicatorGraph)) return current;\r\n    const fn = indicatorGraph.indicator.indicatorFn;\r\n    const srcData = current.subCharts[0].yaxis[0].graphs[0].data as ChartDataSeries;\r\n    let params = indicatorGraph.indicator.params.map((val) => val.val);\r\n    params[paramIdx] = val;\r\n    const indicatorData = fn(srcData, indicatorGraph.name, ...params);\r\n    console.log(\r\n      \"HI!! HII!\",\r\n      val,\r\n      subchartIdx,\r\n      yaxisIdx,\r\n      graphIdx,\r\n      paramIdx,\r\n      isIndicatorGraph(indicatorGraph),\r\n      params,\r\n      indicatorData,\r\n      {\r\n        ...indicatorGraph.indicator,\r\n        params: [\r\n          ...indicatorGraph.indicator.params.slice(0, paramIdx),\r\n          {\r\n            ...indicatorGraph.indicator.params[paramIdx],\r\n            val: val,\r\n          },\r\n          ...indicatorGraph.indicator.params.slice(paramIdx + 1),\r\n        ],\r\n      }\r\n    );\r\n    // const newIndicatorGraph = { ...indicatorGraph };\r\n    // newIndicatorGraph.data = indicatorData;\r\n    // newIndicatorGraph.indicator.params[paramIdx].val = val;\r\n    return {\r\n      ...current,\r\n      subCharts: [\r\n        ...current.subCharts.slice(0, subchartIdx),\r\n        {\r\n          ...current.subCharts[subchartIdx],\r\n          yaxis: [\r\n            {\r\n              ...current.subCharts[subchartIdx].yaxis[yaxisIdx],\r\n              graphs: [\r\n                ...current.subCharts[subchartIdx].yaxis[yaxisIdx].graphs.slice(0, graphIdx),\r\n                {\r\n                  ...indicatorGraph,\r\n                  data: indicatorData,\r\n                  indicator: {\r\n                    ...indicatorGraph.indicator,\r\n                    params: [\r\n                      ...indicatorGraph.indicator.params.slice(0, paramIdx),\r\n                      {\r\n                        ...indicatorGraph.indicator.params[paramIdx],\r\n                        val: val,\r\n                      },\r\n                      ...indicatorGraph.indicator.params.slice(paramIdx + 1),\r\n                    ],\r\n                  },\r\n                } as any,\r\n                ...current.subCharts[subchartIdx].yaxis[yaxisIdx].graphs.slice(graphIdx + 1),\r\n              ],\r\n            },\r\n          ],\r\n        },\r\n        ...current.subCharts.slice(subchartIdx + 1),\r\n      ],\r\n    };\r\n  } else if (isSetHlineYlevelAction(action)) {\r\n    const subchartIdx = action.params.subchartIdx;\r\n    const yaxisIdx = action.params.yaxisIdx;\r\n    const toolIdx = action.params.toolIdx;\r\n    const val = action.params.val as number;\r\n    const anchorX = current.subCharts[subchartIdx].yaxis[yaxisIdx].tools[toolIdx].xy[0][0];\r\n    const newAnchor: [number, number] = [anchorX, val];\r\n    return {\r\n      ...current,\r\n      subCharts: [\r\n        ...current.subCharts.slice(0, subchartIdx),\r\n        {\r\n          ...current.subCharts[subchartIdx],\r\n          yaxis: [\r\n            {\r\n              ...current.subCharts[subchartIdx].yaxis[yaxisIdx],\r\n              tools: [\r\n                ...current.subCharts[subchartIdx].yaxis[yaxisIdx].tools.slice(0, toolIdx),\r\n                { ...current.subCharts[subchartIdx].yaxis[yaxisIdx].tools[toolIdx], xy: [newAnchor] },\r\n                ...current.subCharts[subchartIdx].yaxis[yaxisIdx].tools.slice(toolIdx + 1),\r\n              ],\r\n            },\r\n          ],\r\n        },\r\n        ...current.subCharts.slice(subchartIdx + 1),\r\n      ],\r\n    };\r\n  } else if (isUpdateInteractionState(action)) {\r\n    // const nSubcharts = current.subCharts.length;\r\n    return {\r\n      ...current,\r\n      pointer: action.params.newState.pointer,\r\n      containerSize: action.params.newState.containerSize,\r\n      // xaxis: { ...current.xaxis, ...action.params.newState.xaxis },\r\n      subCharts: action.params.newState.subCharts,\r\n      draw: { ...current.draw, ...action.params.newState.draw },\r\n      xaxis: { ...current.xaxis, ...action.params.newState.xaxis },\r\n    };\r\n  }\r\n\r\n  return current;\r\n};\r\n","import { ReducerActionTaskType, ReducerActionType } from \"./CChartStateReducer\";\r\nimport { ChartDataSeries, DataSeries } from \"../Types/CChartTypes\";\r\n\r\nimport {\r\n  AdditionalIndicatorGraphStateType,\r\n  ChartStateType,\r\n  CalculatedChartStateType,\r\n  TypedDispatcher,\r\n} from \"../Types/CChartStateTypes\";\r\nconst addSubchart = (\r\n  chartSeries: DataSeries,\r\n  chartName: string,\r\n  containerHeight: number,\r\n  Dispatch: TypedDispatcher<\"addSubchart\">,\r\n  indicator?: AdditionalIndicatorGraphStateType[\"indicator\"]\r\n) => {\r\n  const action: ReducerActionType<\"addSubchart\"> = {\r\n    task: \"addSubchart\",\r\n    params: { chartSeries, chartName, indicator, containerHeight },\r\n  };\r\n  Dispatch(action);\r\n};\r\n\r\nconst addGraph = (\r\n  chartSeries: DataSeries,\r\n  chartName: string,\r\n  subchartIdx: number,\r\n  Dispatch: TypedDispatcher<\"addGraph\">,\r\n  indicator?: AdditionalIndicatorGraphStateType[\"indicator\"]\r\n) => {\r\n  const action: ReducerActionType<\"addGraph\"> = {\r\n    task: \"addGraph\",\r\n    params: { subchartIdx, chartSeries, indicator, chartName },\r\n  };\r\n  (Dispatch as React.Dispatch<ReducerActionType<\"addGraph\">>)(action);\r\n};\r\n\r\nexport const pixToX = (pixX: number, translated: number, widthPerTick: number) => {\r\n  return (pixX - translated) / widthPerTick;\r\n};\r\n\r\nexport const getChartMethods = (\r\n  ChartState: ChartStateType,\r\n  containerHeight: number,\r\n  Dispatch: TypedDispatcher<ReducerActionTaskType>\r\n): CalculatedChartStateType[\"methods\"] => ({\r\n  addGraph: (\r\n    chartSeries: ChartDataSeries,\r\n    chartName: string,\r\n    subchartIdx: number,\r\n    indicator?: AdditionalIndicatorGraphStateType[\"indicator\"]\r\n  ) => addGraph(chartSeries, chartName, subchartIdx, Dispatch, indicator),\r\n  addSubchart: (\r\n    chartSeries: DataSeries,\r\n    chartName: string,\r\n    indicator?: AdditionalIndicatorGraphStateType[\"indicator\"]\r\n  ) => addSubchart(chartSeries, chartName, containerHeight, Dispatch, indicator),\r\n  getSubchart: (subchartIdx: number) => ChartState.subCharts[subchartIdx],\r\n  getYaxis: (subchartIdx: number, yaxisIdx: number) => ChartState.subCharts[subchartIdx].yaxis[yaxisIdx],\r\n  getGraph: (subchartIdx: number, yaxisIdx: number, graphIdx: number) =>\r\n    ChartState.subCharts[subchartIdx].yaxis[yaxisIdx].graphs[graphIdx],\r\n  xToPix: (x: number, translatedX?: number) => {\r\n    const { widthPerTick, totalTranslatedX } = ChartState.xaxis;\r\n    const translatedXint = translatedX !== undefined ? translatedX : totalTranslatedX;\r\n    return x * widthPerTick + translatedXint;\r\n  },\r\n  pixToX: (pixX: number, translatedX?: number) => {\r\n    const { widthPerTick, totalTranslatedX } = ChartState.xaxis;\r\n    const translatedXint = translatedX !== undefined ? translatedX : totalTranslatedX;\r\n    return (pixX - translatedXint) / widthPerTick;\r\n  },\r\n  yToPix: (y: number, subchartIdx: number, yaxisIdx: number, translatedY?: number) => {\r\n    const { heightPerPt, decimals, translatedY: stateTranslatedY } = ChartState.subCharts[subchartIdx].yaxis[yaxisIdx];\r\n    const translatedYint = translatedY !== undefined ? translatedY : stateTranslatedY;\r\n    return ChartState.subCharts[subchartIdx].bottom - y * Math.pow(10, decimals) * heightPerPt + translatedYint;\r\n  },\r\n  pixToY: (pixY: number, subchartIdx: number, yaxisIdx: number, translatedY?: number) => {\r\n    const { heightPerPt, decimals, translatedY: stateTranslatedY } = ChartState.subCharts[subchartIdx].yaxis[yaxisIdx];\r\n    const translatedYint = translatedY !== undefined ? translatedY : stateTranslatedY;\r\n    return ((ChartState.subCharts[subchartIdx].bottom + translatedYint - pixY) / heightPerPt) * Math.pow(10, -decimals);\r\n  },\r\n});\r\n","// import { pixToX } from \"../CChart\";\r\nimport { getDateString } from \"../Time/CChartDateTime\";\r\nimport { getOptimalPeriod, isNewPeriod } from \"../Time/CChartPeriod\";\r\nimport { InteractiveXaxisType, ChartGraphStateType, ChartStateType } from \"../Types/CChartStateTypes\";\r\nimport { ChartPeriodType } from \"../Types/CChartTimeTypes\";\r\n\r\nexport const pureXToPix = (x: number, translated: number, widthPerTick: number) => {\r\n  return x * widthPerTick + translated;\r\n};\r\nexport const purePixToX = (pixX: number, translated: number, widthPerTick: number) => {\r\n  return (pixX - translated) / widthPerTick;\r\n};\r\n\r\nexport const getInteractiveXaxisState = (\r\n  currentXaxis: InteractiveXaxisType & { scaleInitWidthPerTick: number | null; scaleInitTranslatedX: number },\r\n  onDrag: ChartStateType[\"pointer\"][\"drag\"],\r\n  wheel: ChartStateType[\"pointer\"][\"wheel\"],\r\n  onMove: ChartStateType[\"pointer\"][\"move\"],\r\n  initWidthTickX: number,\r\n  shallUpdateDrag: boolean,\r\n  clickedChart: boolean,\r\n  clickedXaxis: boolean,\r\n  canvasWidth: number,\r\n  nDatasets: number,\r\n): InteractiveXaxisType & { scaleInitWidthPerTick: number | null; scaleInitTranslatedX: number } => {\r\n  const isWheeling = !!wheel?.isWheeling;\r\n  const wheeldY = wheel?.delta[1];\r\n  const initWheelMousePos = onMove?.xy;\r\n\r\n  const scaleFn = (pixX: number) => {\r\n    const delta =\r\n      Math.round(\r\n        Math.min(\r\n          (Math.max(pixX + 640, 0) * (initWidthTickX - 0.5)) / 640 - (initWidthTickX - 0.5),\r\n          -initWidthTickX + canvasWidth / 3\r\n        ) / 0.5\r\n      ) * 0.5;\r\n    return delta;\r\n  };\r\n\r\n  console.log(currentXaxis.xEnd - currentXaxis.xStart, currentXaxis.xStart, currentXaxis.xEnd);\r\n  if (!!shallUpdateDrag) {\r\n    const init = onDrag?.initial;\r\n    if (!init) return currentXaxis;\r\n    if (clickedChart && !wheeldY) {\r\n      const totalTranslatedX = !!onDrag?.delta\r\n        ? Math.max(\r\n            Math.min(\r\n              onDrag.delta[0] + currentXaxis.totalTranslatedX,\r\n              canvasWidth - 2 * currentXaxis.scaledWidthPerTick\r\n            ),\r\n            -( (nDatasets - 3) * currentXaxis.scaledWidthPerTick)\r\n          )\r\n        : currentXaxis.totalTranslatedX;\r\n      return { ...currentXaxis, totalTranslatedX };\r\n    } else if (clickedXaxis && !wheeldY) {\r\n      let scaleInitWidthPerTick: number | null = !currentXaxis.scaleInitWidthPerTick\r\n        ? currentXaxis.scaledWidthPerTick\r\n        : currentXaxis.scaleInitWidthPerTick;\r\n      const scaleInitTranslatedX = !currentXaxis.scaleInitTranslatedX\r\n        ? currentXaxis.totalTranslatedX\r\n        : currentXaxis.scaleInitTranslatedX;\r\n      // shall not scale lower than tickWidth of 0.5\r\n      let totalScaleX = !!onDrag?.delta ? currentXaxis.totalScaleX + onDrag?.delta[0] : currentXaxis.totalScaleX;\r\n      totalScaleX = Math.min(\r\n        Math.max(totalScaleX, -640),\r\n        ((-initWidthTickX + canvasWidth / 3 + initWidthTickX - 0.5) * 640) / (initWidthTickX - 0.5) - 640\r\n      );\r\n      const scaledWidthPerTick = initWidthTickX + scaleFn(totalScaleX);\r\n      const translatedXonStart = scaleInitTranslatedX;\r\n      const initPixX = init[0];\r\n      const initXexact = (init[0] - translatedXonStart) / (scaleInitWidthPerTick as number);\r\n      const newPos = initXexact * scaledWidthPerTick + translatedXonStart;\r\n\r\n      const totalTranslatedX = scaleInitTranslatedX - newPos + initPixX;\r\n      if (!onDrag?.isDragging) {\r\n        scaleInitWidthPerTick = null;\r\n      }\r\n      return {\r\n        ...currentXaxis,\r\n        scaleInitWidthPerTick,\r\n        scaleInitTranslatedX,\r\n        totalScaleX,\r\n        scaledWidthPerTick,\r\n        totalTranslatedX,\r\n      };\r\n    }\r\n  } else if (!!isWheeling && !!wheeldY) {\r\n    let scaleInitWidthPerTick: number | null = currentXaxis.scaledWidthPerTick;\r\n    const scaleInitTranslatedX = currentXaxis.totalTranslatedX;\r\n\r\n    // shall not scale lower than tickWidth of 0.5\r\n    let totalScaleX = currentXaxis.totalScaleX + wheeldY / 10;\r\n    totalScaleX = Math.min(\r\n      Math.max(totalScaleX, -640),\r\n      ((-initWidthTickX + canvasWidth / 3 + initWidthTickX - 0.5) * 640) / (initWidthTickX - 0.5) - 640\r\n    );\r\n    const scaledWidthPerTick = initWidthTickX + scaleFn(totalScaleX);\r\n    const translatedXonStart = scaleInitTranslatedX;\r\n    const initPixX = !!initWheelMousePos ? initWheelMousePos[0] : 0;\r\n    const initXexact =\r\n      ((!!initWheelMousePos ? initWheelMousePos[0] : 0) - translatedXonStart) / (scaleInitWidthPerTick as number);\r\n    const newPos = Math.round(initXexact) * scaledWidthPerTick + currentXaxis.totalTranslatedX; //translatedXonStart;\r\n\r\n    const totalTranslatedX = (scaleInitTranslatedX as number) - newPos + initPixX;\r\n    if (!isWheeling) {\r\n      scaleInitWidthPerTick = null;\r\n    }\r\n    return {\r\n      ...currentXaxis,\r\n      scaleInitWidthPerTick,\r\n      scaleInitTranslatedX,\r\n      totalScaleX,\r\n      scaledWidthPerTick,\r\n      totalTranslatedX,\r\n    };\r\n  }\r\n  return currentXaxis;\r\n};\r\n\r\nexport const calculateCurrentXaxis = (\r\n  widthPerTick: number,\r\n  translatedPixX: number,\r\n  containerWidth: number,\r\n  widthYAxis: number,\r\n  mainGraph: ChartGraphStateType | null\r\n): Omit<\r\n  ChartStateType[\"xaxis\"],\r\n  | \"style\"\r\n  | \"heightXAxis\"\r\n  | \"heightTickMarkLines\"\r\n  | \"totalTranslatedX\"\r\n  | \"totalScaleX\"\r\n  | \"scaledWidthPerTick\"\r\n  | \"scaleInitWidthPerTick\"\r\n  | \"scaleInitTranslatedX\"\r\n> => {\r\n  const xAxisTicks: { x: number; dateString: string }[] = [];\r\n\r\n  const xStart = Math.max(Math.ceil(-translatedPixX / widthPerTick), 0);\r\n  const nMainData = mainGraph?.data.length;\r\n  const pixXStart = Math.max(Math.ceil(-translatedPixX / widthPerTick), 0) * widthPerTick + translatedPixX;\r\n  let pixXend = 0,\r\n    xEnd = 0;\r\n  const startNoDataPeriod = Math.abs(Math.min(Math.ceil(-translatedPixX / widthPerTick), 0));\r\n  let endNoDataPeriod = 0;\r\n  let noDataPeriodPortion = 0;\r\n  let optPeriodRes = null;\r\n  if (!!containerWidth && !!widthYAxis && !!nMainData) {\r\n    // pixXend = Math.min(containerWidth - widthYAxis, nMainData * widthPerTick + translatedPixX);\r\n    // xEnd = Math.min(Math.floor((pixXend - translatedPixX) / widthPerTick), nMainData - 1);\r\n    // endNoDataPeriod = Math.max(\r\n    //   Math.floor((containerWidth - widthYAxis - translatedPixX) / widthPerTick) - nMainData,\r\n    //   0\r\n    // );\r\n    pixXend = Math.min(containerWidth, nMainData * widthPerTick + translatedPixX);\r\n    xEnd = Math.min(Math.floor((pixXend - translatedPixX) / widthPerTick), nMainData - 1);\r\n    endNoDataPeriod = Math.max(Math.floor((containerWidth - translatedPixX) / widthPerTick) - nMainData, 0);\r\n\r\n    noDataPeriodPortion = (startNoDataPeriod + endNoDataPeriod) / (xEnd - xStart + startNoDataPeriod + endNoDataPeriod);\r\n    if (!!mainGraph) {\r\n      optPeriodRes = getOptimalPeriod(\r\n        mainGraph.data,\r\n        xStart,\r\n        xEnd,\r\n        mainGraph.meta,\r\n        noDataPeriodPortion,\r\n        Object.assign({}, mainGraph.dateStat)\r\n      );\r\n\r\n      if (!!optPeriodRes && !!mainGraph.meta.chartPeriod) {\r\n        let pixXi = pixXStart;\r\n        let xi = xStart;\r\n        while (pixXi < pixXend) {\r\n          const periodToDraw = isNewPeriod(mainGraph.data[xi].date, mainGraph.dateStat, mainGraph.meta.chartPeriod, {\r\n            ...(optPeriodRes as ChartPeriodType),\r\n          });\r\n          if (!periodToDraw) {\r\n            pixXi += widthPerTick;\r\n            xi++;\r\n            continue;\r\n          }\r\n          const dateString = getDateString(mainGraph.data[xi].date, periodToDraw);\r\n          xAxisTicks.push({ x: pixXi, dateString: dateString.toString() });\r\n          pixXi += widthPerTick;\r\n          xi++;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  return {\r\n    xStart: xStart,\r\n    pixXStart: pixXStart,\r\n    xEnd: xEnd,\r\n    pixXEnd: pixXend,\r\n    widthPerTick,\r\n    startNoDataPeriod,\r\n    endNoDataPeriod,\r\n    noDataPeriodPortion,\r\n    xAxisTicks,\r\n    optPeriodRes,\r\n  };\r\n};\r\n","import { CalculatedChartStateType, ChartStateType, isIndicatorGraph } from \"../Types/CChartStateTypes\";\r\nimport { DataSeries, Dataset, isCandleChartDataset, isIndicatorDataset } from \"../Types/CChartTypes\";\r\nimport { getDecimals, isNullish } from \"../utils\";\r\n\r\nexport const pureYToPix = (y: number, pixYBottom: number, decimals: number, translatedY: number, pixPerPt: number) => {\r\n  return pixYBottom - y * Math.pow(10, decimals) * pixPerPt + translatedY;\r\n};\r\nexport const purePixToY = (\r\n  pixY: number,\r\n  pixYBottom: number,\r\n  decimals: number,\r\n  translatedY: number,\r\n  pixPerPt: number\r\n) => {\r\n  return ((pixYBottom + translatedY - pixY) / pixPerPt) * Math.pow(10, -decimals);\r\n};\r\n\r\nexport const snapPixYToPrices = (\r\n  pixY: number,\r\n  dataset: Dataset,\r\n  subcharts: ChartStateType[\"subCharts\"] | null,\r\n  subchartIdx: number,\r\n  yaxisIdx: number,\r\n  snapTolerance?: number\r\n) => {\r\n  const snapTol = !!snapTolerance ? snapTolerance : 10;\r\n  if (isNullish(pixY) || isNullish(subcharts) || isNullish(subchartIdx) || isNullish(yaxisIdx) || isNullish(dataset))\r\n    return null;\r\n  const prices = [];\r\n  if (isIndicatorDataset(dataset)) {\r\n    if (!!dataset.prices[0]) prices.push(dataset.prices[0]);\r\n  } else {\r\n    if (isCandleChartDataset(dataset)) prices.push(dataset.open, dataset.high, dataset.low, dataset.close);\r\n    else prices.push(dataset.close);\r\n  }\r\n  if (prices.length === 0) return null;\r\n\r\n  let snapRes: { y: string; pixY: number }[] = [];\r\n  prices.forEach((price, priceIdx) => {\r\n    const yPixPrice = pureYToPix(\r\n      price,\r\n      subcharts[subchartIdx].bottom,\r\n      subcharts[subchartIdx].yaxis[yaxisIdx].decimals,\r\n      subcharts[subchartIdx].yaxis[yaxisIdx].translatedY,\r\n      subcharts[subchartIdx].yaxis[yaxisIdx].heightPerPt\r\n    );\r\n    if (yPixPrice >= pixY - snapTol && yPixPrice <= pixY + snapTol) {\r\n      snapRes.push({ y: price.toFixed(getDecimals(price)), pixY: yPixPrice });\r\n    }\r\n  });\r\n\r\n  if (!!snapRes)\r\n    return snapRes.sort((a, b) => {\r\n      if (Math.abs(a.pixY - pixY) < Math.abs(b.pixY - pixY)) return -1;\r\n      else if (Math.abs(a.pixY - pixY) > Math.abs(b.pixY - pixY)) return 1;\r\n      return 0;\r\n    });\r\n  return null;\r\n  // for (let i = 0; i < prices.length; i++) {\r\n  //   const price = prices[i];\r\n  //   const yPixPrice = pureYToPix(\r\n  //     price,\r\n  //     subcharts[subchartIdx].bottom,\r\n  //     subcharts[subchartIdx].yaxis[yaxisIdx].decimals,\r\n  //     subcharts[subchartIdx].yaxis[yaxisIdx].translatedY,\r\n  //     subcharts[subchartIdx].yaxis[yaxisIdx].heightPerPt\r\n  //   );\r\n  //   if (yPixPrice >= pixY - snapTol && yPixPrice <= pixY + snapTol) {\r\n  //     snapRes.push({ y: price.toFixed(getDecimals(price)), pixY: yPixPrice });\r\n  //   }\r\n  // }\r\n  // if (snapRes.length > 0) {\r\n  // }\r\n};\r\n\r\nexport function GetYOptInterval(max: number, min: number, dec: number, targetSteps: number) {\r\n  let initIntervalStep = 1 / Math.pow(10, dec);\r\n  let curIntervalStep = initIntervalStep;\r\n  let optIntervalStep = curIntervalStep;\r\n  const optimizationFunction = (steps: number) => Math.abs((max - min) / steps - targetSteps);\r\n  let optimizer = optimizationFunction(curIntervalStep); // - targetSteps);\r\n\r\n  let i = 0;\r\n  while (curIntervalStep < max - min) {\r\n    for (let j = 0; j <= 2; j++) {\r\n      const factor = j === 0 ? 1 : j === 1 ? 2.5 : 5.0;\r\n      let curOptimizerRes = optimizationFunction(curIntervalStep * factor);\r\n      if (curOptimizerRes < optimizer) {\r\n        optimizer = curOptimizerRes;\r\n        optIntervalStep = curIntervalStep * factor;\r\n      }\r\n    }\r\n    i++;\r\n    curIntervalStep = initIntervalStep * Math.pow(10, i);\r\n  }\r\n  return parseFloat(optIntervalStep.toFixed(dec));\r\n}\r\n\r\nexport const calculateCurrentGraphs = (\r\n  subcharts: ChartStateType[\"subCharts\"] | undefined,\r\n  widthPerTick: number,\r\n  xStart: number,\r\n  xEnd: number,\r\n  pixXstart: number,\r\n  pixXend: number\r\n): CalculatedChartStateType[\"subCharts\"] | null => {\r\n  if (!subcharts) return null;\r\n  if (subcharts.length === 0) return null;\r\n\r\n  const calculatedSubcharts = subcharts;\r\n\r\n  calculatedSubcharts.forEach((subchart, subchartIdx) => {\r\n    const mainYaxis: { pixY: number; label: string }[] = [];\r\n    subchart.yaxis.forEach((yaxis, yaxisIdx) => {\r\n      let yMinExactAllGraphs: number | null = null;\r\n      let yMaxExactAllGraphs: number | null = null;\r\n      let maxDecimals: number = 0;\r\n      yaxis.graphs.forEach((graphM, graphIdx) => {\r\n        const graph = calculatedSubcharts[subchartIdx].yaxis[yaxisIdx].graphs[graphIdx];\r\n        const data = graph.data;\r\n        graph.datasets.last = {\r\n          data: data[xEnd],\r\n          x: xEnd,\r\n          pixX: pixXend,\r\n          dateString: \"\",\r\n        };\r\n        graph.datasets.first = {\r\n          data: data[xStart],\r\n          x: xStart,\r\n          pixX: pixXstart,\r\n          dateString: \"\",\r\n        };\r\n        const curData = graph.data.filter((val, idx) => idx >= xStart && idx <= xEnd) as DataSeries;\r\n        graph.curData = curData;\r\n        graph.yMaxExact =\r\n          isIndicatorGraph(graph) && !!graph?.indicator?.default?.fixedYScale\r\n            ? graph?.indicator?.default?.fixedYScale[1]\r\n            : Math.max(\r\n                ...curData.map((dataset) => {\r\n                  if (isIndicatorDataset(dataset)) {\r\n                    const max = Math.max(...(dataset.prices.filter((price) => price !== null) as number[]));\r\n                    if (!max && max !== 0) return 0;\r\n                    return max;\r\n                  }\r\n                  if (isCandleChartDataset(dataset)) return dataset.high;\r\n                  return dataset.close;\r\n                })\r\n              );\r\n        graph.yMinExact =\r\n          isIndicatorGraph(graph) && !!graph?.indicator?.default?.fixedYScale\r\n            ? graph?.indicator?.default?.fixedYScale[0]\r\n            : Math.min(\r\n                ...curData.map((dataset) => {\r\n                  if (isIndicatorDataset(dataset)) {\r\n                    const min = Math.min(...(dataset.prices.filter((price) => price !== null) as number[]));\r\n                    if (!min && min !== 0) return 0;\r\n                    return min;\r\n                  }\r\n                  if (isCandleChartDataset(dataset)) return dataset.low;\r\n                  return dataset.close;\r\n                })\r\n              );\r\n        if (yMinExactAllGraphs === null || graph.yMinExact < yMinExactAllGraphs) yMinExactAllGraphs = graph.yMinExact;\r\n        if (yMaxExactAllGraphs === null || graph.yMaxExact > yMaxExactAllGraphs) yMaxExactAllGraphs = graph.yMaxExact;\r\n        if (graph.decimals > maxDecimals) maxDecimals = graph.decimals;\r\n      });\r\n\r\n      // target scale interval should be 75px\r\n      const intervalsTarget = Math.max(Math.round((subchart.bottom - subchart.top) / 75), 3);\r\n      yMaxExactAllGraphs = yMaxExactAllGraphs || 0;\r\n      yMinExactAllGraphs = yMinExactAllGraphs || 0;\r\n      const decimals = maxDecimals;\r\n\r\n      const optIntervalY = GetYOptInterval(yMaxExactAllGraphs, yMinExactAllGraphs, decimals, intervalsTarget);\r\n      yaxis.optIntervalY = optIntervalY;\r\n\r\n      let yMaxAllGraphs: null | number = null;\r\n      let yMinAllGraphs: null | number = null;\r\n      yaxis.graphs.forEach((graph, graphIdx) => {\r\n        graph.yMax = Math.ceil(graph.yMaxExact / optIntervalY) * optIntervalY;\r\n        graph.yMin = Math.floor(graph.yMinExact / optIntervalY) * optIntervalY;\r\n        if (yMaxAllGraphs === null || graph.yMax > yMaxAllGraphs) yMaxAllGraphs = graph.yMax;\r\n        if (yMinAllGraphs === null || graph.yMin < yMinAllGraphs) yMinAllGraphs = graph.yMin;\r\n      });\r\n\r\n      const heightPerPt =\r\n        (subchart.bottom - subchart.top) / ((yMaxAllGraphs || 0) - (yMinAllGraphs || 0)) / Math.pow(10, decimals);\r\n      yaxis.heightPerPt = heightPerPt;\r\n      yaxis.translatedY = -pureYToPix(yMinAllGraphs || 0, subchart.bottom, decimals, 0, heightPerPt) + subchart.bottom;\r\n      let y_bottom = purePixToY(subchart.bottom, subchart.bottom, decimals, yaxis.translatedY, yaxis.heightPerPt);\r\n      let i = pureYToPix(\r\n        Math.ceil(y_bottom / optIntervalY) * optIntervalY,\r\n        subchart.bottom,\r\n        decimals,\r\n        yaxis.translatedY,\r\n        heightPerPt \r\n      );\r\n      const iStart = i; \r\n      while (i >= subchart.top) {\r\n        let yi = purePixToY(i, subchart.bottom, yaxis.decimals, yaxis.translatedY, yaxis.heightPerPt);\r\n        let yvalstr = (Math.round(yi * Math.pow(10, decimals)) / Math.pow(10, decimals)).toString();\r\n        if (i>subchart.top+10 && i <subchart.bottom-10)\r\n        mainYaxis.push({ pixY: i, label: yvalstr });\r\n        i -= (heightPerPt * optIntervalY) / Math.pow(10, -decimals);\r\n      }\r\n      yaxis.drawTicks = mainYaxis;\r\n    });\r\n  });\r\n  return calculatedSubcharts;\r\n};\r\n","import { Vector2 } from \"react-use-gesture/dist/types\";\r\nimport { getDateString } from \"../Time/CChartDateTime\";\r\nimport { getOptimalPeriod, isNewPeriod } from \"../Time/CChartPeriod\";\r\nimport {\r\n  CalculatedChartStateType,\r\n  ChartGraphStateType,\r\n  ChartStateType,\r\n  DrawingTool,\r\n  InteractivePointerType,\r\n  InteractiveXaxisType,\r\n  isChartGraph,\r\n  SubchartStateType,\r\n} from \"../Types/CChartStateTypes\";\r\nimport { ChartPeriodType } from \"../Types/CChartTimeTypes\";\r\nimport { purePixToX, pureXToPix } from \"./CChartStateXaxis\";\r\nimport { purePixToY, pureYToPix, snapPixYToPrices } from \"./CChartStateYaxis\";\r\n\r\nexport const getSubchartIdxByVector = (\r\n  pixXy: [number, number] | undefined,\r\n  subcharts: CalculatedChartStateType[\"subCharts\"]\r\n): number | null => {\r\n  if (!pixXy || !subcharts) return null;\r\n  for (let i = 0; i < subcharts.length; i++) {\r\n    const subchart = subcharts[i];\r\n    if (pixXy[1] >= subchart.top && pixXy[1] < subchart.bottom) return i;\r\n  }\r\n  return null;\r\n};\r\n\r\nexport const getSubchartIdxByBottom = (\r\n  pixXy: [number, number] | undefined,\r\n  subcharts: CalculatedChartStateType[\"subCharts\"]\r\n): number | null => {\r\n  if (!pixXy) return null;\r\n  for (let i = 0; i < subcharts.length; i++) {\r\n    const subchart = subcharts[i];\r\n    if (pixXy[1] >= subchart.bottom - 10 && pixXy[1] < subchart.bottom + 10) return i;\r\n  }\r\n  return null;\r\n};\r\n\r\nconst getToolsByXy = (\r\n  pixXy: [number, number] | undefined,\r\n  subcharts: ChartStateType[\"subCharts\"],\r\n  xaxis: InteractiveXaxisType\r\n): [number, number, number, number][] => {\r\n  if (!pixXy || !subcharts || !xaxis) return [];\r\n  const subchartIdx = getSubchartIdxByVector(pixXy, subcharts);\r\n  if (subchartIdx === null) return [];\r\n\r\n  let toolsIdx: [number, number, number, number][] = [];\r\n  const translatedX = xaxis.totalTranslatedX;\r\n  const widthPerTick = xaxis.scaledWidthPerTick;\r\n  subcharts[subchartIdx].yaxis.forEach((singleYaxis, singleYaxisIdx) => {\r\n    const translatedY = singleYaxis.translatedY;\r\n    const heightPerPt = singleYaxis.heightPerPt;\r\n    singleYaxis.tools.forEach((tool, toolIdx) => {\r\n      tool.xy.forEach((anchorXy, anchorIdx) => {\r\n        if (\r\n          pixXy[0] >= pureXToPix(anchorXy[0], translatedX, widthPerTick) - 10 &&\r\n          pixXy[0] <= pureXToPix(anchorXy[0], translatedX, widthPerTick) + 10 &&\r\n          pixXy[1] >=\r\n            pureYToPix(\r\n              anchorXy[1],\r\n              subcharts[subchartIdx].bottom,\r\n              subcharts[subchartIdx].yaxis[singleYaxisIdx].decimals,\r\n              translatedY,\r\n              heightPerPt\r\n            ) -\r\n              10 &&\r\n          pixXy[1] <=\r\n            pureYToPix(\r\n              anchorXy[1],\r\n              subcharts[subchartIdx].bottom,\r\n              subcharts[subchartIdx].yaxis[singleYaxisIdx].decimals,\r\n              translatedY,\r\n              heightPerPt\r\n            ) +\r\n              10\r\n        ) {\r\n          toolsIdx.push([subchartIdx, singleYaxisIdx, toolIdx, anchorIdx]);\r\n        }\r\n      });\r\n    });\r\n  });\r\n  return toolsIdx;\r\n};\r\n\r\nexport const getDragActionType = (\r\n  dragInitXy: [number, number] | undefined,\r\n  subcharts: SubchartStateType[],\r\n  xaxis: InteractiveXaxisType,\r\n  isEditing: boolean,\r\n  isDrawing: boolean,\r\n  canvasWidth: number,\r\n  canvasHeight: number\r\n):\r\n  | null\r\n  | { type: \"translate\" | \"scale\" }\r\n  | { type: \"resizeSubchart\"; res: number; initBottom: number }\r\n  | { type: \"drawTool\"; init: [number, number] }\r\n  | { type: \"editTool\"; res: [number, number, number, number][]; init: [number, number] } => {\r\n  if (!dragInitXy) return null;\r\n  if (isEditing) return null;\r\n\r\n  if (isDrawing) {\r\n    // const editToolPath = getToolsByXy(dragInitXy, subcharts, xaxis); //only initially -> tool xy is changed by editing but dragInitXy isnt adjusted!\r\n    return {\r\n      type: \"drawTool\",\r\n      // res: editToolPath,\r\n      init: dragInitXy,\r\n    };\r\n  }\r\n\r\n  const editToolPath = getToolsByXy(dragInitXy, subcharts, xaxis); //only initially -> tool xy is changed by editing but dragInitXy isnt adjusted!\r\n  if (editToolPath.length > 0)\r\n    return {\r\n      type: \"editTool\",\r\n      res: editToolPath,\r\n      init: subcharts[editToolPath[0][0]].yaxis[editToolPath[0][1]].tools[editToolPath[0][2]].xy[editToolPath[0][3]],\r\n    };\r\n  const resizeSubchartIdx = getSubchartIdxByBottom(dragInitXy, subcharts); // same as above - only initially\r\n  if (resizeSubchartIdx !== null && resizeSubchartIdx !== subcharts.length-1)\r\n    return { type: \"resizeSubchart\", res: resizeSubchartIdx, initBottom: subcharts[resizeSubchartIdx].bottom };\r\n\r\n  const clickedChart =\r\n    dragInitXy[0] >= 0 && dragInitXy[0] < 0 + canvasWidth && dragInitXy[1] >= 0 && dragInitXy[1] < 0 + canvasHeight;\r\n  if (clickedChart) return { type: \"translate\" };\r\n  const clickedXaxis = dragInitXy[0] >= 0 && dragInitXy[0] < 0 + canvasWidth && dragInitXy[1] >= 0 + canvasHeight;\r\n  if (clickedXaxis) return { type: \"scale\" };\r\n  return null;\r\n};\r\n\r\nexport const editToolPosition = (\r\n  dragActionType: { type: \"editTool\"; res: [number, number, number, number][]; init: [number, number] },\r\n  subcharts: ChartStateType[\"subCharts\"],\r\n  xaxis: InteractiveXaxisType,\r\n  pointer: ChartStateType[\"pointer\"]\r\n): ChartStateType[\"subCharts\"] => {\r\n  if (dragActionType.type !== \"editTool\" || dragActionType.res.length === 0 || !dragActionType.init) return subcharts;\r\n  // if (drag.isDragging) {\r\n  const curPixX = !!pointer.chartPointer.move.pixXSnap ? pointer.chartPointer.move.pixXSnap : pointer.drag.xy[0];\r\n  const curPixY =\r\n    pointer.chartPointer.move.snapDatasets.length > 0 && !!pointer.chartPointer.move.snapDatasets[0].pixYSnap\r\n      ? pointer.chartPointer.move.snapDatasets[0].pixYSnap\r\n      : pointer.drag.xy[1];\r\n  const initX = pureXToPix(\r\n    Math.round(purePixToX(pointer.drag.initial[0], xaxis.totalTranslatedX, xaxis.scaledWidthPerTick)),\r\n    xaxis.totalTranslatedX,\r\n    xaxis.scaledWidthPerTick\r\n  );\r\n  const subIdx = dragActionType.res[0][0];\r\n  const yaxisIdx = dragActionType.res[0][1];\r\n\r\n  let datasets: {\r\n    y: number;\r\n    pixY: number;\r\n  }[] = [];\r\n  let yAdjusted = { y: dragActionType.init[1], pixY: pointer.drag.initial[1] };\r\n  subcharts[subIdx].yaxis[yaxisIdx].graphs.forEach((graph, graphIdx) => {\r\n    const localInitY = snapPixYToPrices(pointer.drag.initial[1], graph.data[initX], subcharts, subIdx, yaxisIdx);\r\n    if (!!localInitY && localInitY.length > 0) datasets.push({ ...localInitY[0], y: parseFloat(localInitY[0].y) });\r\n  });\r\n  if (datasets.length > 0) {\r\n    yAdjusted = { y: datasets[0].y, pixY: datasets[0].pixY };\r\n  }\r\n\r\n  const newPixX =\r\n    pureXToPix(dragActionType.init[0], xaxis.totalTranslatedX, xaxis.scaledWidthPerTick) + curPixX - initX;\r\n  const newPixY =\r\n    pureYToPix(\r\n      dragActionType.init[1],\r\n      subcharts[subIdx].bottom,\r\n      subcharts[subIdx].yaxis[yaxisIdx].decimals,\r\n      subcharts[subIdx].yaxis[yaxisIdx].translatedY,\r\n      subcharts[subIdx].yaxis[yaxisIdx].heightPerPt\r\n    ) +\r\n    curPixY -\r\n    yAdjusted.pixY;\r\n  const newX = purePixToX(newPixX, xaxis.totalTranslatedX, xaxis.scaledWidthPerTick);\r\n  const newY = purePixToY(\r\n    newPixY,\r\n    subcharts[subIdx].bottom,\r\n    subcharts[subIdx].yaxis[yaxisIdx].decimals,\r\n    subcharts[subIdx].yaxis[yaxisIdx].translatedY,\r\n    subcharts[subIdx].yaxis[yaxisIdx].heightPerPt\r\n  );\r\n  console.log(curPixX, curPixY, newPixX, newPixY, newX, newY);\r\n  console.log(\r\n    \"2nd:\",\r\n    pureXToPix(\r\n      Math.round(purePixToX(pointer.drag.initial[0], xaxis.totalTranslatedX, xaxis.scaledWidthPerTick)),\r\n      xaxis.totalTranslatedX,\r\n      xaxis.scaledWidthPerTick\r\n    ),\r\n    purePixToX(pointer.drag.initial[0], 0, 0),\r\n    pointer.drag.initial[0]\r\n  );\r\n  const [toolsSubIdx, toolsYaxisIdx, toolIdx, anchorIdx] = dragActionType.res[0];\r\n  const editedSubcharts: ChartStateType[\"subCharts\"] = [\r\n    ...subcharts.slice(0, toolsSubIdx),\r\n    {\r\n      ...subcharts[toolsSubIdx],\r\n      yaxis: [\r\n        ...subcharts[toolsSubIdx].yaxis.slice(0, toolsYaxisIdx),\r\n        {\r\n          ...subcharts[toolsSubIdx].yaxis[toolsYaxisIdx],\r\n          tools: [\r\n            ...subcharts[toolsSubIdx].yaxis[toolsYaxisIdx].tools.slice(0, toolIdx),\r\n            {\r\n              ...subcharts[toolsSubIdx].yaxis[toolsYaxisIdx].tools[toolIdx],\r\n              xy: [\r\n                ...subcharts[toolsSubIdx].yaxis[toolsYaxisIdx].tools[toolIdx].xy.slice(0, anchorIdx),\r\n                [newX, newY],\r\n                ...subcharts[toolsSubIdx].yaxis[toolsYaxisIdx].tools[toolIdx].xy.slice(anchorIdx + 1),\r\n              ],\r\n            },\r\n            ...subcharts[toolsSubIdx].yaxis[toolsYaxisIdx].tools.slice(toolIdx + 1),\r\n          ],\r\n        },\r\n        ...subcharts[toolsSubIdx].yaxis.slice(toolsYaxisIdx + 1),\r\n      ],\r\n    },\r\n    ...subcharts.slice(toolsSubIdx + 1),\r\n  ];\r\n  return editedSubcharts;\r\n  // }\r\n  // return subcharts;\r\n};\r\n\r\nexport const resizeSubchart = (\r\n  dragActionType: { type: \"resizeSubchart\"; res: number; initBottom: number },\r\n  subcharts: ChartStateType[\"subCharts\"],\r\n  drag: ChartStateType[\"pointer\"][\"drag\"]\r\n): ChartStateType[\"subCharts\"] => {\r\n  if (dragActionType.type !== \"resizeSubchart\" || dragActionType === null) return subcharts;\r\n  // if (drag.isDragging) {\r\n  const subchartIdx = dragActionType.res;\r\n  const newBottom = Math.min(\r\n    Math.max(dragActionType.initBottom + drag.xy[1] - drag.initial[1], subcharts[subchartIdx].top + 10),\r\n    subcharts[subchartIdx + 1].bottom - 10\r\n  );\r\n  // console.log(newBottom);\r\n  return [\r\n    ...subcharts.slice(0, subchartIdx),\r\n    { ...subcharts[subchartIdx], bottom: newBottom },\r\n    { ...subcharts[subchartIdx + 1], top: newBottom },\r\n    ...subcharts.slice(subchartIdx + 2),\r\n  ];\r\n  // }\r\n  // return subcharts;\r\n};\r\n\r\nexport const addToolAnchor = (\r\n  // dragActionType: { type: \"drawTool\"},\r\n  drawToolType: \"hline\" | \"vline\" | \"trendline\" | undefined,\r\n  // subcharts: ChartStateType[\"subCharts\"],\r\n  draw: ChartStateType[\"draw\"],\r\n  pointer: ChartStateType[\"pointer\"]\r\n): ChartStateType[\"draw\"] => {\r\n  const defaultDrawState: ChartStateType[\"draw\"] = { isDrawing: false, pixXy: [] };\r\n\r\n  const curPixX = !!pointer.chartPointer.move.pixXSnap ? pointer.chartPointer.move.pixXSnap : pointer.drag.xy[0];\r\n  const curPixY =\r\n    pointer.chartPointer.move.snapDatasets.length > 0 && !!pointer.chartPointer.move.snapDatasets[0].pixYSnap\r\n      ? pointer.chartPointer.move.snapDatasets[0].pixYSnap\r\n      : pointer.drag.xy[1];\r\n  const dragpixXy: [number, number] = [curPixX, curPixY];\r\n  if (!drawToolType || !draw || !dragpixXy) return defaultDrawState;\r\n  // add temporary anchor point\r\n  return { ...draw, pixXy: [...draw.pixXy, dragpixXy] };\r\n};\r\n\r\nexport const addTool = (\r\n  subcharts: ChartStateType[\"subCharts\"],\r\n  xaxis: InteractiveXaxisType,\r\n  draw: ChartStateType[\"draw\"],\r\n  drag: ChartStateType[\"pointer\"][\"drag\"]\r\n): ChartStateType[\"subCharts\"] => {\r\n  const subchartIdx = getSubchartIdxByVector(drag.initial, subcharts);\r\n  console.log(subchartIdx, xaxis, draw, draw.type);\r\n  if (subchartIdx === null || !xaxis || !draw || !drag || !draw.type) return subcharts;\r\n  const pixXyArr = draw.pixXy;\r\n  const xyArr = pixXyArr.map((pixXy, pixXyIdx) => [\r\n    purePixToX(pixXy[0], xaxis.totalTranslatedX, xaxis.scaledWidthPerTick),\r\n    purePixToY(\r\n      pixXy[1],\r\n      subcharts[subchartIdx].bottom,\r\n      subcharts[subchartIdx].yaxis[0].decimals,\r\n      subcharts[subchartIdx].yaxis[0].translatedY,\r\n      subcharts[subchartIdx].yaxis[0].heightPerPt\r\n    ),\r\n  ]);\r\n\r\n  return [\r\n    ...subcharts.slice(0, subchartIdx),\r\n    {\r\n      ...subcharts[subchartIdx],\r\n      yaxis: [\r\n        {\r\n          ...subcharts[subchartIdx].yaxis[0],\r\n          tools: [\r\n            ...subcharts[subchartIdx].yaxis[0].tools,\r\n            { xy: xyArr, type: draw.type, style: { strokeColor: \"blue\", anchorColor: \"#333\" } } as DrawingTool,\r\n          ],\r\n        },\r\n        ...subcharts[subchartIdx].yaxis.slice(1),\r\n      ],\r\n    },\r\n    ...subcharts.slice(subchartIdx + 1),\r\n  ];\r\n};\r\n\r\nexport const calculateXPointer = (\r\n  widthPerTick: number,\r\n  translatedPixX: number,\r\n  xaxis: InteractiveXaxisType,\r\n  mainGraph: ChartGraphStateType,\r\n  onMove?: ChartStateType[\"pointer\"][\"move\"]\r\n) => {\r\n  const defaultXpointer = null;\r\n\r\n  if (!mainGraph || !onMove) return defaultXpointer;\r\n  const xIdx = Math.round(purePixToX(onMove?.xy[0] as any, translatedPixX, widthPerTick));\r\n  if (xIdx < 0 || xIdx > mainGraph.data.length - 1) return { xPointerUnlimited: xIdx };\r\n  const xPointer = Math.abs(Math.round(xIdx));\r\n  let xPointerDateStr = \"\";\r\n  const optPeriodRes = getOptimalPeriod(\r\n    mainGraph.data,\r\n    xaxis.xStart,\r\n    xaxis.xEnd,\r\n    mainGraph.meta,\r\n    xaxis.noDataPeriodPortion,\r\n    Object.assign({}, mainGraph.dateStat)\r\n  );\r\n  // console.log(mainGraph, onMove, optPeriodRes, mainGraph.meta.chartPeriod);\r\n  if (!optPeriodRes || !mainGraph.meta.chartPeriod) return defaultXpointer;\r\n\r\n  const periodToDraw = isNewPeriod(mainGraph.data[xPointer].date, mainGraph.dateStat, mainGraph.meta.chartPeriod, {\r\n    ...(optPeriodRes as ChartPeriodType),\r\n  });\r\n  xPointerDateStr = getDateString(\r\n    mainGraph.data[xPointer].date,\r\n    !!periodToDraw ? periodToDraw : mainGraph.meta.chartPeriod.chartPeriodName\r\n  );\r\n  const pixXPointer = pureXToPix(xPointer, translatedPixX, widthPerTick);\r\n  return { xPointer, xPointerDateStr, pixXPointer, xPointerUnlimited: xIdx };\r\n};\r\n\r\nexport const calculateCurrentPointerDataset = (\r\n  subcharts: CalculatedChartStateType[\"subCharts\"] | null,\r\n  xpointer: number | null,\r\n  xpointerUnlimited: number,\r\n  xPointerDateString: string,\r\n  pixXPointer: number,\r\n  onMove: CalculatedChartStateType[\"pointer\"][\"move\"],\r\n  onDragEnd: CalculatedChartStateType[\"pointer\"][\"dragPointerUp\"]\r\n): InteractivePointerType[\"chartPointer\"] | undefined => {\r\n  const xy = onMove?.xy;\r\n  if (!onMove || !subcharts || !xy) return;\r\n\r\n  const getSubchartIdx = (xy: Vector2) => {\r\n    let subchartIdx: number = -1;\r\n    for (let i = 0; i < subcharts.length; i++) {\r\n      const subchart = subcharts[i];\r\n      if (xy[1] >= subchart.top && xy[1] < subchart.bottom) subchartIdx = i;\r\n    }\r\n    return subchartIdx;\r\n  };\r\n  const subchartIdx = getSubchartIdx(xy);\r\n  if (subchartIdx === -1) return;\r\n  const clickedSubchartIdx = !!onDragEnd && !!onDragEnd.xy ? getSubchartIdx(onDragEnd.xy) : null;\r\n\r\n  const snapDatasets: InteractivePointerType[\"chartPointer\"][\"move\"][\"snapDatasets\"] = [];\r\n\r\n  if (xpointer !== null)\r\n    subcharts[subchartIdx].yaxis.forEach((singleYaxis, singleYaxisIdx) => {\r\n      singleYaxis.graphs.forEach((graph, graphIdx) => {\r\n        let ySnap: string | null = null;\r\n        let pixYSnap: number | null = null;\r\n\r\n        const snapPriceRes = snapPixYToPrices(\r\n          onMove?.xy[1],\r\n          graph.data[xpointer],\r\n          subcharts,\r\n          subchartIdx,\r\n          singleYaxisIdx\r\n        );\r\n        if (!!snapPriceRes && snapPriceRes.length > 0) {\r\n          pixYSnap = snapPriceRes[0].pixY;\r\n          ySnap = snapPriceRes[0].y;\r\n        }\r\n\r\n        snapDatasets.push({\r\n          yaxisIdx: singleYaxisIdx,\r\n          graphIdx: graphIdx,\r\n          data: graph.data[xpointer],\r\n          y: purePixToY(\r\n            onMove?.xy[1],\r\n            subcharts[subchartIdx].bottom,\r\n            singleYaxis.decimals,\r\n            singleYaxis.translatedY,\r\n            singleYaxis.heightPerPt\r\n          ),\r\n          ySnap: ySnap,\r\n          pixYSnap: pixYSnap,\r\n          dateString: xPointerDateString,\r\n        });\r\n      });\r\n    });\r\n\r\n  const calcPointerDataset = {\r\n    move: {\r\n      pixX: onMove?.xy[0],\r\n      pixXSnap: pixXPointer,\r\n      pixY: onMove?.xy[1],\r\n      x: xpointer,\r\n      xUnlimited: xpointerUnlimited,\r\n      subchartIdx, //onMove\r\n      snapDatasets: snapDatasets,\r\n      xDateString: xPointerDateString,\r\n    },\r\n    click: {\r\n      clickedSubchartIdx: clickedSubchartIdx, //onDragEnd\r\n    },\r\n  };\r\n  return calcPointerDataset;\r\n};\r\n","import React, { DOMElement } from \"react\";\r\nimport { useGesture } from \"react-use-gesture\";\r\nimport { chartStateReducer, ReducerActionTaskType, ReducerActionType } from \"./CChartStateReducer\";\r\n\r\nimport { getChartMethods } from \"./CChartStateMethods\";\r\nimport { calculateCurrentXaxis, getInteractiveXaxisState } from \"./CChartStateXaxis\";\r\nimport { calculateCurrentGraphs, purePixToY, pureYToPix } from \"./CChartStateYaxis\";\r\nimport { calculateXPointer, calculateCurrentPointerDataset } from \"./CChartStateInteractions\";\r\nimport { purePixToX, pureXToPix } from \"./CChartStateXaxis\";\r\nimport {\r\n  CalculatedChartStateType,\r\n  ChartPreStateRefType,\r\n  ChartStateType,\r\n  InteractiveXaxisType,\r\n  isChartGraph,\r\n  InteractivePointerType,\r\n  userInteractsSubchartStateType,\r\n  UseGestureStateType,\r\n  isIndicatorGraph,\r\n} from \"../Types/CChartStateTypes\";\r\nimport { addTool, addToolAnchor, editToolPosition, getDragActionType, resizeSubchart } from \"./CChartStateInteractions\";\r\nimport { includesOne } from \"../utils\";\r\nvar dequal = require(\"fast-deep-equal\");\r\n\r\nexport const defaultState: ChartStateType = {\r\n  xaxis: {\r\n    heightXAxis: 50,\r\n    heightTickMarkLines: 20,\r\n    totalScaleX: 0,\r\n    totalTranslatedX: 0,\r\n    scaledWidthPerTick: 10,\r\n    xStart: 0,\r\n    xEnd: 0,\r\n    pixXStart: 0,\r\n    pixXEnd: 0,\r\n    startNoDataPeriod: 0,\r\n    endNoDataPeriod: 0,\r\n    noDataPeriodPortion: 0,\r\n    optPeriodRes: null,\r\n    widthPerTick: 20,\r\n    xAxisTicks: [],\r\n    style: {\r\n      fillColor: \"#fff\",\r\n      strokeColor: \"#000\",\r\n      fontColor: \"#000\",\r\n      fontSize: 16,\r\n      fontName: \"Arial\",\r\n    },\r\n  },\r\n  grid: { useGridX: true, useGridY: true, style: { strokeColor: \"rgba(51,51,51, 0.33)\", strokeStyle: \"\" } },\r\n  yaxis: {\r\n    widthYAxis: 80,\r\n    widthTickmarkLines: 20,\r\n    style: {\r\n      fillColor: \"#fff\",\r\n      strokeColor: \"#000\",\r\n      fontColor: \"#000\",\r\n      fontSize: 16,\r\n      fontName: \"Arial\",\r\n    },\r\n  },\r\n  backgroundColor: \"#fff\",\r\n  fullscreen: false,\r\n  subCharts: [],\r\n  draw: {\r\n    isDrawing: false,\r\n    pixXy: [],\r\n  },\r\n  containerSize: { top: 0, left: 0, width: 300, height: 300, init: false },\r\n  pointer: {\r\n    isHovering: false,\r\n    move: { isMoving: false, xy: [0, 0] },\r\n    wheel: { isWheeling: false, delta: [0, 0] },\r\n    dragPointerUp: {\r\n      isDragPointerUp: false,\r\n      xy: [0, 0],\r\n      first: false,\r\n      last: false,\r\n      initial: [0, 0],\r\n      movementInitial: [0, 0],\r\n    },\r\n    drag: {\r\n      isDragging: false,\r\n      xy: [0, 0],\r\n      first: false,\r\n      last: false,\r\n      initial: [0, 0],\r\n      movementInitial: [0, 0],\r\n      delta: [0, 0],\r\n    },\r\n    chartPointer: {\r\n      move: {\r\n        x: 0,\r\n        pixX: 0,\r\n        pixY: 0,\r\n        snapDatasets: [],\r\n        subchartIdx: 0,\r\n        xDateString: \"\",\r\n        pixXSnap: 0,\r\n        xUnlimited: 0,\r\n      },\r\n      click: { clickedSubchartIdx: null },\r\n    },\r\n  },\r\n};\r\n\r\nexport const useChartState = (\r\n  HtmlElementRef: React.RefObject<HTMLElement>,\r\n  settings: {\r\n    maxUpdatesPerSec?: number;\r\n    initWidthPerTick?: number;\r\n    width?: number;\r\n    height?: number;\r\n    viewMode?: \"static\" | \"responsive\" | \"fullscreen\";\r\n  }\r\n): [CalculatedChartStateType, React.Dispatch<ReducerActionType<ReducerActionTaskType>>] => {\r\n  const maxUpdatesPerSec = !!settings.maxUpdatesPerSec ? settings.maxUpdatesPerSec : 15;\r\n  const initWidthPerTick = !!settings.initWidthPerTick ? settings.initWidthPerTick : 10;\r\n  const viewModeInternal =\r\n    settings.viewMode === \"static\" && (!settings.height || !settings.width)\r\n      ? \"responsive\"\r\n      : !!settings.viewMode\r\n      ? settings.viewMode\r\n      : \"responsive\";\r\n  // const isResponsive = settings.width === undefined && settings.height === undefined ? true : false;\r\n  const [ChartState, Dispatch] = React.useReducer<\r\n    (prevState: ChartStateType, action: ReducerActionType<ReducerActionTaskType>) => ChartStateType\r\n  >(chartStateReducer, defaultState);\r\n\r\n  const PreStateRef = React.useRef<ChartPreStateRefType>({\r\n    containerSize: defaultState.containerSize,\r\n    pointer: defaultState.pointer,\r\n    xaxis: {\r\n      totalScaleX: 0,\r\n      totalTranslatedX: 0,\r\n      scaledWidthPerTick: 10,\r\n      xStart: 0,\r\n      xEnd: 0,\r\n      pixXStart: 0,\r\n      pixXEnd: 0,\r\n      startNoDataPeriod: 0,\r\n      endNoDataPeriod: 0,\r\n      noDataPeriodPortion: 0,\r\n      optPeriodRes: null,\r\n      widthPerTick: 20,\r\n      xAxisTicks: [],\r\n    },\r\n    tmp: { scaleInitWidthPerTick: null, scaleInitTranslatedX: 0, dragActionType: null },\r\n    lastUpdate: new Date(),\r\n    shallUpdate: [],\r\n    userInteractedChartState: null,\r\n  });\r\n\r\n  const containerHeight = ChartState.containerSize.height - 1;\r\n\r\n  /** Pointer Event Handler defined using react-use-gesture -> pointer state is stored in PreStateRef */\r\n  useGesture(\r\n    {\r\n      onDrag: (dragState: UseGestureStateType[\"drag\"]) => {\r\n        const deltaX =\r\n          !!PreStateRef.current.pointer.drag?.delta && !!PreStateRef.current.shallUpdate.includes(\"drag\")\r\n            ? PreStateRef.current.pointer.drag?.delta[0] + dragState.delta[0]\r\n            : dragState.delta[0];\r\n        const deltaY =\r\n          !!PreStateRef.current.pointer.drag?.delta && !!PreStateRef.current.shallUpdate.includes(\"drag\")\r\n            ? PreStateRef.current.pointer.drag?.delta[1] + dragState.delta[1]\r\n            : dragState.delta[1];\r\n\r\n        const { xy, initial, movement: movementInitial, first, last, active: isDragging } = dragState;\r\n        PreStateRef.current = {\r\n          ...PreStateRef.current,\r\n          pointer: {\r\n            ...PreStateRef.current.pointer,\r\n            drag: { isDragging, xy, initial, movementInitial, last, first, delta: [deltaX, deltaY] },\r\n          },\r\n          shallUpdate: [...PreStateRef.current.shallUpdate, \"drag\"],\r\n          lastUpdate: PreStateRef.current.lastUpdate,\r\n        };\r\n      },\r\n      onMove: (moveState: UseGestureStateType[\"move\"]) => {\r\n        PreStateRef.current = {\r\n          ...PreStateRef.current,\r\n          pointer: {\r\n            ...PreStateRef.current.pointer,\r\n            move: { isMoving: moveState.active, xy: moveState.xy },\r\n          },\r\n          shallUpdate: [...PreStateRef.current.shallUpdate, \"pointerMove\"],\r\n        };\r\n      },\r\n      onHover: (hoverState: UseGestureStateType[\"hover\"]) => {\r\n        PreStateRef.current = {\r\n          ...PreStateRef.current,\r\n          pointer: {\r\n            ...PreStateRef.current.pointer,\r\n            isHovering: hoverState.active,\r\n          },\r\n          shallUpdate: [...PreStateRef.current.shallUpdate, \"pointerMove\"],\r\n        };\r\n      },\r\n      onWheel: (wheelState: UseGestureStateType[\"wheel\"]) => {\r\n        const deltaX =\r\n          !!PreStateRef.current.pointer.wheel?.delta && !!PreStateRef.current.shallUpdate.includes(\"wheel\")\r\n            ? PreStateRef.current.pointer.wheel?.delta[0] + wheelState.delta[0]\r\n            : wheelState.delta[0];\r\n        const deltaY =\r\n          !!PreStateRef.current.pointer.wheel?.delta && !!PreStateRef.current.shallUpdate.includes(\"wheel\")\r\n            ? PreStateRef.current.pointer.wheel?.delta[1] + wheelState.delta[1]\r\n            : wheelState.delta[1];\r\n        PreStateRef.current = {\r\n          ...PreStateRef.current,\r\n          pointer: {\r\n            ...PreStateRef.current.pointer,\r\n            wheel: { delta: [deltaX, deltaY], isWheeling: wheelState.active },\r\n          },\r\n          shallUpdate: [...PreStateRef.current.shallUpdate, \"wheel\"],\r\n        };\r\n      },\r\n      onDragEnd: (dragState: UseGestureStateType[\"dragEnd\"]) => {\r\n        const { xy, initial, first, last, movement: movementInitial } = dragState;\r\n        PreStateRef.current = {\r\n          ...PreStateRef.current,\r\n          pointer: {\r\n            ...PreStateRef.current.pointer,\r\n            dragPointerUp: { isDragPointerUp: true, xy, initial, movementInitial, last, first },\r\n          },\r\n          shallUpdate: [...PreStateRef.current.shallUpdate, \"dragEnd\"],\r\n        };\r\n      },\r\n    },\r\n    {\r\n      domTarget: HtmlElementRef,\r\n      transform: ([x, y]) => [x - ChartState.containerSize.top, y - ChartState.containerSize.left],\r\n      // eventOptions: { capture: true,  },\r\n      drag: { useTouch: true, experimental_preventWindowScrollY: true },\r\n      move: {},\r\n    }\r\n  );\r\n\r\n  /** window resize event handler  */\r\n  React.useEffect(() => {\r\n    console.log(\"HI!\");\r\n    if (!HtmlElementRef || !HtmlElementRef.current) return;\r\n    console.log(\"noch da!\");\r\n    if (ChartState.fullscreen || viewModeInternal === \"fullscreen\") {\r\n      console.log(\"immrt noch!\");\r\n      HtmlElementRef.current.style.position = \"fixed\";\r\n      HtmlElementRef.current.style.width = \"100%\";\r\n      HtmlElementRef.current.style.height = \"100%\";\r\n      HtmlElementRef.current.style.top = \"0px\";\r\n      const { clientWidth: width, clientHeight: height } = HtmlElementRef.current;\r\n      PreStateRef.current = {\r\n        ...PreStateRef.current,\r\n        shallUpdate: [...PreStateRef.current.shallUpdate, \"containerResize\"],\r\n        containerSize: { top: 0, left: 0, width, height, init: true },\r\n      };\r\n      // return;\r\n    } else {\r\n      const { top, left } = HtmlElementRef.current.getBoundingClientRect();\r\n      const { clientWidth: width, clientHeight: height } = HtmlElementRef.current;\r\n      HtmlElementRef.current.style.position = \"relative\";\r\n      HtmlElementRef.current.style.width =\r\n        !!settings.width && viewModeInternal === \"static\" ? settings.width + \"px\" : \"100%\";\r\n      HtmlElementRef.current.style.height =\r\n        !!settings.height && viewModeInternal === \"static\" ? settings.height + \"px\" : \"100%\";\r\n      HtmlElementRef.current.style.top = \"0px\";\r\n      PreStateRef.current = {\r\n        ...PreStateRef.current,\r\n        shallUpdate: [...PreStateRef.current.shallUpdate, \"containerResize\"],\r\n        containerSize: { top, left, width, height, init: true },\r\n      };\r\n    }\r\n    // listen only when container shall be responsive -> neither width or height are set by CChart\r\n    if (!!settings.height && !!settings.width && viewModeInternal === \"static\") return;\r\n    const handleWindowResize = (e: Event) => {\r\n      if (!HtmlElementRef || !HtmlElementRef.current) return;\r\n      if (ChartState.fullscreen || viewModeInternal === \"fullscreen\") {\r\n        const { clientWidth: width, clientHeight: height } = HtmlElementRef.current;\r\n        PreStateRef.current = {\r\n          ...PreStateRef.current,\r\n          shallUpdate: [...PreStateRef.current.shallUpdate, \"containerResize\"],\r\n          containerSize: { top: 0, left: 0, width, height, init: true },\r\n        };\r\n        // return;\r\n      } else {\r\n        const { top, left } = HtmlElementRef.current.getBoundingClientRect();\r\n        const { clientWidth: width, clientHeight: height } = HtmlElementRef.current;\r\n        // HtmlElementRef.current.style.position = \"relative\";\r\n        // HtmlElementRef.current.style.width = width + \"px\";\r\n        // HtmlElementRef.current.style.height = height + \"px\";\r\n        // HtmlElementRef.current.style.top = \"0px\";\r\n        PreStateRef.current = {\r\n          ...PreStateRef.current,\r\n          shallUpdate: [...PreStateRef.current.shallUpdate, \"containerResize\"],\r\n          containerSize: { top, left, width, height, init: true },\r\n        };\r\n      }\r\n    };\r\n    console.log(\"updated! onResize E handler\");\r\n    if (!!HtmlElementRef.current.parentElement)\r\n      HtmlElementRef.current.parentElement.addEventListener(\"resize\", () => {\r\n        \"HI!!!!!\";\r\n      });\r\n    window.addEventListener(\"resize\", handleWindowResize);\r\n    window.addEventListener(\"orientationchange\", handleWindowResize);\r\n\r\n    return () => {\r\n      window.removeEventListener(\"resize\", handleWindowResize);\r\n      window.removeEventListener(\"orientationchange\", handleWindowResize);\r\n    };\r\n  }, [\r\n    HtmlElementRef,\r\n    settings.width,\r\n    settings.height,\r\n    ChartState.fullscreen,\r\n    viewModeInternal,\r\n    HtmlElementRef?.current?.clientWidth,\r\n    HtmlElementRef?.current?.clientHeight,\r\n  ]);\r\n\r\n  const userInteractedSubcharts: userInteractsSubchartStateType = ChartState.subCharts.map((subchart) => ({\r\n    // top: subchart.top,\r\n    // bottom: subchart.bottom,\r\n    yaxis: subchart.yaxis.map((singleYaxis) => ({\r\n      decimals: singleYaxis.decimals,\r\n      graphs: singleYaxis.graphs.map((graph) => {\r\n        const addIndicatorDeps = isIndicatorGraph(graph) ? { ...graph.indicator } : {};\r\n\r\n        return {\r\n          // data: graph.data,\r\n          decimals: graph.decimals,\r\n          name: graph.name,\r\n          style: graph.style,\r\n          type: graph.type,\r\n          ...addIndicatorDeps,\r\n        };\r\n      }),\r\n      tools: singleYaxis.tools.map((tool) => ({ type: tool.type, params: tool.params, style: tool.style })),\r\n    })),\r\n  }));\r\n  const userInteractedXaxis = {\r\n    heightXAxis: ChartState.xaxis.heightXAxis,\r\n    heightTickMarkLines: ChartState.xaxis.heightTickMarkLines,\r\n    style: ChartState.xaxis.style,\r\n  };\r\n  const userInteractedChartState = {\r\n    xaxis: userInteractedXaxis,\r\n    subcharts: userInteractedSubcharts,\r\n  };\r\n\r\n  if (!dequal(PreStateRef.current.userInteractedChartState, userInteractedChartState)) {\r\n    PreStateRef.current.userInteractedChartState = userInteractedChartState;\r\n  }\r\n\r\n  React.useEffect(() => {\r\n    const onTimer = () => {\r\n      const PreState = PreStateRef.current;\r\n      const DragEndState = PreState.pointer.dragPointerUp;\r\n      const DragState = PreState.pointer.drag;\r\n      if (PreState.shallUpdate.length > 0) {\r\n        const widthYaxis = ChartState.yaxis.widthYAxis;\r\n        const widthChart = PreState.containerSize.width - 1;\r\n        const heightChart = PreState.containerSize.height - 1;\r\n        const heightXaxis = ChartState.xaxis.heightXAxis;\r\n        let calcSubcharts = ChartState.subCharts;\r\n        let calcXaxis: InteractiveXaxisType = PreState.xaxis;\r\n        let currentPointer: InteractivePointerType[\"chartPointer\"] | undefined;\r\n        let calcDraw = ChartState.draw;\r\n        let dragActionType;\r\n        if (!PreState.shallUpdate.includes(\"dragEnd\")) PreState.pointer.dragPointerUp.isDragPointerUp = false;\r\n        if (includesOne(PreState.shallUpdate, \"containerResize\") && ChartState.subCharts.length > 0) {\r\n          const dHeight =\r\n            PreState.containerSize.height -\r\n            1 -\r\n            ChartState.xaxis.heightXAxis -\r\n            ChartState.subCharts[ChartState.subCharts.length - 1].bottom;\r\n          const minMainHeight = 250;\r\n          const dHproportionalTmp = Math.floor(dHeight / ChartState.subCharts.length);\r\n          const newMainSizeTmp = ChartState.subCharts[0].bottom - ChartState.subCharts[0].top + dHproportionalTmp;\r\n          const restMainLimit = newMainSizeTmp < minMainHeight ? minMainHeight - newMainSizeTmp : 0;\r\n          const dHeightMain = dHproportionalTmp + restMainLimit;\r\n          const dHeightSingleSubchart =\r\n            ChartState.subCharts.length > 1\r\n              ? Math.floor((dHeight - dHeightMain) / (ChartState.subCharts.length - 1))\r\n              : 0;\r\n          const rest =\r\n            ChartState.subCharts.length > 1 ? (dHeight - dHeightMain) % (ChartState.subCharts.length - 1) : 0;\r\n          let currentRest = rest;\r\n          let lastBottom: number = 0;\r\n          let correctRest = 0;\r\n          calcSubcharts = calcSubcharts.map((subchart, subchartIdx) => {\r\n            if (subchartIdx === 0) {\r\n              lastBottom = subchart.bottom + 1 * dHeightMain;\r\n              return { ...subchart, bottom: subchart.bottom + 1 * dHeightMain };\r\n            } else {\r\n              const tempRest =\r\n                Math.sign(currentRest) > 0 && currentRest > 0 && currentRest !== 0\r\n                  ? -1\r\n                  : Math.sign(currentRest) < 0 && currentRest < 0 && currentRest !== 0\r\n                  ? +1\r\n                  : 0;\r\n              currentRest += tempRest;\r\n              correctRest += tempRest;\r\n              const newTop = lastBottom;\r\n              // why math.abs -> rest of Math.floor(x/n)\r\n              lastBottom = subchart.bottom + subchartIdx * dHeightSingleSubchart + dHeightMain + Math.abs(correctRest);\r\n\r\n              return {\r\n                ...subchart,\r\n                top: newTop,\r\n                bottom: subchart.bottom + subchartIdx * dHeightSingleSubchart + dHeightMain + Math.abs(correctRest),\r\n              };\r\n            }\r\n          });\r\n\r\n          console.log(dHeight, dHeightMain, dHeightSingleSubchart, rest, PreState.containerSize.height);\r\n          PreStateRef.current.userInteractedChartState = null;\r\n        }\r\n        if (\r\n          includesOne(PreState.shallUpdate, \"drag\", \"wheel\", \"containerResize\", \"deps\") ||\r\n          !!PreState.tmp.dragActionType\r\n        ) {\r\n          // drag actions\r\n\r\n          const dragInit = DragState?.initial;\r\n          // if (!PreState.shallUpdate.includes(\"drag\")) {\r\n          dragActionType = getDragActionType(\r\n            dragInit,\r\n            calcSubcharts,\r\n            calcXaxis,\r\n            !!PreState.tmp.dragActionType,\r\n            ChartState.draw.isDrawing,\r\n            widthChart - widthYaxis,\r\n            heightChart - heightXaxis\r\n          );\r\n          if (\r\n            !PreState.tmp.dragActionType &&\r\n            !!dragActionType &&\r\n            [\"resizeSubchart\"].includes(dragActionType.type) // \"editTool\", \"drawTool\"\r\n          ) {\r\n            PreState.tmp.dragActionType = dragActionType;\r\n          }\r\n          if (!!PreState.tmp.dragActionType) {\r\n            if (!!PreState.pointer.drag.isDragging) {\r\n              if (PreState.tmp.dragActionType?.type === \"resizeSubchart\") {\r\n                calcSubcharts = resizeSubchart(PreState.tmp.dragActionType, calcSubcharts, PreState.pointer.drag);\r\n              }\r\n            }\r\n\r\n            if (!PreState.pointer.drag.isDragging) {\r\n              if (![\"drawTool\", \"editTool\"].includes(PreState.tmp.dragActionType?.type)) {\r\n                if (PreState.tmp.dragActionType?.type === \"resizeSubchart\") {\r\n                  // resize with ChartState.subcharts[i].bottom (when resizing began!) for the last time\r\n\r\n                  calcSubcharts = resizeSubchart(PreState.tmp.dragActionType, calcSubcharts, PreState.pointer.drag);\r\n                  // and trigger update of ChartState.subCharts for the effect hook\r\n                  PreState.userInteractedChartState = null;\r\n                  PreState.tmp.dragActionType = null;\r\n                }\r\n              }\r\n            }\r\n            // }\r\n          }\r\n\r\n          if (\r\n            (!!dragActionType && [\"scale\", \"translate\"].includes(dragActionType.type)) ||\r\n            includesOne(PreState.shallUpdate, \"containerResize\", \"deps\")\r\n          ) {\r\n            const { scaleInitTranslatedX, scaleInitWidthPerTick } = PreState.tmp;\r\n            let mainGraph = !!calcSubcharts?.[0]?.yaxis?.[0]?.graphs?.[0]\r\n              ? calcSubcharts?.[0].yaxis[0].graphs[0]\r\n              : null;\r\n            if (!!mainGraph) if (!isChartGraph(mainGraph)) mainGraph = null;\r\n\r\n            PreState.xaxis = getInteractiveXaxisState(\r\n              { ...PreState.xaxis, scaleInitTranslatedX, scaleInitWidthPerTick }, // + temp vars in ref! therefore ref not state\r\n              PreState.pointer.drag,\r\n              PreState.pointer.wheel,\r\n              PreState.pointer.move,\r\n              initWidthPerTick,\r\n              PreState.shallUpdate.includes(\"drag\"),\r\n              dragActionType?.type === \"translate\",\r\n              dragActionType?.type === \"scale\",\r\n              widthChart, //- widthYaxis\r\n              mainGraph?.data.length ||0\r\n            );\r\n            // const { scaleInitTranslatedX, scaleInitWidthPerTick, ...xaxisInteractiveState } = PreState.xaxis;\r\n\r\n            \r\n            calcXaxis = {\r\n              ...calcXaxis,\r\n              ...PreState.xaxis,\r\n              ...calculateCurrentXaxis(\r\n                PreState.xaxis.scaledWidthPerTick,\r\n                PreState.xaxis.totalTranslatedX,\r\n                PreState.containerSize.width,\r\n                ChartState.yaxis.widthYAxis,\r\n                mainGraph\r\n              ),\r\n            };\r\n          }\r\n          if (\r\n            (!!dragActionType && [\"scale\", \"translate\", \"resizeSubchart\"].includes(dragActionType.type)) ||\r\n            !!PreState.tmp.dragActionType ||\r\n            includesOne(PreState.shallUpdate, \"containerResize\", \"deps\")\r\n          ) {\r\n            // graphs (and yaxis) - depends on drag actions (translate, scale, resizeSubchart)\r\n            const calcCurrentSubchart = calculateCurrentGraphs(\r\n              calcSubcharts,\r\n              PreState.xaxis.scaledWidthPerTick,\r\n              calcXaxis.xStart,\r\n              calcXaxis.xEnd,\r\n              calcXaxis.pixXStart,\r\n              calcXaxis.pixXEnd\r\n            );\r\n            if (!!calcCurrentSubchart) calcSubcharts = calcCurrentSubchart;\r\n          }\r\n        }\r\n        if (PreState.shallUpdate.includes(\"pointerMove\")) {\r\n          const xpointerRes = calculateXPointer(\r\n            calcXaxis.scaledWidthPerTick,\r\n            calcXaxis.totalTranslatedX,\r\n            calcXaxis,\r\n            calcSubcharts?.[0]?.yaxis?.[0]?.graphs?.[0] as any,\r\n            PreState.pointer.move\r\n          );\r\n\r\n          // if (!!xpointerRes) {\r\n            console.log(xpointerRes);\r\n            const xpointer = xpointerRes?.xPointer !== undefined? xpointerRes?.xPointer:  null;\r\n            const xPointerUnl = xpointerRes?.xPointerUnlimited !== undefined ? xpointerRes.xPointerUnlimited : -1;\r\n            const xPointerDateString = xpointerRes?.xPointerDateStr || \"\";\r\n            const pixXPointer = xpointerRes?.pixXPointer ||0;\r\n            currentPointer = calculateCurrentPointerDataset(\r\n              calcSubcharts,\r\n              xpointer,\r\n              xPointerUnl,\r\n              xPointerDateString,\r\n              pixXPointer,\r\n              PreState.pointer.move,\r\n              PreState.pointer.dragPointerUp\r\n            );\r\n          // }\r\n          // ensure xUnlimited is added to chartstate\r\n\r\n          // currentPointer = {move: {xUnlimited: Math.round(\r\n          //   purePixToX(\r\n          //     PreState.pointer.move?.xy[0] as any,\r\n          //     PreState.xaxis.totalTranslatedX,\r\n          //     PreState.xaxis.widthPerTick\r\n          //   )\r\n          // );}}\r\n        }\r\n        if (\r\n          PreState.shallUpdate.includes(\"drag\") ||\r\n          (!!PreState.tmp?.dragActionType && [\"editTool\", \"drawTool\"].includes(PreState.tmp.dragActionType.type))\r\n        ) {\r\n          if (\r\n            !PreState.tmp.dragActionType &&\r\n            !!dragActionType &&\r\n            [\"editTool\", \"drawTool\"].includes(dragActionType.type)\r\n          ) {\r\n            PreState.tmp.dragActionType = dragActionType;\r\n          }\r\n          if (!!PreState.tmp.dragActionType) {\r\n            if (!!PreState.pointer.drag.isDragging) {\r\n              if (PreState.tmp.dragActionType?.type === \"editTool\") {\r\n                calcSubcharts = editToolPosition(\r\n                  PreState.tmp.dragActionType,\r\n                  calcSubcharts,\r\n                  calcXaxis,\r\n                  PreState.pointer\r\n                );\r\n              }\r\n            }\r\n            if (!PreState.pointer.drag.isDragging) {\r\n              if (PreState.tmp.dragActionType?.type === \"editTool\") {\r\n                //   console.log(PreState.tmp.dragActionType, PreState.pointer.drag);\r\n                calcSubcharts = editToolPosition(\r\n                  PreState.tmp.dragActionType,\r\n                  calcSubcharts,\r\n                  calcXaxis,\r\n                  PreState.pointer\r\n                );\r\n                // and trigger update of ChartState.subCharts for the effect hook\r\n                PreState.userInteractedChartState = null;\r\n                PreState.tmp.dragActionType = null;\r\n              } else if (DragEndState.isDragPointerUp && PreState.tmp.dragActionType?.type === \"drawTool\") {\r\n                const nPoints = !ChartState.draw.type\r\n                  ? 0\r\n                  : [\"hline\", \"vline\"].includes(ChartState.draw.type)\r\n                  ? 1\r\n                  : [\"trendline\"].includes(ChartState.draw.type)\r\n                  ? 2\r\n                  : 0;\r\n                // console.log(nPoints, ChartState.draw, ChartState.draw.isDrawing);\r\n                if (!nPoints) calcDraw = { isDrawing: false, pixXy: [] };\r\n                else {\r\n                  if (calcDraw.pixXy.length < nPoints - 1) {\r\n                    calcDraw = addToolAnchor(calcDraw.type, calcDraw, PreState.pointer);\r\n                    // console.log(\"drawing 0\", ChartState.draw, DragEndState);\r\n                  } else {\r\n                    calcDraw = addToolAnchor(calcDraw.type, calcDraw, PreState.pointer);\r\n                    calcSubcharts = addTool(calcSubcharts, calcXaxis, calcDraw, PreState.pointer.drag);\r\n                    calcDraw = { isDrawing: false, pixXy: [] };\r\n                    PreState.tmp.dragActionType = null;\r\n                    // console.log(\"drawing 1\", DragEndState);\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n\r\n        const { lastUpdate, shallUpdate, userInteractedChartState, xaxis, tmp, ...state } = PreState;\r\n        PreState.xaxis = { ...PreState.xaxis, ...calcXaxis };\r\n        if (!!currentPointer) PreState.pointer.chartPointer = currentPointer;\r\n        // PreState.subcharts = calcSubcharts;\r\n\r\n        Dispatch({\r\n          task: \"updateInteractionState\",\r\n          params: {\r\n            newState: {\r\n              ...state,\r\n              xaxis: calcXaxis as any,\r\n              subCharts: calcSubcharts,\r\n              draw: calcDraw,\r\n            },\r\n            // resizeSubchartObj,\r\n          },\r\n        } as ReducerActionType<\"updateInteractionState\">);\r\n\r\n        PreStateRef.current = {\r\n          ...PreState,\r\n          lastUpdate: new Date(),\r\n          shallUpdate: [],\r\n        };\r\n      }\r\n    };\r\n    // onTimer(); // exec immmediately\r\n    console.log(\"updated Timer\");\r\n    PreStateRef.current.shallUpdate.push(\"deps\");\r\n    onTimer();\r\n    const handleTimer = window.setInterval(onTimer, 1000 / maxUpdatesPerSec);\r\n    return () => {\r\n      window.clearInterval(handleTimer);\r\n    };\r\n  }, [\r\n    maxUpdatesPerSec,\r\n    initWidthPerTick,\r\n    ChartState.draw.isDrawing,\r\n    ChartState.draw.pixXy,\r\n    ChartState.yaxis.widthYAxis,\r\n    ChartState.xaxis.heightXAxis,\r\n    PreStateRef.current.userInteractedChartState,\r\n    ChartState.fullscreen,\r\n  ]);\r\n\r\n  return [\r\n    {\r\n      ...ChartState,\r\n      methods: getChartMethods(ChartState, containerHeight, Dispatch),\r\n    },\r\n    Dispatch,\r\n  ];\r\n};\r\n","import React from \"react\";\r\nimport { Circle, Line } from \"react-konva\";\r\nimport { DrawingTool } from \"../Types/CChartStateTypes\";\r\n\r\nexport type CTrendlineProps = {\r\n  style?: DrawingTool[\"style\"];\r\n  pixXy: [[number, number], [number, number]];\r\n  mode: \"line\" | \"trendline\" | \"infiniteLine\";\r\n  subchartTop: number;\r\n  subchartBottom: number;\r\n};\r\n\r\nexport const CTrendline = (props: CTrendlineProps) => {\r\n  const { style, pixXy, mode, subchartTop, subchartBottom } = props;\r\n  if (pixXy.length !== 2) return null;\r\n  const strokeColor = !!style?.strokeColor ? style.strokeColor : \"red\";\r\n  const anchorColor = !!style?.anchorColor ? style.anchorColor : \"#333\";\r\n  const modeInt = [\"line\", \"trendline\", \"infiniteLine\"].includes(mode) ? mode : \"trendline\";\r\n  const pixXyAdjusted: [number, number][] = [];\r\n\r\n  if (pixXy[0][0] > pixXy[1][0]) {\r\n    pixXyAdjusted.push([...pixXy[1]], [...pixXy[0]]);\r\n  } else pixXyAdjusted.push([...pixXy[0]], [...pixXy[1]]);\r\n\r\n  if (modeInt === \"trendline\" || mode === \"infiniteLine\") {\r\n    const dx = pixXyAdjusted[1][0] - pixXyAdjusted[0][0];\r\n    const dy = pixXyAdjusted[1][1] - pixXyAdjusted[0][1];\r\n    const slope = dy / dx;\r\n    const pixYTarget = dy < 0 ? subchartTop : subchartBottom;\r\n    const b = pixXyAdjusted[0][1] - slope * pixXyAdjusted[0][0];\r\n    const pixXTarget = (pixYTarget - b) / slope;\r\n    pixXyAdjusted[1][0] = pixXTarget;\r\n    pixXyAdjusted[1][1] = pixYTarget;\r\n    if (mode === \"infiniteLine\") {\r\n      const pixYSrc = dy < 0 ? subchartBottom : subchartTop;\r\n      const pixXSrc = (pixYSrc - b) / slope;\r\n      pixXyAdjusted[0][0] = pixXSrc;\r\n      pixXyAdjusted[0][1] = pixYSrc;\r\n    }\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Line\r\n        x={0}\r\n        y={0}\r\n        points={[pixXyAdjusted[0][0], pixXyAdjusted[0][1], pixXyAdjusted[1][0], pixXyAdjusted[1][1]]}\r\n        stroke={strokeColor}\r\n        strokeWidth={1}\r\n      />\r\n      <Circle x={pixXy[0][0]} y={pixXy[0][1]} radius={5} fill={anchorColor} />\r\n      <Circle x={pixXy[1][0]} y={pixXy[1][1]} radius={5} fill={anchorColor} />\r\n    </React.Fragment>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { Circle, Line } from \"react-konva\";\r\nimport { DrawingTool } from \"../Types/CChartStateTypes\";\r\n\r\nexport type CVlineProps = {\r\n  style?: DrawingTool[\"style\"];\r\n  pixXy: [[number, number]];\r\n  mode: \"extendUp\" | \"extendDown\" | \"extendUpDown\" | \"*extendToSecondPoint\";\r\n  subchartTop: number;\r\n  subchartBottom: number;\r\n};\r\n\r\nexport const CVline = (props: CVlineProps) => {\r\n  const { style, pixXy, subchartTop, subchartBottom } = props;\r\n  if (pixXy.length !== 1) return null;\r\n  const strokeColor = !!style?.strokeColor ? style.strokeColor : \"red\";\r\n  const anchorColor = !!style?.anchorColor ? style.anchorColor : \"#333\";\r\n  //  TODO\r\n  // const modeInt = [\"extendUp\", \"extendDown\", \"extendUpDown\", \"*extendToSecondPoint\"].includes(mode)\r\n  //   ? mode\r\n  //   : \"extendUpDown\";\r\n  const pixXyAdjusted: [number, number][] = [];\r\n  pixXyAdjusted.push([pixXy[0][0], subchartTop], [pixXy[0][0], subchartBottom]);\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Line\r\n        x={0}\r\n        y={0}\r\n        points={[pixXyAdjusted[0][0], pixXyAdjusted[0][1], pixXyAdjusted[1][0], pixXyAdjusted[1][1]]}\r\n        stroke={strokeColor}\r\n        strokeWidth={1}\r\n      />\r\n      <Circle x={pixXy[0][0]} y={pixXy[0][1]} radius={5} fill={anchorColor} />\r\n    </React.Fragment>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { Line, Circle } from \"react-konva\";\r\nimport { DrawingTool } from \"../Types/CChartStateTypes\";\r\n\r\nexport type CHlineProps = {\r\n  style?: DrawingTool[\"style\"];\r\n  pixXy: [[number, number]];\r\n  mode: \"extendRight\" | \"extendLeft\" | \"extendLeftRight\" | \"*extendToSecondPoint\";\r\n  pixXstart: number;\r\n  pixXend: number;\r\n};\r\n\r\nexport const CHline = (props: CHlineProps) => {\r\n  const { style, pixXy, pixXstart, pixXend } = props;\r\n  if (pixXy.length !== 1) return null;\r\n  const strokeColor = !!style?.strokeColor ? style.strokeColor : \"red\";\r\n  const anchorColor = !!style?.anchorColor ? style.anchorColor : \"#333\";\r\n  // TODO\r\n  // const modeInt = [\"extendRight\", \"extendLeft\", \"extendLeftRight\", \"*extendToSecondPoint\"].includes(mode)\r\n  //   ? mode\r\n  //   : \"extendLeftRight\";\r\n  const pixXyAdjusted: [number, number][] = [];\r\n  pixXyAdjusted.push([pixXstart, pixXy[0][1]], [pixXend, pixXy[0][1]]);\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Line\r\n        x={0}\r\n        y={0}\r\n        points={[pixXyAdjusted[0][0], pixXyAdjusted[0][1], pixXyAdjusted[1][0], pixXyAdjusted[1][1]]}\r\n        stroke={strokeColor}\r\n        strokeWidth={1}\r\n      />\r\n      <Circle x={pixXy[0][0]} y={pixXy[0][1]} radius={5} fill={anchorColor} />\r\n    </React.Fragment>\r\n  );\r\n};\r\n","import { createMuiTheme, responsiveFontSizes } from \"@material-ui/core/styles\";\r\nexport const muiTheme = (() => {\r\n  let localTheme = createMuiTheme({\r\n    palette: {\r\n      primary: {\r\n        main: \"#009688\",\r\n      },\r\n      secondary: {\r\n        main: \"#f50057\",\r\n      },\r\n      type: \"light\",\r\n    },\r\n  });\r\n\r\n  localTheme.typography.h1 = {\r\n    fontFamily: \"'Open Sans', sans-serif, Arial\",\r\n    fontWeight: 600,\r\n    fontSize: \"3rem\",\r\n    lineHeight: 1.167,\r\n  };\r\n  localTheme.typography.h2 = {\r\n    fontFamily: \"'Open Sans', sans-serif, Arial\",\r\n    fontWeight: 600,\r\n    fontSize: \"2.5rem\",\r\n    lineHeight: 1.167,\r\n  };\r\n  localTheme.typography.h3 = {\r\n    fontFamily: \"'Open Sans', sans-serif, Arial\",\r\n    fontWeight: 600,\r\n    fontSize: \"2rem\",\r\n    lineHeight: 1.167,\r\n  };\r\n  localTheme.typography.h4 = {\r\n    fontFamily: \"'Open Sans', sans-serif, Arial\",\r\n    fontWeight: 600,\r\n    fontSize: \"1.88rem\",\r\n    lineHeight: 1.167,\r\n  };\r\n  localTheme.typography.h5 = {\r\n    fontFamily: \"'Open Sans', sans-serif, Arial\",\r\n    fontWeight: 600,\r\n    fontSize: \"1.44rem\",\r\n    lineHeight: 1.167,\r\n  };\r\n  localTheme.typography.h6 = {\r\n    fontFamily: \"'Open Sans', sans-serif, Arial\",\r\n    fontWeight: 600,\r\n    fontSize: \"1.25rem\",\r\n    lineHeight: 1.167,\r\n  };\r\n  localTheme.typography.fontFamily = \"'Quattrocento Sans', sans-serif\";\r\n  localTheme = responsiveFontSizes(localTheme);\r\n  return localTheme;\r\n})();\r\n","import {\r\n  Button,\r\n  Grid,\r\n  ListItem,\r\n  List,\r\n  Paper,\r\n  Typography,\r\n  useMediaQuery,\r\n  ListItemIcon,\r\n  ListItemText,\r\n  useTheme,\r\n} from \"@material-ui/core\";\r\nimport { mdiChartLine, mdiChartBellCurve, mdiPencilRuler, mdiTune, mdiStarShooting } from \"@mdi/js\";\r\nimport Icon from \"@mdi/react\";\r\nimport React from \"react\";\r\nimport { Stage, Layer, Rect, Line, Shape } from \"react-konva\";\r\nimport { CCandleChart } from \"../Charts/CCandleChart\";\r\nimport { CalculatedChartStateType } from \"../Types/CChartStateTypes\";\r\nimport { CChartMenuOpenType } from \"./ChartMenu\";\r\n\r\nexport const ChartMenuHome = (props: {\r\n  ChartState: CalculatedChartStateType;\r\n  onNavigate: (target: CChartMenuOpenType) => void;\r\n}) => {\r\n  const { ChartState, onNavigate } = props;\r\n\r\n  const isMinSm = useMediaQuery(\"(min-width:600px)\");\r\n  const previewSize = !isMinSm ? 248 : 320;\r\n  const { widthYAxis, widthTickmarkLines } = ChartState.yaxis;\r\n  const { heightXAxis, heightTickMarkLines } = ChartState.xaxis;\r\n  const containerWidth = ChartState.containerSize.width - 1;\r\n  const containerHeight = ChartState.containerSize.height - 1;\r\n  const xAxis = ChartState.xaxis.xAxisTicks;\r\n  const theme = useTheme();\r\n\r\n  return (\r\n    <React.Fragment>\r\n      {/* <Grid container>\r\n        <Grid item> */}\r\n      <List>\r\n        <ListItem button>\r\n          <ListItemIcon\r\n            style={{\r\n              border: \"1px solid #666\",\r\n              borderRadius: 5,\r\n              marginRight: 10,\r\n              background: theme.palette.secondary.main,\r\n              minWidth: 48,\r\n              height: 48,\r\n            }}\r\n          >\r\n            <Icon path={mdiChartLine} size={2} color={theme.palette.secondary.contrastText} />\r\n          </ListItemIcon>\r\n          <ListItemText primary=\"Chart (upcoming)\" primaryTypographyProps={{ variant: \"h6\", color: \"textSecondary\" }} />\r\n        </ListItem>\r\n        <ListItem\r\n          button\r\n          onClick={() => {\r\n            onNavigate?.(\"indicators\");\r\n          }}\r\n        >\r\n          <ListItemIcon\r\n            style={{\r\n              border: \"1px solid #666\",\r\n              borderRadius: 5,\r\n              marginRight: 10,\r\n              background: theme.palette.secondary.main,\r\n              minWidth: 48,\r\n              height: 48,\r\n            }}\r\n          >\r\n            <Icon path={mdiChartBellCurve} size={2} color={theme.palette.secondary.contrastText} />\r\n          </ListItemIcon>\r\n          <ListItemText primary=\"Indicators\" primaryTypographyProps={{ variant: \"h6\", color: \"textSecondary\" }} />\r\n        </ListItem>\r\n        <ListItem\r\n          button\r\n          onClick={() => {\r\n            onNavigate?.(\"tools\");\r\n          }}\r\n        >\r\n          <ListItemIcon\r\n            style={{\r\n              border: \"1px solid #666\",\r\n              borderRadius: 5,\r\n              marginRight: 10,\r\n              background: theme.palette.secondary.main,\r\n              minWidth: 48,\r\n              height: 48,\r\n            }}\r\n          >\r\n            <Icon path={mdiPencilRuler} size={2} color={theme.palette.secondary.contrastText} />\r\n          </ListItemIcon>\r\n          <ListItemText primary=\"Tools\" primaryTypographyProps={{ variant: \"h6\", color: \"textSecondary\" }} />\r\n        </ListItem>\r\n        <ListItem\r\n          button\r\n          onClick={() => {\r\n            onNavigate?.(\"settings\");\r\n          }}\r\n        >\r\n          <ListItemIcon\r\n            style={{\r\n              border: \"1px solid #666\",\r\n              borderRadius: 5,\r\n              marginRight: 10,\r\n              background: theme.palette.secondary.main,\r\n              minWidth: 48,\r\n              height: 48,\r\n            }}\r\n          >\r\n            <Icon path={mdiTune} size={2} color={theme.palette.secondary.contrastText} />\r\n          </ListItemIcon>\r\n          <ListItemText primary=\"Settings\" primaryTypographyProps={{ variant: \"h6\", color: \"textSecondary\" }} />\r\n        </ListItem>\r\n        <ListItem\r\n          button\r\n          onClick={() => {\r\n            onNavigate?.(\"quickys\");\r\n          }}\r\n        >\r\n          <ListItemIcon\r\n            style={{\r\n              border: \"1px solid #666\",\r\n              borderRadius: 5,\r\n              marginRight: 10,\r\n              background: theme.palette.secondary.main,\r\n              minWidth: 48,\r\n              height: 48,\r\n            }}\r\n          >\r\n            <Icon path={mdiStarShooting} size={2} color={theme.palette.secondary.contrastText} />\r\n          </ListItemIcon>\r\n          <ListItemText primary=\"Quick Tasks (upcoming)\" primaryTypographyProps={{ variant: \"h6\", color: \"textSecondary\" }} />\r\n        </ListItem>\r\n      </List>\r\n      {/* </Grid>\r\n      </Grid> */}\r\n    </React.Fragment>\r\n    // <Grid container alignItems=\"center\">\r\n    //   <Grid\r\n    //     container\r\n    //     item\r\n    //     spacing={2}\r\n    //     alignItems=\"center\"\r\n    //     justify=\"center\"\r\n    //     //   style={{justifyContent: \"flex-end\"}}\r\n    //     //   style={{ maxWidth: !isMinSm ? 400 : \"auto\" }}\r\n    //     //   wrap=\"nowrap\"\r\n    //     xs={12}\r\n    //     sm={4}\r\n    //     style={{ paddingBottom: 24 }}\r\n    //   >\r\n    //     <Grid item sm={12} xs={6}>\r\n    //       <div style={{ margin: !isMinSm ? \"0px 0px 0px auto\" : 0, width: 128 }}>\r\n    //         <Button\r\n    //           color=\"secondary\"\r\n    //           variant=\"contained\"\r\n    //           style={{ width: 96, height: 96, textTransform: \"none\", borderRadius: 5 }}\r\n    //         >\r\n    //           <div style={{ position: \"relative\", top: 0 }}>\r\n    //             <div>\r\n    //               <Icon path={mdiChartLine} size=\"75px\" />\r\n    //             </div>\r\n    //             <Typography\r\n    //               style={{ width: \"100%\", marginTop: -12, display: \"block\", color: \"#fff\", fontWeight: 600 }}\r\n    //               // color=\"secondary\"\r\n    //               variant=\"body1\"\r\n    //               component=\"div\"\r\n    //             >\r\n    //               <div style={{ margin: \"0px auto\", width: \"max-content\" }}>Chart</div>\r\n    //             </Typography>\r\n    //           </div>\r\n    //         </Button>\r\n    //       </div>\r\n    //     </Grid>\r\n    //     <Grid item sm={12} xs={6}>\r\n    //       <div style={{ width: \"max-content\" }}>\r\n    //         <Button\r\n    //           color=\"secondary\"\r\n    //           variant=\"contained\"\r\n    //           style={{ width: 96, height: 96, textTransform: \"none\", borderRadius: 5 }}\r\n    //           onClick={() => {\r\n    //             onNavigate?.(\"indicators\");\r\n    //           }}\r\n    //         >\r\n    //           <div style={{ position: \"relative\", top: 0 }}>\r\n    //             <div>\r\n    //               <Icon path={mdiChartBellCurve} size=\"72px\" />\r\n    //             </div>\r\n    //             <Typography\r\n    //               style={{ width: \"100%\", marginTop: -12, display: \"block\", color: \"#fff\", fontWeight: 600 }}\r\n    //               // color=\"secondary\"\r\n    //               variant=\"body1\"\r\n    //               component=\"div\"\r\n    //             >\r\n    //               <div style={{ margin: \"0px auto\", width: \"max-content\" }}>Indicators</div>\r\n    //             </Typography>\r\n    //           </div>\r\n    //         </Button>\r\n    //       </div>\r\n    //     </Grid>\r\n    //     <Grid item sm={12} xs={6}>\r\n    //       <div style={{ margin: !isMinSm ? \"0px 0px 0px auto\" : 0, width: 128 }}>\r\n    //         <Button\r\n    //           color=\"secondary\"\r\n    //           variant=\"contained\"\r\n    //           style={{ width: 96, height: 96, textTransform: \"none\", borderRadius: 5 }}\r\n    //           onClick={() => onNavigate?.(\"tools\")}\r\n    //         >\r\n    //           <div style={{ position: \"relative\", top: 0 }}>\r\n    //             <div>\r\n    //               <Icon path={mdiPencilRuler} size=\"72px\" />\r\n    //             </div>\r\n    //             <Typography\r\n    //               style={{ width: \"100%\", marginTop: -12, display: \"block\", color: \"#fff\", fontWeight: 600 }}\r\n    //               // color=\"secondary\"\r\n    //               variant=\"body1\"\r\n    //               component=\"div\"\r\n    //             >\r\n    //               <div style={{ margin: \"0px auto\", width: \"max-content\" }}>Tools</div>\r\n    //             </Typography>\r\n    //           </div>\r\n    //         </Button>\r\n    //       </div>\r\n    //     </Grid>\r\n    //     <Grid item sm={12} xs={6}>\r\n    //       {/* <div style={{ margin: \"0px auto\", width: \"max-content\" }}> */}\r\n    //       <Button\r\n    //         color=\"secondary\"\r\n    //         variant=\"contained\"\r\n    //         style={{ width: 96, height: 96, textTransform: \"none\", borderRadius: 5 }}\r\n    //         onClick={() => onNavigate?.(\"settings\")}\r\n    //       >\r\n    //         <div style={{ position: \"relative\", top: 0 }}>\r\n    //           <div>\r\n    //             <Icon path={mdiTune} size=\"72px\" />\r\n    //           </div>\r\n    //           <Typography\r\n    //             style={{ width: \"100%\", marginTop: -12, display: \"block\", color: \"#fff\", fontWeight: 600 }}\r\n    //             // color=\"secondary\"\r\n    //             variant=\"body1\"\r\n    //             component=\"div\"\r\n    //           >\r\n    //             <div style={{ margin: \"0px auto\", width: \"max-content\" }}>Settings</div>\r\n    //           </Typography>\r\n    //         </div>\r\n    //       </Button>\r\n    //       {/* </div> */}\r\n    //     </Grid>\r\n    //     <Grid item sm={12} xs={6}>\r\n    //       {/* <div style={{ margin: \"0px auto\", width: \"max-content\" }}> */}\r\n    //       <Button\r\n    //         color=\"secondary\"\r\n    //         variant=\"contained\"\r\n    //         style={{ width: 96, height: 96, textTransform: \"none\", borderRadius: 5 }}\r\n    //         onClick={() => onNavigate?.(\"settings\")}\r\n    //       >\r\n    //         <div style={{ position: \"relative\", top: 0 }}>\r\n    //           <div>\r\n    //             <Icon path={mdiStarShooting} size=\"72px\" />\r\n    //           </div>\r\n    //           <Typography\r\n    //             style={{ width: \"100%\", marginTop: -12, display: \"block\", color: \"#fff\", fontWeight: 600 }}\r\n    //             // color=\"secondary\"\r\n    //             variant=\"body1\"\r\n    //             component=\"div\"\r\n    //           >\r\n    //             <div style={{ margin: \"0px auto\", width: \"max-content\" }}>Shortcuts</div>\r\n    //           </Typography>\r\n    //         </div>\r\n    //       </Button>\r\n    //       {/* </div> */}\r\n    //     </Grid>\r\n    //   </Grid>\r\n    //   {!!null ? (\r\n    //     <Grid item xs={12} sm={6}>\r\n    //       <Paper style={{ width: previewSize, height: previewSize, margin: \"0 auto\", border: \"1px solid #666\" }}>\r\n    //         <Stage //konva container\r\n    //           width={previewSize}\r\n    //           height={previewSize}\r\n    //           listening={false}\r\n\r\n    //           // style={{ boxSizing: \"border-box\" }}\r\n    //         >\r\n    //           {/*  Canvas Layer 3 - chart and example */}\r\n\r\n    //           <Layer\r\n    //             scale={{\r\n    //               x: previewSize / ChartState.containerSize.width,\r\n    //               y: previewSize / ChartState.containerSize.height,\r\n    //             }}\r\n    //           >\r\n    //             {/* <Rect\r\n    //           x={20 + ChartState.pointer.totalTranslatedX}\r\n    //           y={50 + ChartState.pointer.totalTranslatedY}\r\n    //           width={100}\r\n    //           height={100}\r\n    //           fill=\"red\"\r\n    //           shadowBlur={10}\r\n    //         /> */}\r\n    //             {0 in ChartState.subCharts ? <CCandleChart fullState={ChartState} /> : null}\r\n    //           </Layer>\r\n    //           {/*  Canvas Layer 5 (before 0) - axis bg rects + future chartbgcolor? */}\r\n    //           <Layer\r\n    //             scale={{\r\n    //               x: previewSize / ChartState.containerSize.width,\r\n    //               y: previewSize / ChartState.containerSize.height,\r\n    //             }}\r\n    //           >\r\n    //             <Rect\r\n    //               x={0 + 0.5}\r\n    //               y={containerHeight - heightXAxis + 0.5}\r\n    //               width={containerWidth}\r\n    //               height={heightXAxis}\r\n    //               fill={ChartState.xaxis.style.fillColor}\r\n    //               stroke={ChartState.xaxis.style.strokeColor}\r\n    //               strokeWidth={1}\r\n    //             />\r\n    //             {ChartState.subCharts.map((subchart, subchartIdx) => (\r\n    //               <React.Fragment key={subchartIdx}>\r\n    //                 <Rect\r\n    //                   // key={`subchartPrimaryYaxis-${subchartIdx}`}\r\n    //                   x={containerWidth - widthYAxis + 0.5}\r\n    //                   y={subchart.top + 0.5}\r\n    //                   width={widthYAxis}\r\n    //                   height={subchart.bottom - subchart.top}\r\n    //                   // fill={ChartState.xaxis.style.fillColor}\r\n    //                   stroke={ChartState.xaxis.style.strokeColor}\r\n    //                   strokeWidth={1}\r\n    //                 />\r\n    //                 <Rect\r\n    //                   // key={`subchartBorder-${subchartIdx}`}\r\n    //                   x={0 + 0.5}\r\n    //                   y={subchart.top + 0.5}\r\n    //                   width={containerWidth - widthYAxis}\r\n    //                   height={subchart.bottom - subchart.top}\r\n    //                   stroke={ChartState.xaxis.style.strokeColor}\r\n    //                   strokeWidth={1}\r\n    //                 />\r\n    //               </React.Fragment>\r\n    //             ))}\r\n    //           </Layer>\r\n    //           {/*  Canvas Layer 6 before 1 - x axis */}\r\n    //           <Layer\r\n    //             scale={{\r\n    //               x: previewSize / ChartState.containerSize.width,\r\n    //               y: previewSize / ChartState.containerSize.height,\r\n    //             }}\r\n    //           >\r\n    //             {xAxis.map((xaxisTick, xaxisTickIdx) => {\r\n    //               return (\r\n    //                 <React.Fragment key={xaxisTickIdx}>\r\n    //                   <Line\r\n    //                     x={xaxisTick.x}\r\n    //                     y={ChartState.containerSize.height - 1 - heightXAxis + 0.5}\r\n    //                     points={[0, 0, 0, heightTickMarkLines]}\r\n    //                     stroke={ChartState.xaxis.style.strokeColor}\r\n    //                     strokeWidth={1}\r\n    //                   />\r\n    //                   {!!ChartState.grid.useGridX ? (\r\n    //                     <Line\r\n    //                       x={xaxisTick.x}\r\n    //                       y={0 + 0.5}\r\n    //                       points={[0, 0, 0, ChartState.containerSize.height - 1 - heightXAxis + 0.5]}\r\n    //                       stroke={ChartState.grid.style.strokeColor}\r\n    //                       strokeWidth={1}\r\n    //                     />\r\n    //                   ) : null}\r\n    //                   <Shape\r\n    //                     sceneFunc={(context, shape) => {\r\n    //                       // context.fillS\r\n    //                       const ctx = context._context;\r\n    //                       ctx.font = ChartState.xaxis.style.fontSize + \"px \" + ChartState.xaxis.style.fontName;\r\n    //                       ctx.fillStyle = ChartState.xaxis.style.fontColor;\r\n    //                       ctx.textAlign = \"center\";\r\n    //                       ctx.textBaseline = \"top\";\r\n    //                       ctx.fillText(\r\n    //                         xaxisTick.dateString,\r\n    //                         xaxisTick.x,\r\n    //                         ChartState.containerSize.height - 1 - heightXAxis + 0.5 + 20 + 5 // additional 5px distance to end of tickmark\r\n    //                       );\r\n    //                       // (!) Konva specific method, it is very important\r\n    //                       context.fillStrokeShape(shape);\r\n    //                     }}\r\n    //                     // fill=\"#333\"\r\n    //                     // stroke={ChartState.options.xAxis.style.fontColor}\r\n    //                     // strokeWidth={1}\r\n    //                   />\r\n    //                 </React.Fragment>\r\n    //               );\r\n    //             })}\r\n    //           </Layer>\r\n    //           {/*  Canvas Layer 7 before 2 - y axis */}\r\n    //           <Layer\r\n    //             scale={{\r\n    //               x: previewSize / ChartState.containerSize.width,\r\n    //               y: previewSize / ChartState.containerSize.height,\r\n    //             }}\r\n    //           >\r\n    //             {ChartState.subCharts.map((subchart, subchartIdx) => {\r\n    //               return subchart.yaxis.map((singleYaxis, singleYaxisIdx) => {\r\n    //                 const yAxisTicks = singleYaxis.drawTicks;\r\n\r\n    //                 // const yAxisTicks =\r\n    //                 //   subchartIdx === 0 ? subchart.yaxis[0] : subchart.yaxis[0].slice(0, subchart.yaxis[0].length - 1);\r\n    //                 return yAxisTicks.map((yaxisTick, yaxisTickIdx) => {\r\n    //                   return (\r\n    //                     <React.Fragment key={yaxisTick.label}>\r\n    //                       <Line\r\n    //                         x={ChartState.containerSize.width - 1 - widthYAxis + 0.5}\r\n    //                         y={yaxisTick.pixY + 0.5}\r\n    //                         points={[0, 0, widthTickmarkLines, 0]}\r\n    //                         stroke={ChartState.xaxis.style.strokeColor}\r\n    //                         strokeWidth={1}\r\n    //                       />\r\n    //                       {!!ChartState.grid.useGridY ? (\r\n    //                         <Line\r\n    //                           x={0 + 0.5}\r\n    //                           y={yaxisTick.pixY + 0.5}\r\n    //                           points={[0, 0, ChartState.containerSize.width - 1 + 0.5, 0]}\r\n    //                           stroke={ChartState.grid.style.strokeColor}\r\n    //                           strokeWidth={1}\r\n    //                         />\r\n    //                       ) : null}\r\n    //                       <Shape\r\n    //                         sceneFunc={(context, shape) => {\r\n    //                           // context.fillS\r\n    //                           const ctx = context._context;\r\n    //                           ctx.font = ChartState.yaxis.style.fontSize + \"px \" + ChartState.yaxis.style.fontName;\r\n    //                           ctx.fillStyle = ChartState.yaxis.style.fontColor;\r\n    //                           ctx.textAlign = \"left\";\r\n    //                           ctx.textBaseline = \"middle\";\r\n    //                           ctx.fillText(\r\n    //                             yaxisTick.label,\r\n    //                             ChartState.containerSize.width - 1 - widthYAxis + widthTickmarkLines + 5 + 0.5,\r\n    //                             yaxisTick.pixY // additional 5px distance to end of tickmark\r\n    //                           );\r\n    //                           // (!) Konva specific method, it is very important\r\n    //                           context.fillStrokeShape(shape);\r\n    //                         }}\r\n    //                       />\r\n    //                     </React.Fragment>\r\n    //                   );\r\n    //                 });\r\n    //               });\r\n    //             })}\r\n    //           </Layer>\r\n    //         </Stage>\r\n    //       </Paper>\r\n    //     </Grid>\r\n    //   ) : null}\r\n    // </Grid>\r\n  );\r\n};\r\n","import { createChartGraphModel } from \"./CChartModel\";\r\nimport {\r\n  DataSeries,\r\n  ChartDataset,\r\n  IndicatorDataset,\r\n  isCandleChartDataset,\r\n  isVolumeDataset,\r\n  IndicatorDataSeries,\r\n  ChartDataSeries,\r\n  isLineChartDataset,\r\n  isIndicatorDataset,\r\n} from \"./Types/CChartTypes\";\r\nimport { AdditionalIndicatorGraphStateType, isChartGraph } from \"./Types/CChartStateTypes\";\r\n\r\nexport const iSMACalc = (\r\n  srcChartData: DataSeries,\r\n  srcChartName: string,\r\n  period: number = 20,\r\n  applyOn: \"open\" | \"close\" | \"high\" | \"low\" = \"close\"\r\n): IndicatorDataSeries => {\r\n  const indicatorData: IndicatorDataSeries =\r\n    srcChartData.map((srcDataset, srcDatasetIdx) => {\r\n      if (srcDatasetIdx < period - 1) return { prices: [null], date: srcDataset.date };\r\n      let singleSmaAcc = 0;\r\n      srcChartData.slice(srcDatasetIdx - period + 1, srcDatasetIdx + 1).forEach((selSrcDataset) => {\r\n        if (isLineChartDataset(selSrcDataset)) singleSmaAcc += selSrcDataset.close;\r\n        else if (isIndicatorDataset(selSrcDataset))\r\n          singleSmaAcc += !!selSrcDataset.prices[0] ? selSrcDataset.prices[0] : 0;\r\n      });\r\n      return { prices: [singleSmaAcc / period], date: srcDataset.date };\r\n    }) || [];\r\n  return indicatorData;\r\n  // const indicatorData: IndicatorDataset[] = [];\r\n  // for (let i = 0; i < srcChartData.length; i++) {\r\n  //   if (i < period - 1) {\r\n  //     indicatorData.push({ prices: [null], date: srcChartData[i].date });\r\n  //     continue;\r\n  //   }\r\n  //   let singleSmaAcc = 0;\r\n  //   for (let j = i - period + 1; j <= i; j++) {\r\n  //     singleSmaAcc += srcChartData[j].close;\r\n  //   }\r\n  //   indicatorData.push({ prices: [singleSmaAcc / period], date: srcChartData[i].date });\r\n  // }\r\n  // return indicatorData;\r\n};\r\n\r\nexport const iSMA: AdditionalIndicatorGraphStateType[\"indicator\"] = {\r\n  indicatorFn: iSMACalc,\r\n  name: \"SMA\",\r\n  params: [{ name: \"period\", val: 10 }],\r\n  default: { params: [{ name: \"period\", val: 10 }], newSubchart: false },\r\n  type: \"line\",\r\n};\r\n\r\nexport const iEMACalc = (\r\n  srcChartData: DataSeries,\r\n  srcChartName: string,\r\n  period: number = 20,\r\n  applyOn: \"open\" | \"close\" | \"high\" | \"low\" = \"close\"\r\n): IndicatorDataSeries => {\r\n  const indicatorData: IndicatorDataSeries = [];\r\n  for (let i = 0; i < srcChartData.length; i++) {\r\n    if (i < period - 1) {\r\n      indicatorData.push({ prices: [null], date: srcChartData[i].date });\r\n      continue;\r\n    } else if (i === period - 1) {\r\n      let initSMA = 0;\r\n      for (let j = 0; j < period; j++) {\r\n        const dataset = srcChartData[j];\r\n        const price = isLineChartDataset(dataset)\r\n          ? dataset.close\r\n          : isIndicatorDataset(dataset)\r\n          ? dataset.prices[0] || 0\r\n          : 0;\r\n        initSMA += price;\r\n      }\r\n      initSMA /= period;\r\n      indicatorData.push({ prices: [initSMA], date: srcChartData[i].date });\r\n    } else {\r\n      const multiplier = 2 / (period + 1);\r\n      const dataset = srcChartData[i];\r\n      const price = isLineChartDataset(dataset)\r\n        ? dataset.close\r\n        : isIndicatorDataset(dataset)\r\n        ? dataset.prices[0] || 0\r\n        : 0;\r\n      const ema =\r\n        (price - (indicatorData[i - 1].prices[0] as number)) * multiplier + (indicatorData[i - 1].prices[0] as number);\r\n      indicatorData.push({ prices: [ema], date: srcChartData[i].date });\r\n    }\r\n  }\r\n  return indicatorData;\r\n};\r\nexport const iEMA: AdditionalIndicatorGraphStateType[\"indicator\"] = {\r\n  indicatorFn: iEMACalc,\r\n  name: \"EMA\",\r\n  params: [{ name: \"period\", val: 10 }],\r\n  default: { params: [{ name: \"period\", val: 10 }], newSubchart: false },\r\n  type: \"line\",\r\n};\r\n\r\nexport const iATRCalc = (\r\n  srcChartData: ChartDataset[],\r\n  srcChartName: string,\r\n  period: number = 20,\r\n  applyOn: \"open\" | \"close\" | \"high\" | \"low\" = \"close\"\r\n): IndicatorDataSeries => {\r\n  const indicatorData: IndicatorDataset[] = [];\r\n  for (let i = 0; i < srcChartData.length; i++) {\r\n    if (i < period) {\r\n      indicatorData.push({ prices: [null], date: srcChartData[i].date });\r\n      continue;\r\n    }\r\n    let singleValAcc = 0;\r\n    for (let j = i - period + 1; j <= i; j++) {\r\n      const dataset = srcChartData[j];\r\n      const dataset1 = srcChartData[j - 1];\r\n      let singleAtr = 0;\r\n      if (isCandleChartDataset(dataset) && isCandleChartDataset(dataset1)) {\r\n        const hl = dataset.high - dataset.low;\r\n        const hc1 = Math.abs(dataset.high - dataset1.close);\r\n        const lc1 = Math.abs(dataset.low - dataset1.close);\r\n        singleAtr = Math.max(hl, hc1, lc1);\r\n      } else {\r\n        const dc = Math.abs(dataset.close - dataset1.close);\r\n      }\r\n      singleValAcc += singleAtr;\r\n    }\r\n    indicatorData.push({ prices: [singleValAcc / period], date: srcChartData[i].date });\r\n  }\r\n  return indicatorData;\r\n};\r\nexport const iATR: AdditionalIndicatorGraphStateType[\"indicator\"] = {\r\n  indicatorFn: iATRCalc,\r\n  name: \"ATR\",\r\n  params: [{ name: \"period\", val: 14 }],\r\n  default: { params: [{ name: \"period\", val: 14 }], newSubchart: true },\r\n  type: \"line\",\r\n};\r\n\r\nexport const iRSICalc = (\r\n  srcChartData: ChartDataset[],\r\n  srcChartName: string,\r\n  period: number = 20,\r\n  applyOn: \"open\" | \"close\" | \"high\" | \"low\" = \"close\"\r\n): IndicatorDataSeries => {\r\n  const indicatorData: IndicatorDataset[] = [];\r\n  let calcData: { lastUpEma: number; lastDwnEma: number } | null = null;\r\n  for (let i = 0; i < srcChartData.length; i++) {\r\n    if (i < period) {\r\n      indicatorData.push({ prices: [null], date: srcChartData[i].date });\r\n      if (i === 0) continue;\r\n    }\r\n    const dataset = srcChartData[i];\r\n    const dataset1 = srcChartData[i - 1];\r\n    const dClose = dataset.close - dataset1.close;\r\n    const up = dClose > 0 ? dClose : 0;\r\n    const dwn = dClose < 0 ? -dClose : 0;\r\n    const w = 1 / period;\r\n    if (i === 1) {\r\n      calcData = { lastUpEma: up, lastDwnEma: dwn };\r\n    }\r\n    if (!calcData || i < period) {\r\n      continue;\r\n    }\r\n    const upSmoothed = up * w + (1 - w) * calcData.lastUpEma;\r\n    calcData.lastUpEma = upSmoothed;\r\n    const dwnSmoothed = dwn * w + (1 - w) * calcData.lastDwnEma;\r\n    calcData.lastDwnEma = dwnSmoothed;\r\n    const rsi = dwnSmoothed === 0 ? 100 : 100 - 100 / (1 + upSmoothed / dwnSmoothed);\r\n    if (i < period) indicatorData.push({ prices: [null], date: srcChartData[i].date });\r\n    else indicatorData.push({ prices: [rsi], date: srcChartData[i].date });\r\n  }\r\n  return indicatorData;\r\n};\r\nexport const iRSI: AdditionalIndicatorGraphStateType[\"indicator\"] = {\r\n  indicatorFn: iRSICalc,\r\n  name: \"RSI\",\r\n  params: [{ name: \"period\", val: 14 }],\r\n  default: { params: [{ name: \"period\", val: 14 }], newSubchart: true, decimals: 2, fixedYScale: [0, 100] },\r\n  type: \"line\",\r\n};\r\n\r\nexport const iOBVCalc = (srcChartData: ChartDataset[]): IndicatorDataSeries => {\r\n  const indicatorData: IndicatorDataset[] = [];\r\n  for (let i = 0; i < srcChartData.length; i++) {\r\n    const dataset = srcChartData[i];\r\n    if (i === 0 && isVolumeDataset(dataset)) {\r\n      indicatorData.push({ prices: [dataset.volume], date: dataset.date });\r\n      continue;\r\n    }\r\n    const dataset1 = srcChartData[i - 1];\r\n    if (!isVolumeDataset(dataset) || !isVolumeDataset(dataset1)) {\r\n      indicatorData.push({ prices: [null], date: srcChartData[i].date });\r\n      continue;\r\n    }\r\n    const obv = dataset.volume + dataset1.volume;\r\n    indicatorData.push({ prices: [obv], date: srcChartData[i].date });\r\n  }\r\n  return indicatorData;\r\n};\r\nexport const iOBV: AdditionalIndicatorGraphStateType[\"indicator\"] = {\r\n  name: \"OBV\",\r\n  type: \"line\",\r\n  params: [],\r\n  default: { params: [], newSubchart: true, decimals: 0 },\r\n  indicatorFn: iOBVCalc,\r\n};\r\n\r\nexport const iVolumeCalc = (srcChartData: ChartDataset[]): IndicatorDataSeries => {\r\n  const indicatorData: IndicatorDataset[] = [];\r\n  for (let i = 0; i < srcChartData.length; i++) {\r\n    const dataset = srcChartData[i];\r\n    if (isVolumeDataset(dataset)) {\r\n      indicatorData.push({ prices: [dataset.volume], date: dataset.date });\r\n    } else {\r\n      indicatorData.push({ prices: [0], date: dataset.date });\r\n    }\r\n  }\r\n  return indicatorData;\r\n};\r\nexport const iVolume: AdditionalIndicatorGraphStateType[\"indicator\"] = {\r\n  indicatorFn: iVolumeCalc,\r\n  name: \"Volume\",\r\n  params: [],\r\n  default: { params: [], newSubchart: true, decimals: 0 },\r\n  type: \"bars\",\r\n};\r\n\r\nexport const iMACDCalc = (\r\n  srcChartData: ChartDataset[],\r\n  srcChartName: string,\r\n  periodEmaShort: number = 12,\r\n  periodEmaLong: number = 26,\r\n  periodSignal: number = 9,\r\n  applyOn: \"open\" | \"close\" | \"high\" | \"low\" = \"close\"\r\n): IndicatorDataSeries => {\r\n  const indicatorData: IndicatorDataSeries = [];\r\n  const emaShort = iEMACalc(srcChartData, srcChartName, periodEmaShort);\r\n  const emaLong = iEMACalc(srcChartData, srcChartName, periodEmaLong);\r\n\r\n  const macd: IndicatorDataSeries = emaShort.map((val, valIdx) => {\r\n    const emaLongVal = emaLong[valIdx].prices[0];\r\n    const emaShortVal = val.prices[0];\r\n    const macd = emaShortVal === null || emaLongVal === null ? null : emaShortVal - emaLongVal;\r\n    return {\r\n      prices: [macd],\r\n      date: srcChartData[valIdx].date,\r\n      priceLabels: [\"EMA\"],\r\n    };\r\n  });\r\n  //   // const emaIn = ema.map((ema1, ema1Idx) => ({ close: ema1.prices[0], date: ema1.date }));\r\n  const signal = iEMACalc(macd, srcChartName, periodSignal);\r\n  const macdComplete = macd.map((macdVal, macdIdx) => {\r\n    const macdValPrice = macdVal.prices[0];\r\n    const signalVal = signal[macdIdx].prices[0];\r\n    const macdHistogramm = macdValPrice === null || signalVal === null ? null : macdValPrice-signalVal; \r\n    return { ...macdVal, prices: [macdValPrice, signalVal, macdHistogramm] };\r\n  });\r\n  return macdComplete;\r\n};\r\n\r\nexport const iMACD: AdditionalIndicatorGraphStateType[\"indicator\"] = {\r\n  indicatorFn: iMACDCalc,\r\n  name: \"MACD\",\r\n  params: [\r\n    { name: \"period short\", val: 12 },\r\n    { name: \"period long\", val: 26 },\r\n    { name: \"signal period\", val: 9 },\r\n  ],\r\n  default: {\r\n    params: [\r\n      { name: \"period short\", val: 12 },\r\n      { name: \"period long\", val: 26 },\r\n      { name: \"signal period\", val: 9 },\r\n    ],\r\n    newSubchart: true,\r\n    // decimals: 0,\r\n  },\r\n  type: \"line\",\r\n};\r\n","import { makeStyles, Theme, createStyles, Typography, TypographyProps } from \"@material-ui/core\";\r\nimport { Variant } from \"@material-ui/core/styles/createTypography\";\r\nimport { TreeItemProps, TreeItem } from \"@material-ui/lab\";\r\n\r\ndeclare module \"csstype\" {\r\n  interface Properties {\r\n    \"--tree-view-color\"?: string;\r\n    \"--tree-view-bg-color\"?: string;\r\n  }\r\n}\r\nconst useTreeItemStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    root: {\r\n      color: theme.palette.text.secondary,\r\n      \"&:hover > $content\": {\r\n        backgroundColor: theme.palette.action.hover,\r\n      },\r\n      \"&:focus > $content, &$selected > $content\": {\r\n        backgroundColor: `var(--tree-view-bg-color, ${theme.palette.grey[400]})`,\r\n        color: \"var(--tree-view-color)\",\r\n      },\r\n      \"&:focus > $content $label, &:hover > $content $label, &$selected > $content $label\": {\r\n        backgroundColor: \"transparent\",\r\n      },\r\n    },\r\n    content: {\r\n      color: theme.palette.text.secondary,\r\n      borderTopRightRadius: theme.spacing(2),\r\n      borderBottomRightRadius: theme.spacing(2),\r\n      paddingRight: theme.spacing(1),\r\n      fontWeight: theme.typography.fontWeightMedium,\r\n      \"$expanded > &\": {\r\n        fontWeight: theme.typography.fontWeightRegular,\r\n      },\r\n      width: \"auto\", \r\n    },\r\n    group: {\r\n      marginLeft: 0,\r\n      \"& $content\": {\r\n        paddingLeft: theme.spacing(2),\r\n      },\r\n    },\r\n    expanded: {},\r\n    selected: {},\r\n    label: {\r\n      fontWeight: \"inherit\",\r\n      color: \"inherit\",\r\n    },\r\n    labelRoot: {\r\n      display: \"flex\",\r\n      alignItems: \"center\",\r\n      padding: theme.spacing(1, 0),\r\n    },\r\n    labelRootBtn: {\r\n      // display: \"flex\",\r\n      // alignItems: \"left\",\r\n      // padding: theme.spacing(0.5, 0),\r\n      width: \"max-content\",\r\n    },\r\n    btnLabel: {\r\n      padding: 0,\r\n    },\r\n    labelIcon: {\r\n      marginRight: theme.spacing(1),\r\n    },\r\n    labelText: {\r\n      fontWeight: \"inherit\",\r\n      flexGrow: 1,\r\n    },\r\n  })\r\n);\r\n\r\n\r\nexport type CTreeItemProps = TreeItemProps & {\r\n  bgColor?: string;\r\n  color?: string;\r\n  labelIcon?: JSX.Element;\r\n  labelInfo?: JSX.Element | string;\r\n  labelText: string | JSX.Element;\r\n  onLabelClick?: TreeItemProps[\"onLabelClick\"];\r\n  onIconClick?: TreeItemProps[\"onIconClick\"];\r\n  labelTypographyVariant?: Variant;\r\n  infoTypographyVariant?: Variant;\r\n  labelTypographyColor?: TypographyProps[\"color\"];\r\n  infoTypographyColor?: TypographyProps[\"color\"];\r\n};\r\n\r\nexport const CTreeItem = (props: CTreeItemProps) => {\r\n  const classes = useTreeItemStyles();\r\n  const {\r\n    labelText,\r\n    labelIcon: LabelIcon,\r\n    labelInfo,\r\n    color,\r\n    bgColor,\r\n    onLabelClick,\r\n    onIconClick,\r\n    labelTypographyVariant,\r\n    infoTypographyVariant,\r\n    labelTypographyColor,\r\n    infoTypographyColor,\r\n    ...other\r\n  } = props;\r\n\r\n  return (\r\n    <TreeItem\r\n      onLabelClick={onLabelClick}\r\n      onIconClick={onIconClick}\r\n      label={\r\n        <div className={classes.labelRoot}>\r\n          {LabelIcon}\r\n          <Typography\r\n            variant={labelTypographyVariant ?? \"body1\"}\r\n            className={classes.labelText}\r\n            color={labelTypographyColor ?? \"initial\"}\r\n          >\r\n            {labelText}\r\n          </Typography>\r\n          <Typography variant={infoTypographyVariant ?? \"caption\"} color={infoTypographyColor ?? \"initial\"}>\r\n            {labelInfo}\r\n          </Typography>\r\n        </div>\r\n      }\r\n      style={{\r\n        \"--tree-view-color\": color as any,\r\n        \"--tree-view-bg-color\": bgColor,\r\n        // boxSizing: \"content-box\",\r\n      } as any}\r\n      classes={{\r\n        root: classes.root,\r\n        content: classes.content,\r\n        expanded: classes.expanded,\r\n        selected: classes.selected,\r\n        group: classes.group,\r\n        label: classes.label,\r\n      }}\r\n      {...other}\r\n    />\r\n  );\r\n};\r\n","import { Button, Grid, IconButton, OutlinedInput, Popover, Slider, TextField, Typography } from \"@material-ui/core\";\r\nimport { mdiCheck, mdiExclamation, mdiHook } from \"@mdi/js\";\r\nimport Icon from \"@mdi/react\";\r\nimport React from \"react\";\r\nimport { colorNameToHex, colorNameToRGB, hexToRgb } from \"./utils\";\r\n\r\n// const colors = [\r\n//   \"#000\", //black to white\r\n//   \"#666\",\r\n//   \"#bbb\",\r\n//   \"#fff\",\r\n//   \"#9013fe\", //violets\r\n//   \"#bd10e0\",\r\n//   \"#3f51b5\", // blues\r\n//   \"#0693E3\",\r\n//   \"#8ED1FC\",\r\n//   \"#008080\", // greens\r\n//   \"#00D084\",\r\n//   \"#7BDCB5\",\r\n//   \"#b80000\", // reds\r\n//   \"#f50057\",\r\n//   \"#f78da7\",\r\n//   \"#795548\", // brown to yellow\r\n//   \"#FF6900\",\r\n//   \"#FCB900\",\r\n// ];\r\nconst rgbaColor = [\r\n  \"0, 0, 0\", //black to whites\r\n  \"102, 102, 102\",\r\n  \"187, 187, 187\",\r\n  \"255, 255, 255\",\r\n  \"144, 19, 254\", // violets\r\n  \"189, 16, 224\",\r\n  \"63, 81, 181\", //blues\r\n  \"6, 147, 227\",\r\n  \"142, 209, 252\",\r\n  \"0, 128, 128\", // greens\r\n  \"0, 208, 132\",\r\n  \"123, 220, 181\",\r\n  \"184, 0, 0\", // red\r\n  \"245, 0, 87\",\r\n  \"247, 141, 167\",\r\n  \"121, 85, 72\", // brown to yellow\r\n  \"255, 105, 0\",\r\n  \"252, 185, 0\",\r\n];\r\n\r\n// const useStyles = makeStyles((theme: Theme) =>\r\n//   createStyles({\r\n//     root: {\r\n//       \"& > *\": {\r\n//         margin: theme.spacing(1),\r\n//         width: \"25ch\",\r\n//       },\r\n//     },\r\n//   })\r\n// );\r\n\r\nexport const ColorRect = (props: {\r\n  color: React.CSSProperties[\"background\"];\r\n  width?: number;\r\n  height?: number;\r\n  container?: any;\r\n}) => {\r\n  const { color, width = 15, height = 15, container = {} } = props;\r\n  return (\r\n    <div style={{ width: 24, height: 24, boxSizing: \"border-box\", padding: 4, ...container }}>\r\n      <div\r\n        style={{\r\n          border: \"2px solid #000\",\r\n          width: width,\r\n          height: height,\r\n          borderRadius: 3,\r\n          boxSizing: \"border-box\",\r\n          background: color,\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport type ColorpickerProps = {\r\n  color: React.CSSProperties[\"background\"];\r\n  onColorSelected: (color: string) => void;\r\n};\r\nexport const Colorpicker = (props: ColorpickerProps) => {\r\n  const { color, onColorSelected } = props;\r\n  const [Open, setOpen] = React.useState(false);\r\n  const [ColorHover, setColorHover] = React.useState<string | null>(null);\r\n\r\n  const InputRef = React.useRef<HTMLButtonElement>(null);\r\n\r\n  const isHex = /((^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$))/i.test(color as string);\r\n  const hexToRgbRes = !!isHex && typeof color === \"string\" ? hexToRgb(color) : null;\r\n  const isRgb =\r\n    typeof color === \"string\"\r\n      ? (color as string).match(\r\n          /^(rgb)(a?)[(]\\s*([\\d.]+\\s*%?)\\s*,\\s*([\\d.]+\\s*%?)\\s*,\\s*([\\d.]+\\s*%?)\\s*(?:,\\s*([\\d.]+)\\s*)?[)]$/\r\n        )\r\n      : null;\r\n  const isRgba = !!isRgb && 2 in isRgb && isRgb[2] === \"a\";\r\n  const rgbInternal =\r\n    !!isRgb && 3 in isRgb && 4 in isRgb && 5 in isRgb\r\n      ? [parseFloat(isRgb[3]), parseFloat(isRgb[4]), parseFloat(isRgb[5])]\r\n      : isHex && !!hexToRgbRes\r\n      ? [hexToRgbRes.r, hexToRgbRes.g, hexToRgbRes.b]\r\n      : [];\r\n  if (rgbInternal.length === 0) {\r\n    const colorNameRes = colorNameToRGB(color as string);\r\n    if (!!colorNameRes) rgbInternal.push(colorNameRes.r, colorNameRes.g, colorNameRes.b);\r\n  }\r\n\r\n  const alphaProp = !!isRgba && !!isRgb && 6 in isRgb ? parseFloat(isRgb[6]) * 100 : 100;\r\n  const [AlphaVal, setAlphaVal] = React.useState(alphaProp);\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <IconButton\r\n        color=\"primary\"\r\n        style={{ padding: 0 }}\r\n        onClick={() => {\r\n          setOpen(true);\r\n        }}\r\n        ref={InputRef}\r\n      >\r\n        <ColorRect color={color} />\r\n      </IconButton>\r\n      <Popover\r\n        id={\"id\"}\r\n        open={Open}\r\n        anchorEl={InputRef.current}\r\n        onClose={() => {\r\n          setOpen(false);\r\n        }}\r\n        anchorOrigin={{\r\n          vertical: \"bottom\",\r\n          horizontal: \"center\",\r\n        }}\r\n        transformOrigin={{\r\n          vertical: \"top\",\r\n          horizontal: \"center\",\r\n        }}\r\n        style={{ width: 250 + 50 }}\r\n      >\r\n        <Grid\r\n          container\r\n          alignContent=\"center\"\r\n          alignItems=\"center\"\r\n          justify=\"space-evenly\"\r\n          spacing={1}\r\n          style={{ margin: \"10px 15px 10px 15px\", width: 250 }}\r\n        >\r\n          {rgbaColor.map((clr, clrIdx) => (\r\n            <Grid item xs={2} key={clrIdx}>\r\n              <IconButton\r\n                color=\"default\"\r\n                style={{ padding: 0 }}\r\n                onMouseOver={(e) => {\r\n                  setColorHover(`rgba(${rgbaColor[clrIdx]},${AlphaVal})`);\r\n                }}\r\n                onMouseLeave={() => {\r\n                  setColorHover(null);\r\n                }}\r\n                onClick={() => {\r\n                  onColorSelected(\"rgba(\" + rgbaColor[clrIdx] + \",\" + AlphaVal / 100 + \")\");\r\n                  // setOpen(false);\r\n                }}\r\n              >\r\n                <ColorRect\r\n                  color={\"rgba(\" + clr + \",1)\"}\r\n                  width={24}\r\n                  height={24}\r\n                  container={{ width: \"auto\", height: \"auto\" }}\r\n                />\r\n              </IconButton>\r\n            </Grid>\r\n          ))}\r\n          <Grid item xs={3}>\r\n            <Typography>Alpha</Typography>\r\n          </Grid>\r\n          <Grid item xs={6} style={{ padding: \"0px 10px\" }}>\r\n            <Slider\r\n              value={AlphaVal}\r\n              onChange={(e, val) => {\r\n                setAlphaVal(Array.isArray(val) ? val[0] : val);\r\n                onColorSelected(\r\n                  `rgba(${rgbInternal[0]},${rgbInternal[1]},${rgbInternal[2]},${\r\n                    (Array.isArray(val) ? val[0] : val) / 100\r\n                  })`\r\n                );\r\n              }}\r\n            ></Slider>\r\n          </Grid>\r\n          <Grid item xs={3}>\r\n            <TextField\r\n              margin=\"none\"\r\n              variant=\"outlined\"\r\n              size=\"small\"\r\n              inputProps={{ style: { padding: \"5px 5px 5px 10px\" } }}\r\n              value={AlphaVal}\r\n              onChange={(e) => {\r\n                let val = parseInt(e.target.value, 10);\r\n                if (isNaN(val)) val = 0;\r\n                if (val < 0 || val > 100) return;\r\n                setAlphaVal(val);\r\n                onColorSelected(`rgba(${rgbInternal[0]},${rgbInternal[1]},${rgbInternal[2]},${val / 100})`);\r\n              }}\r\n            />\r\n          </Grid>\r\n        </Grid>\r\n        <div style={{ background: \"#bbb\", borderTop: \"1px solid #666\" }}>\r\n          <Grid\r\n            container\r\n            alignItems=\"center\"\r\n            alignContent=\"center\"\r\n            justify=\"center\"\r\n            // spacing={.5}\r\n            style={{\r\n              paddingBottom: 5,\r\n\r\n              // width: \"100%\",\r\n              // padding: \"10px 10px 0px 15px\",\r\n              margin: \"10px 15px 0px 15px\",\r\n              width: 250,\r\n              // textAlign: \"center\",\r\n            }}\r\n            // style={{ margin: \"10px 10px 0px 15px\", width: 250 }}\r\n          >\r\n            <Grid item xs={2}>\r\n              <Typography component=\"div\" align=\"center\">\r\n                R\r\n              </Typography>\r\n            </Grid>\r\n\r\n            <Grid item xs={2}>\r\n              <Typography component=\"div\" align=\"center\">\r\n                G\r\n              </Typography>\r\n            </Grid>\r\n\r\n            <Grid item xs={2}>\r\n              <Typography component=\"div\" align=\"center\">\r\n                B\r\n              </Typography>\r\n            </Grid>\r\n            <Grid item xs={2}>\r\n              <Typography component=\"div\" align=\"center\">\r\n                A\r\n              </Typography>\r\n            </Grid>\r\n\r\n            {/* <Grid item xs={2} style={{ padding: \"5px 0 0 0\" }}>\r\n            <TextField\r\n              value={!!ColorHover ? ColorHover : color}\r\n              margin=\"none\"\r\n              variant=\"outlined\"\r\n              size=\"small\"\r\n              inputProps={{ style: { padding: 5, background: \"#bbb\" } }}\r\n            />\r\n          </Grid> */}\r\n            <Grid item xs={2} />\r\n            <Grid item xs={2}>\r\n              <ColorRect\r\n                color={!!ColorHover ? ColorHover : color}\r\n                width={24}\r\n                height={24}\r\n                container={{ width: \"auto\", height: \"auto\" }}\r\n              />\r\n            </Grid>\r\n          </Grid>\r\n          <Grid\r\n            container\r\n            alignItems=\"center\"\r\n            alignContent=\"center\"\r\n            justify=\"center\"\r\n            // spacing={.5}\r\n            style={{\r\n              paddingBottom: 15,\r\n              // borderTop: \"1px solid #666\",\r\n\r\n              // width: \"100%\",\r\n              // padding: \"10px 10px 0px 15px\",\r\n              paddingLeft: \"15px\",\r\n              // paddingRight: \"0px\",\r\n              // width: \"min-content\",\r\n              // textAlign: \"center\",\r\n            }}\r\n            // style={{ margin: \"10px 10px 0px 15px\", width: 250 }}\r\n          >\r\n            <Grid item xs={2}>\r\n              <TextField\r\n                value={!!rgbInternal ? rgbInternal[0] : color}\r\n                margin=\"none\"\r\n                variant=\"outlined\"\r\n                size=\"small\"\r\n                inputProps={{\r\n                  style: { padding: 5, background: `rgba(184, 0, 0, ${AlphaVal / 100})` },\r\n                }}\r\n              />\r\n            </Grid>\r\n\r\n            <Grid item xs={2}>\r\n              <TextField\r\n                value={!!rgbInternal ? rgbInternal[1] : color}\r\n                margin=\"none\"\r\n                variant=\"outlined\"\r\n                size=\"small\"\r\n                inputProps={{ style: { padding: 5, background: `rgba(0, 208, 132, ${AlphaVal / 100})` } }}\r\n                fullWidth\r\n              />\r\n            </Grid>\r\n            <Grid item xs={2}>\r\n              <TextField\r\n                value={!!rgbInternal ? rgbInternal[2] : color}\r\n                margin=\"none\"\r\n                variant=\"outlined\"\r\n                size=\"small\"\r\n                inputProps={{ style: { padding: 5, background: `rgba(6, 147, 227, ${AlphaVal / 100})` } }}\r\n              />\r\n            </Grid>\r\n            <Grid item xs={2}>\r\n              <TextField\r\n                value={AlphaVal}\r\n                margin=\"none\"\r\n                variant=\"outlined\"\r\n                size=\"small\"\r\n                inputProps={{ style: { padding: 5, background: `#bbb` } }}\r\n              />\r\n            </Grid>\r\n            <Grid item xs={1} />\r\n            <Grid item xs={3}>\r\n              <div style={{ textAlign: \"center\", margin: \"0px auto\" }}>\r\n                {/* <IconButton color=\"primary\" size=\"medium\" style={{ border: \"1px solid #666\", borderRadius: \"50%\", background: \"limegreen\" }}>\r\n                  <Icon path={mdiCheck} size={1} />\r\n                </IconButton> */}\r\n                <Button\r\n                  color=\"primary\"\r\n                  variant=\"outlined\"\r\n                  size=\"small\"\r\n                  style={{ minWidth: 0 }}\r\n                  onClick={() => setOpen(false)}\r\n                >\r\n                  OK\r\n                </Button>\r\n              </div>\r\n            </Grid>\r\n            {/* <Grid item xs={1} />  */}\r\n          </Grid>\r\n        </div>\r\n      </Popover>\r\n    </React.Fragment>\r\n  );\r\n};\r\n","import { Icon } from \"@mdi/react\";\r\nimport { ToggleButton, ToggleButtonGroup, TreeView } from \"@material-ui/lab\";\r\nimport {\r\n  mdiMenuDown,\r\n  mdiMenuRight,\r\n  mdiDiameterVariant,\r\n  mdiChartBellCurve,\r\n  mdiArrowExpandVertical,\r\n  mdiPoll,\r\n  mdiHome,\r\n  mdiFilter,\r\n  mdiMagnify,\r\n  mdiAlphabetical,\r\n  mdiSortAlphabeticalAscending,\r\n  mdiDivingScubaTank,\r\n  mdiBorderColor,\r\n  mdiClose,\r\n  mdiIframeVariableOutline,\r\n} from \"@mdi/js\";\r\nimport React from \"react\";\r\nimport { iSMA, iEMA, iRSI, iMACD, iATR, iVolume, iOBV } from \"../CIndicator\";\r\nimport {\r\n  AdditionalIndicatorGraphStateType,\r\n  CalculatedChartStateType,\r\n  ChartStateHookType,\r\n  isChartGraph,\r\n  isIndicatorGraph,\r\n} from \"../Types/CChartStateTypes\";\r\nimport { ChartDataSeries } from \"../Types/CChartTypes\";\r\nimport { Grid, IconButton, TextField, Typography, useTheme } from \"@material-ui/core\";\r\nimport { CTreeItem } from \"../CTreeItem\";\r\nimport { CChartMenuOpenType } from \"./ChartMenu\";\r\nimport { ReducerActionType } from \"../ChartState/CChartStateReducer\";\r\nimport { Colorpicker } from \"../Colorpicker\";\r\n\r\nconst onIndicatorLabelClick = (\r\n  indi: AdditionalIndicatorGraphStateType[\"indicator\"],\r\n  ChartState: CalculatedChartStateType\r\n) => {\r\n  if (indi.default.newSubchart)\r\n    return () => {\r\n      ChartState.methods.addSubchart(\r\n        ChartState.subCharts[0].yaxis[0].graphs[0].data as ChartDataSeries,\r\n        ChartState.subCharts[0].yaxis[0].graphs[0].name,\r\n        indi\r\n      );\r\n    };\r\n  else\r\n    return () => {\r\n      ChartState.methods.addGraph(\r\n        ChartState.subCharts[0].yaxis[0].graphs[0].data as ChartDataSeries,\r\n        ChartState.subCharts[0].yaxis[0].graphs[0].name,\r\n        0,\r\n        indi\r\n      );\r\n    };\r\n};\r\n\r\nexport const CIndicatorGraphTreeItem = (props: {\r\n  subchartIdx: number;\r\n  yaxisIdx: number;\r\n  graphIdx: number;\r\n  ChartState: CalculatedChartStateType;\r\n  ChartStateDispatch: ChartStateHookType[1];\r\n}) => {\r\n  const { subchartIdx, yaxisIdx, graphIdx, ChartState, ChartStateDispatch } = props;\r\n  const graphGeneric = ChartState.subCharts[subchartIdx].yaxis[yaxisIdx].graphs[graphIdx];\r\n  const graph = isIndicatorGraph(graphGeneric) ? graphGeneric : null;\r\n  const theme = useTheme();\r\n\r\n  if (!graph) return null;\r\n\r\n  return (\r\n    <CTreeItem\r\n      key={`graph-sub-${subchartIdx}-y-${yaxisIdx}-graph-${graphIdx}`}\r\n      nodeId={`graph-sub-${subchartIdx}-y-${yaxisIdx}-graph-${graphIdx}`}\r\n      labelText={graph.name}\r\n      bgColor=\"#eee\"\r\n      labelIcon={\r\n        <div\r\n          style={{\r\n            background: theme.palette.primary.main,\r\n            width: 32,\r\n            height: 32,\r\n            border: \"1px solid #666\",\r\n            borderRadius: 5,\r\n            marginRight: 10,\r\n          }}\r\n        >\r\n          <Icon path={mdiChartBellCurve} size={\"32px\"} color={theme.palette.secondary.contrastText} />\r\n        </div>\r\n      }\r\n      labelInfo={\r\n        subchartIdx !== 0 || graphIdx !== 0 ? (\r\n          <IconButton\r\n            size=\"small\"\r\n            onClick={(e) => {\r\n              e.preventDefault();\r\n              const action: ReducerActionType<\"removeGraph\"> = {\r\n                task: \"removeGraph\",\r\n                params: { subchartIdx, yaxisIdx: 0, graphIdx },\r\n              };\r\n              (ChartStateDispatch as React.Dispatch<ReducerActionType<\"removeGraph\">>)(action);\r\n            }}\r\n          >\r\n            <Icon path={mdiClose} size={1} color=\"#333\" />\r\n          </IconButton>\r\n        ) : undefined\r\n      }\r\n    >\r\n      <CTreeItem\r\n        key={subchartIdx * 1000 + yaxisIdx * 100 + graphIdx}\r\n        nodeId={(subchartIdx * 1000 + yaxisIdx * 100 + graphIdx).toString()}\r\n        labelText=\"line stroke color\"\r\n        labelIcon={<Icon path={mdiBorderColor} size={1} color=\"#333\" />}\r\n        labelInfo={\r\n          <Colorpicker\r\n            color={ChartState.subCharts[subchartIdx].yaxis[0].graphs[graphIdx].style?.strokeColor?.[0]}\r\n            onColorSelected={(color) => {\r\n              const action: ReducerActionType<\"setLineChartStrokeColor\"> = {\r\n                task: \"setLineChartStrokeColor\",\r\n                params: { color: color, subchartIdx, yaxisIdx: 0, graphIdx },\r\n              };\r\n              (ChartStateDispatch as React.Dispatch<ReducerActionType<\"setLineChartStrokeColor\">>)(action);\r\n            }}\r\n          />\r\n        }\r\n      />\r\n      {graph.indicator.params.map((param, paramIdx) => (\r\n        <CTreeItem\r\n          nodeId={`${2 + subchartIdx}00-${graphIdx}-${paramIdx}`}\r\n          labelText={param.name}\r\n          labelIcon={<Icon path={mdiIframeVariableOutline} size={1} color=\"#333\" />}\r\n          labelInfo={\r\n            <TextField\r\n              variant=\"outlined\"\r\n              margin=\"none\"\r\n              size=\"small\"\r\n              inputProps={{ style: { padding: 5, width: 50 } }}\r\n              defaultValue={param.val}\r\n              onChange={(e) => {\r\n                const val = parseFloat(e.target.value);\r\n\r\n                if (isNaN(val)) return;\r\n                const action: ReducerActionType<\"setIndicatorParam\"> = {\r\n                  task: \"setIndicatorParam\",\r\n                  params: { val, subchartIdx, yaxisIdx: 0, graphIdx, paramIdx },\r\n                };\r\n                (ChartStateDispatch as React.Dispatch<ReducerActionType<\"setIndicatorParam\">>)(action);\r\n              }}\r\n            />\r\n          }\r\n        />\r\n      ))}\r\n    </CTreeItem>\r\n  );\r\n};\r\n\r\nexport type IndicatorCategoryType = \"Average\" | \"Oszillator\" | \"Volatility\" | \"Volume\";\r\n\r\nexport const ChartMenuIndicators = (props: {\r\n  ChartState: CalculatedChartStateType;\r\n  onNavigate: (target: CChartMenuOpenType) => void;\r\n  open: CChartMenuOpenType;\r\n  ChartStateDispatch: ChartStateHookType[1];\r\n}) => {\r\n  const { ChartState, onNavigate, open, ChartStateDispatch } = props;\r\n  const theme = useTheme();\r\n  const [FilterCat, setFilterCat] = React.useState(true);\r\n\r\n  const categorys: { name: IndicatorCategoryType; icon: string }[] = [\r\n    { name: \"Average\", icon: mdiDiameterVariant },\r\n    { name: \"Oszillator\", icon: mdiChartBellCurve },\r\n    { name: \"Volatility\", icon: mdiArrowExpandVertical },\r\n    { name: \"Volume\", icon: mdiPoll },\r\n  ];\r\n  const indicators: {\r\n    name: string;\r\n    indicator: AdditionalIndicatorGraphStateType[\"indicator\"];\r\n    category: IndicatorCategoryType;\r\n  }[] = [\r\n    { name: \"SMA\", indicator: iSMA, category: \"Average\" },\r\n    { name: \"EMA\", indicator: iEMA, category: \"Average\" },\r\n    { name: \"RSI\", indicator: iRSI, category: \"Oszillator\" },\r\n    { name: \"MACD\", indicator: iMACD, category: \"Oszillator\" },\r\n    { name: \"ATR\", indicator: iATR, category: \"Volatility\" },\r\n    { name: \"Volume\", indicator: iVolume, category: \"Volume\" },\r\n    { name: \"OBV\", indicator: iOBV, category: \"Volume\" },\r\n  ];\r\n\r\n  const amtIndicators = ChartState.subCharts\r\n    .map((subchart, subIdx) =>\r\n      subchart.yaxis.map((yaxis, yaxixsIdx) => yaxis.graphs.filter((fgraph) => fgraph.type === \"indicator\").length)\r\n    )\r\n    .flat()\r\n    .reduce((acc, cur) => acc + cur);\r\n\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div\r\n        style={{\r\n          position: \"absolute\",\r\n          right: 24, //see padding title bar\r\n          zIndex: 2,\r\n\r\n          // padding\r\n        }}\r\n      >\r\n        {amtIndicators > 0 ? (\r\n          <div style={{ paddingBottom: 5 }}>\r\n            <ToggleButtonGroup value={\"web\"} exclusive style={{ borderRadius: 500 }} size=\"small\">\r\n              <ToggleButton\r\n                // value=\"web\"\r\n                style={{\r\n                  borderBottomLeftRadius: 50,\r\n                  textTransform: \"none\",\r\n                  borderTopLeftRadius: 50,\r\n                  background: open === \"indicators\" ? theme.palette.secondary.light : \"#fff\",\r\n                }}\r\n                onClick={() => {\r\n                  onNavigate?.(\"indicators\");\r\n                }}\r\n              >\r\n                <Typography> Add</Typography>\r\n              </ToggleButton>\r\n              <ToggleButton\r\n                value=\"android\"\r\n                style={{\r\n                  borderBottomRightRadius: 50,\r\n                  borderTopRightRadius: 50,\r\n                  background: open === \"editIndicator\" ? theme.palette.secondary.light : \"#fff\",\r\n                }}\r\n                onClick={() => {\r\n                  onNavigate?.(\"editIndicator\");\r\n                }}\r\n              >\r\n                Edit\r\n              </ToggleButton>\r\n            </ToggleButtonGroup>\r\n          </div>\r\n        ) : null}\r\n        <div\r\n          style={{\r\n            background: theme.palette.secondary.light,\r\n            border: \"1px solid #666\",\r\n            borderRadius: 50,\r\n            padding: 5,\r\n          }}\r\n        >\r\n          <IconButton\r\n            size=\"small\"\r\n            style={{ border: \"1px solid #fff\", margin: \"0px 5px\" }}\r\n            onClick={() => alert(\"upcoming\")}\r\n          >\r\n            <Icon path={mdiMagnify} size={1} color={theme.palette.primary.contrastText} />\r\n          </IconButton>\r\n          <IconButton\r\n            size=\"small\"\r\n            style={{ border: \"1px solid #fff\", margin: \"0px 5px 0px 0px\" }}\r\n            onClick={() => setFilterCat((current) => !current)}\r\n          >\r\n            <Icon\r\n              path={FilterCat ? mdiSortAlphabeticalAscending : mdiFilter}\r\n              size={1}\r\n              color={theme.palette.primary.contrastText}\r\n            />\r\n          </IconButton>\r\n        </div>\r\n      </div>\r\n\r\n      <TreeView\r\n        //   className={classes.root}\r\n        //   defaultExpanded={[\"3\"]}\r\n        defaultCollapseIcon={<Icon path={mdiMenuDown} size={1} color=\"#333\" />}\r\n        defaultExpandIcon={<Icon path={mdiMenuRight} size={1} color=\"#333\" />}\r\n        defaultEndIcon={<div style={{ width: 24 }} />}\r\n        //   selected=\"1\"\r\n        //   onNodeSelect={() => {}}\r\n        disableSelection\r\n        // style={{height: 100, overflowY: \"scroll\"}}\r\n      >\r\n        {open === \"editIndicator\"\r\n          ? ChartState.subCharts.map((subchart, subchartIdx) =>\r\n              subchart.yaxis.map((yaxis, yaxisIdx) =>\r\n                yaxis.graphs.map((graph, graphIdx) =>\r\n                  isIndicatorGraph(graph) ? (\r\n                    <CIndicatorGraphTreeItem\r\n                      key={`editIndicator-sub-${subchartIdx}-yaxis-${yaxisIdx}-graph-${graphIdx}`}\r\n                      ChartState={ChartState}\r\n                      ChartStateDispatch={ChartStateDispatch}\r\n                      subchartIdx={subchartIdx}\r\n                      yaxisIdx={yaxisIdx}\r\n                      graphIdx={graphIdx}\r\n                    />\r\n                  ) : null\r\n                )\r\n              )\r\n            )\r\n          : !!FilterCat\r\n          ? categorys.map((cat, catIdx) => (\r\n              <CTreeItem\r\n                key={`cat-${catIdx}`}\r\n                nodeId={catIdx.toString()}\r\n                labelText={cat.name}\r\n                labelIcon={\r\n                  <div\r\n                    style={{\r\n                      border: \"1px solid #666\",\r\n                      borderRadius: 5,\r\n                      marginRight: 10,\r\n                      background: theme.palette.secondary.main,\r\n                      minWidth: 48,\r\n                      height: 48,\r\n                    }}\r\n                  >\r\n                    <Icon path={cat.icon} size={2} color={theme.palette.secondary.contrastText} />\r\n                  </div>\r\n                }\r\n                bgColor={theme.palette.primary.light}\r\n              >\r\n                {indicators\r\n                  .filter((indi) => indi.category === cat.name)\r\n                  .sort((a, b) => (a.name > b.name ? 1 : -1))\r\n                  .map((indi, indiIdx) => (\r\n                    <CTreeItem\r\n                      key={`cat-${catIdx}-indi-${indiIdx}`}\r\n                      nodeId={((catIdx + 1) * 100 + (indiIdx + 1)).toString()}\r\n                      labelText={indi.name}\r\n                      //   labelIcon={<Icon path={mdiFileChartOutline} size={1} color=\"#333\" />}\r\n                      bgColor={theme.palette.primary.light}\r\n                      onLabelClick={onIndicatorLabelClick(indi.indicator, ChartState)}\r\n                    />\r\n                  ))}\r\n              </CTreeItem>\r\n            ))\r\n          : indicators\r\n              .sort((a, b) => (a.name > b.name ? 1 : -1))\r\n              .map((indi, indiIdx) => (\r\n                <CTreeItem\r\n                  key={`cat-indi-${indiIdx}`}\r\n                  nodeId={(indiIdx + 1).toString()}\r\n                  labelText={indi.name}\r\n                  //   labelIcon={<Icon path={mdiFileChartOutline} size={1} color=\"#333\" />}\r\n                  bgColor={theme.palette.primary.light}\r\n                  onLabelClick={onIndicatorLabelClick(indi.indicator, ChartState)}\r\n                />\r\n              ))}\r\n      </TreeView>\r\n    </React.Fragment>\r\n  );\r\n};\r\n","import { Icon } from \"@mdi/react\";\r\nimport { ToggleButton, ToggleButtonGroup, TreeView } from \"@material-ui/lab\";\r\nimport {\r\n  mdiMenuDown,\r\n  mdiMenuRight,\r\n  mdiDiameterVariant,\r\n  mdiChartBellCurve,\r\n  mdiArrowExpandVertical,\r\n  mdiPoll,\r\n  mdiHome,\r\n  mdiFilter,\r\n  mdiMagnify,\r\n  mdiAlphabetical,\r\n  mdiSortAlphabeticalAscending,\r\n  mdiRuler,\r\n  mdiRulerSquareCompass,\r\n  mdiArrowSplitHorizontal,\r\n  mdiBorderColor,\r\n  mdiBullseye,\r\n  mdiHelp,\r\n  mdiMinus,\r\n} from \"@mdi/js\";\r\nimport React from \"react\";\r\n\r\nimport { CalculatedChartStateType, ChartStateHookType } from \"../Types/CChartStateTypes\";\r\nimport { ChartDataSeries } from \"../Types/CChartTypes\";\r\nimport { Grid, IconButton, TextField, Typography, useTheme } from \"@material-ui/core\";\r\nimport { CTreeItem } from \"../CTreeItem\";\r\nimport { ReducerActionType } from \"../ChartState/CChartStateReducer\";\r\nimport { Colorpicker } from \"../Colorpicker\";\r\nimport { CChartMenuOpenType } from \"./ChartMenu\";\r\n\r\nconst onToolLabelClick = (\r\n  ChartStateDispatch: ChartStateHookType[1],\r\n  type: NonNullable<CalculatedChartStateType[\"draw\"][\"type\"]>\r\n) => {\r\n  const subchartIdx = 0;\r\n  const action: ReducerActionType<\"draw\"> = { task: \"draw\", params: { type, subchartIdx } };\r\n  \r\n    (ChartStateDispatch as React.Dispatch<ReducerActionType<\"draw\">>)(action);\r\n  \r\n};\r\n\r\nexport const CToolTreeItem = (props: {\r\n  subchartIdx: number;\r\n  yaxisIdx: number;\r\n  toolIdx: number;\r\n  ChartState: CalculatedChartStateType;\r\n  ChartStateDispatch: ChartStateHookType[1];\r\n}) => {\r\n  const { subchartIdx, yaxisIdx, toolIdx, ChartState, ChartStateDispatch } = props;\r\n  const toolIn = ChartState.subCharts?.[subchartIdx]?.yaxis?.[yaxisIdx]?.tools?.[toolIdx];\r\n  const tool = !!toolIn ? toolIn : null;\r\n  if (!tool) return null;\r\n\r\n  return (\r\n    <CTreeItem\r\n      key={`tool-${toolIdx}`}\r\n      nodeId={`tool-${subchartIdx}-${toolIdx}`}\r\n      labelText={\r\n        tool.type === \"hline\"\r\n          ? \"horizontal line\"\r\n          : tool.type === \"vline\"\r\n          ? \"vertical line\"\r\n          : tool.type === \"trendline\"\r\n          ? \"Trendline\"\r\n          : \"Tool\"\r\n      }\r\n      labelIcon={\r\n        <Icon\r\n          path={tool.type === \"hline\" || tool.type === \"vline\" || tool.type === \"trendline\" ? mdiMinus : mdiHelp}\r\n          size={1}\r\n          color=\"#333\"\r\n          rotate={tool.type === \"trendline\" ? -45 : tool.type === \"vline\" ? 90 : 0}\r\n        />\r\n      }\r\n    >\r\n      {tool.type === \"hline\" ? (\r\n        <CTreeItem\r\n          key={`tool-${subchartIdx}-y0-${toolIdx}-hlinelevel`}\r\n          nodeId={`tool-${subchartIdx}-y0-${toolIdx}-hlinelevel`}\r\n          labelText={\"Y-Level\"}\r\n          labelIcon={<Icon path={mdiArrowSplitHorizontal} size={1} color=\"#333\" />}\r\n          labelInfo={\r\n            <TextField\r\n              variant=\"outlined\"\r\n              margin=\"none\"\r\n              size=\"small\"\r\n              inputProps={{ style: { padding: 5, width: 50 } }}\r\n              defaultValue={tool.xy[0][1]}\r\n              onChange={(e) => {\r\n                const val = parseFloat(e.target.value);\r\n                if (isNaN(val)) return;\r\n                const action: ReducerActionType<\"setHlineYlevel\"> = {\r\n                  task: \"setHlineYlevel\",\r\n                  params: { val, subchartIdx, yaxisIdx: 0, toolIdx },\r\n                };\r\n                (ChartStateDispatch as React.Dispatch<ReducerActionType<\"setHlineYlevel\">>)(action);\r\n              }}\r\n            />\r\n          }\r\n        />\r\n      ) : null}\r\n      <CTreeItem\r\n        key={`tool-${subchartIdx}-${toolIdx}-stroke`}\r\n        nodeId={`tool-${subchartIdx}-${toolIdx}-stroke`}\r\n        labelText={\"stroke color\"}\r\n        labelIcon={<Icon path={mdiBorderColor} size={1} color=\"#333\" />}\r\n        labelInfo={\r\n          <Colorpicker\r\n            color={tool.style.strokeColor}\r\n            onColorSelected={(color) => {\r\n              const action: ReducerActionType<\"setToolStrokeColor\"> = {\r\n                task: \"setToolStrokeColor\",\r\n                params: { color: color, subchartIdx, yaxisIdx: 0, toolIdx },\r\n              };\r\n              (ChartStateDispatch as React.Dispatch<ReducerActionType<\"setToolStrokeColor\">>)(action);\r\n            }}\r\n          />\r\n        }\r\n      />\r\n      <CTreeItem\r\n        key={`tool-${subchartIdx}-${toolIdx}-anchorColor`}\r\n        nodeId={`tool-${subchartIdx}-${toolIdx}-anchorColor`}\r\n        labelText={\"anchor color\"}\r\n        labelIcon={<Icon path={mdiBullseye} size={1} color=\"#333\" />}\r\n        labelInfo={\r\n          <Colorpicker\r\n            color={tool.style.anchorColor}\r\n            onColorSelected={(color) => {\r\n              const action: ReducerActionType<\"setToolAnchorColor\"> = {\r\n                task: \"setToolAnchorColor\",\r\n                params: { color: color, subchartIdx, yaxisIdx: 0, toolIdx },\r\n              };\r\n              (ChartStateDispatch as React.Dispatch<ReducerActionType<\"setToolAnchorColor\">>)(action);\r\n            }}\r\n          />\r\n        }\r\n      />\r\n    </CTreeItem>\r\n  );\r\n};\r\n\r\nexport type ToolCategoryType = \"Lines\" | \"Upcoming\";\r\n\r\nexport const ChartMenuTools = (props: {\r\n  ChartState: CalculatedChartStateType;\r\n  onNavigate: (target: CChartMenuOpenType) => void;\r\n  ChartStateDispatch: ChartStateHookType[1];\r\n  open: CChartMenuOpenType;\r\n}) => {\r\n  const { ChartState, onNavigate, ChartStateDispatch, open } = props;\r\n  const theme = useTheme();\r\n  const [FilterCat, setFilterCat] = React.useState(true);\r\n\r\n  const categorys: { name: ToolCategoryType; icon: string }[] = [\r\n    { name: \"Lines\", icon: mdiRuler },\r\n    { name: \"Upcoming\", icon: mdiRulerSquareCompass },\r\n  ];\r\n  const tools: {\r\n    name: string;\r\n    type: NonNullable<CalculatedChartStateType[\"draw\"][\"type\"]>;\r\n    category: ToolCategoryType;\r\n  }[] = [\r\n    { name: \"trendline\", type: \"trendline\", category: \"Lines\" },\r\n    { name: \"horizontal\", type: \"hline\", category: \"Lines\" },\r\n    { name: \"vertical\", type: \"vline\", category: \"Lines\" },\r\n  ];\r\n\r\n  const amtTools = ChartState.subCharts\r\n    .map((subchart) => subchart.yaxis.map((yaxis) => yaxis.tools.length))\r\n    .flat()\r\n    .reduce((acc, cur) => acc + cur);\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div\r\n        style={{\r\n          position: \"absolute\",\r\n          right: 24, //see padding title bar\r\n          zIndex: 2,\r\n\r\n          // padding\r\n        }}\r\n      >\r\n        {amtTools > 0 ? (\r\n          <div style={{ paddingBottom: 5 }}>\r\n            <ToggleButtonGroup value={\"web\"} exclusive style={{ borderRadius: 500 }} size=\"small\">\r\n              <ToggleButton\r\n                style={{\r\n                  borderBottomLeftRadius: 50,\r\n                  textTransform: \"none\",\r\n                  borderTopLeftRadius: 50,\r\n                  background: open === \"tools\" ? theme.palette.secondary.light : \"#fff\",\r\n                }}\r\n                onClick={() => {\r\n                  onNavigate?.(\"tools\");\r\n                }}\r\n              >\r\n                <Typography> Add</Typography>\r\n              </ToggleButton>\r\n              <ToggleButton\r\n                value=\"android\"\r\n                style={{\r\n                  borderBottomRightRadius: 50,\r\n                  borderTopRightRadius: 50,\r\n                  background: open === \"editTool\" ? theme.palette.secondary.light : \"#fff\",\r\n                }}\r\n                onClick={() => {\r\n                  onNavigate?.(\"editTool\");\r\n                }}\r\n              >\r\n                Edit\r\n              </ToggleButton>\r\n            </ToggleButtonGroup>\r\n          </div>\r\n        ) : null}\r\n\r\n        <div\r\n          style={{ background: theme.palette.secondary.light, border: \"1px solid #666\", borderRadius: 50, padding: 5 }}\r\n        >\r\n          <IconButton\r\n            size=\"small\"\r\n            style={{ border: \"1px solid #fff\", margin: \"0px 5px\" }}\r\n            onClick={() => alert(\"upcoming\")}\r\n          >\r\n            <Icon path={mdiMagnify} size={1} color={theme.palette.primary.contrastText} />\r\n          </IconButton>\r\n          <IconButton\r\n            size=\"small\"\r\n            style={{ border: \"1px solid #fff\", margin: \"0px 5px 0px 0px\" }}\r\n            onClick={() => setFilterCat((current) => !current)}\r\n          >\r\n            <Icon\r\n              path={FilterCat ? mdiSortAlphabeticalAscending : mdiFilter}\r\n              size={1}\r\n              color={theme.palette.primary.contrastText}\r\n            />\r\n          </IconButton>\r\n        </div>\r\n      </div>\r\n      <TreeView\r\n        //   className={classes.root}\r\n        //   defaultExpanded={[\"3\"]}\r\n        defaultCollapseIcon={<Icon path={mdiMenuDown} size={1} color=\"#333\" />}\r\n        defaultExpandIcon={<Icon path={mdiMenuRight} size={1} color=\"#333\" />}\r\n        defaultEndIcon={<div style={{ width: 24 }} />}\r\n        //   selected=\"1\"\r\n        //   onNodeSelect={() => {}}\r\n        disableSelection\r\n        // style={{height: 100, overflowY: \"scroll\"}}\r\n      >\r\n        {open === \"editTool\"\r\n          ? ChartState.subCharts.map((subchart, subchartIdx) =>\r\n              subchart.yaxis.map((yaxis, yaxisIdx) =>\r\n                yaxis.tools.map((tool, toolIdx) => (\r\n                  <CToolTreeItem\r\n                    key={`editIndicator-sub-${subchartIdx}-yaxis-${yaxisIdx}-graph-${toolIdx}`}\r\n                    ChartState={ChartState}\r\n                    ChartStateDispatch={ChartStateDispatch}\r\n                    subchartIdx={subchartIdx}\r\n                    yaxisIdx={yaxisIdx}\r\n                    toolIdx={toolIdx}\r\n                  />\r\n                ))\r\n              )\r\n            )\r\n          : !!FilterCat\r\n          ? categorys.map((cat, catIdx) => (\r\n              <CTreeItem\r\n                key={`cat-${catIdx}`}\r\n                nodeId={catIdx.toString()}\r\n                labelText={cat.name}\r\n                labelIcon={\r\n                  <div\r\n                    style={{\r\n                      border: \"1px solid #666\",\r\n                      borderRadius: 5,\r\n                      marginRight: 10,\r\n                      background: theme.palette.secondary.main,\r\n                      minWidth: 48,\r\n                      height: 48,\r\n                    }}\r\n                  >\r\n                    <Icon path={cat.icon} size={2} color={theme.palette.secondary.contrastText} />\r\n                  </div>\r\n                }\r\n                bgColor={theme.palette.primary.light}\r\n              >\r\n                {tools\r\n                  .filter((tool) => tool.category === cat.name)\r\n                  .sort((a, b) => (a.name > b.name ? 1 : -1))\r\n                  .map((tool, toolIdx) => (\r\n                    <CTreeItem\r\n                      key={`cat-${catIdx}-tool-${toolIdx}`}\r\n                      nodeId={((catIdx + 1) * 100 + (toolIdx + 1)).toString()}\r\n                      labelText={tool.name}\r\n                      //   labelIcon={<Icon path={mdiFileChartOutline} size={1} color=\"#333\" />}\r\n                      bgColor={theme.palette.primary.light}\r\n                      onLabelClick={() => {\r\n                        onToolLabelClick(ChartStateDispatch, tool.type);\r\n                        onNavigate?.(null);\r\n                      }}\r\n                    />\r\n                  ))}\r\n              </CTreeItem>\r\n            ))\r\n          : tools\r\n              .sort((a, b) => (a.name > b.name ? 1 : -1))\r\n              .map((tool, toolIdx) => (\r\n                <CTreeItem\r\n                  key={`cat-tool-${toolIdx}`}\r\n                  nodeId={(toolIdx + 1).toString()}\r\n                  labelText={tool.name}\r\n                  //   labelIcon={<Icon path={mdiFileChartOutline} size={1} color=\"#333\" />}\r\n                  bgColor={theme.palette.primary.light}\r\n                  onLabelClick={() => {\r\n                    onToolLabelClick(ChartStateDispatch, tool.type);\r\n                    onNavigate?.(null);\r\n                  }}\r\n                />\r\n              ))}\r\n      </TreeView>\r\n    </React.Fragment>\r\n  );\r\n};\r\n","import { Icon } from \"@mdi/react\";\r\nimport { ToggleButton, ToggleButtonGroup, TreeView } from \"@material-ui/lab\";\r\nimport {\r\n  mdiMenuDown,\r\n  mdiMenuRight,\r\n  mdiDiameterVariant,\r\n  mdiChartBellCurve,\r\n  mdiArrowExpandVertical,\r\n  mdiPoll,\r\n  mdiHome,\r\n  mdiFilter,\r\n  mdiMagnify,\r\n  mdiAlphabetical,\r\n  mdiSortAlphabeticalAscending,\r\n  mdiRuler,\r\n  mdiRulerSquareCompass,\r\n  mdiFileChartOutline,\r\n  mdiWater,\r\n  mdiArrowSplitHorizontal,\r\n  mdiBorderColor,\r\n  mdiBullseye,\r\n  mdiChartAreaspline,\r\n  mdiChartLine,\r\n  mdiClose,\r\n  mdiFormatText,\r\n  mdiGrid,\r\n  mdiHelp,\r\n  mdiIframeVariableOutline,\r\n  mdiMinus,\r\n  mdiPencilRuler,\r\n} from \"@mdi/js\";\r\nimport React from \"react\";\r\n\r\nimport {\r\n  CalculatedChartStateType,\r\n  ChartStateHookType,\r\n  isChartGraph,\r\n  isIndicatorGraph,\r\n} from \"../Types/CChartStateTypes\";\r\nimport { ChartDataSeries } from \"../Types/CChartTypes\";\r\nimport { Button, Checkbox, Grid, IconButton, Menu, MenuItem, TextField, Typography, useTheme } from \"@material-ui/core\";\r\nimport { CTreeItem } from \"../CTreeItem\";\r\nimport { ReducerActionType } from \"../ChartState/CChartStateReducer\";\r\nimport { Colorpicker } from \"../Colorpicker\";\r\nimport { CChartMenuOpenType } from \"./ChartMenu\";\r\nimport { CIndicatorGraphTreeItem } from \"./ChartMenuIndicators\";\r\nimport { CToolTreeItem } from \"./ChartMenuTools\";\r\n\r\nconst onToolLabelClick = (\r\n  ChartStateDispatch: ChartStateHookType[1],\r\n  type: NonNullable<CalculatedChartStateType[\"draw\"][\"type\"]>\r\n) => {\r\n  const subchartIdx = 0;\r\n  const action: ReducerActionType<\"draw\"> = { task: \"draw\", params: { type, subchartIdx } };\r\n  return () => {\r\n    (ChartStateDispatch as React.Dispatch<ReducerActionType<\"draw\">>)(action);\r\n  };\r\n};\r\n\r\nexport type ToolCategoryType = \"Lines\" | \"Upcoming\";\r\n\r\nexport const ChartMenuSettings = (props: {\r\n  ChartState: CalculatedChartStateType;\r\n  onNavigate: (target: CChartMenuOpenType) => void;\r\n  ChartStateDispatch: ChartStateHookType[1];\r\n}) => {\r\n  const { ChartState, onNavigate, ChartStateDispatch } = props;\r\n  const theme = useTheme();\r\n  const [FilterCat, setFilterCat] = React.useState(false);\r\n  const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\r\n\r\n  const handleClick = (event: React.MouseEvent<HTMLButtonElement>) => {\r\n    setAnchorEl(event.currentTarget);\r\n  };\r\n\r\n  const handleClose = (target?: CChartMenuOpenType) => {\r\n    setAnchorEl(null);\r\n    if (!!target) onNavigate?.(target);\r\n  };\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div\r\n        style={{\r\n          position: \"absolute\",\r\n          right: 24, //see padding title bar\r\n          zIndex: 2,\r\n\r\n          // padding\r\n        }}\r\n      >\r\n        {/* <div\r\n          style={{\r\n            background: theme.palette.secondary.light,\r\n            border: \"1px solid #666\",\r\n            borderRadius: 50,\r\n            padding: 5,\r\n          }}\r\n        >\r\n          <IconButton\r\n            size=\"small\"\r\n            style={{ border: \"1px solid #fff\", margin: \"0px 5px\" }}\r\n            // onClick={() => onNavigate(\"menu\")}\r\n          >\r\n            <Icon path={mdiMagnify} size={1} color={theme.palette.primary.contrastText} />\r\n          </IconButton>\r\n          <IconButton\r\n            size=\"small\"\r\n            style={{ border: \"1px solid #fff\", margin: \"0px 5px 0px 0px\" }}\r\n            onClick={() => setFilterCat((current) => !current)}\r\n          >\r\n            <Icon\r\n              path={FilterCat ? mdiSortAlphabeticalAscending : mdiFilter}\r\n              size={1}\r\n              color={theme.palette.primary.contrastText}\r\n            />\r\n          </IconButton>\r\n        </div> */}\r\n        <div style={{ paddingBottom: 5 }}>\r\n          <Button\r\n            // value=\"web\"\r\n            style={{\r\n              border: \"1px solid #666\",\r\n              borderRadius: 50,\r\n              padding: 5,\r\n              // marginTop: 5,\r\n              textTransform: \"none\",\r\n              background: theme.palette.secondary.light,\r\n              width: \"100%\",\r\n              color: theme.palette.secondary.contrastText,\r\n            }}\r\n            onClick={handleClick}\r\n          >\r\n            <Typography> Add...</Typography>\r\n          </Button>\r\n          <Menu\r\n            id=\"quick-add\"\r\n            anchorEl={anchorEl}\r\n            keepMounted\r\n            open={Boolean(anchorEl)}\r\n            onClose={() => handleClose(undefined)}\r\n            anchorOrigin={{\r\n              vertical: \"top\",\r\n              horizontal: \"center\",\r\n            }}\r\n            transformOrigin={{\r\n              vertical: \"bottom\",\r\n              horizontal: \"center\",\r\n            }}\r\n          >\r\n            <MenuItem onClick={() => handleClose(\"indicators\")}>Indicator</MenuItem>\r\n            <MenuItem onClick={() => handleClose(\"tools\")}>Tool</MenuItem>\r\n            {/* <MenuItem onClick={handleClose}></MenuItem> */}\r\n          </Menu>\r\n        </div>\r\n      </div>\r\n\r\n      <TreeView\r\n        //   className={classes.root}\r\n        //   defaultExpanded={[\"3\"]}\r\n        defaultCollapseIcon={<Icon path={mdiMenuDown} size={1} color=\"#333\" />}\r\n        defaultExpandIcon={<Icon path={mdiMenuRight} size={1} color=\"#333\" />}\r\n        defaultEndIcon={<div style={{ width: 24 }} />}\r\n        //   selected=\"1\"\r\n        //   onNodeSelect={() => {}}\r\n        disableSelection\r\n        // style={{height: 100, overflowY: \"scroll\"}}\r\n      >\r\n        <CTreeItem\r\n          nodeId=\"1\"\r\n          labelText=\"General\"\r\n          labelIcon={\r\n            <div\r\n              style={{\r\n                background: theme.palette.secondary.main,\r\n                width: 48,\r\n                height: 48,\r\n                border: \"1px solid #666\",\r\n                borderRadius: 5,\r\n                marginRight: 10,\r\n              }}\r\n            >\r\n              <Icon path={mdiFileChartOutline} size={2} color={theme.palette.secondary.contrastText} />\r\n            </div>\r\n          }\r\n          bgColor={theme.palette.primary.light}\r\n          labelTypographyVariant=\"h6\"\r\n        >\r\n          <CTreeItem\r\n            nodeId=\"11\"\r\n            labelText=\"background color\"\r\n            labelIcon={<Icon path={mdiWater} size={1} color=\"#333\" />}\r\n            labelInfo={\r\n              <Colorpicker\r\n                color={ChartState.backgroundColor}\r\n                onColorSelected={(color) => {\r\n                  // const action: ReducerActionType<\"setBackgroundColor\"> = {\r\n                  //   task: \"setBackgroundColor\",\r\n                  //   params: { color: color },\r\n                  // };\r\n                  ChartStateDispatch({\r\n                    task: \"setBackgroundColor\",\r\n                    params: { color },\r\n                  } as ReducerActionType<\"setBackgroundColor\">);\r\n                }}\r\n              />\r\n            }\r\n            //   color=\"#fff\"\r\n            bgColor=\"#eee\"\r\n          />\r\n          <CTreeItem\r\n            nodeId=\"12\"\r\n            labelText=\"axis fill color\"\r\n            labelIcon={<Icon path={mdiWater} size={1} color=\"#333\" />}\r\n            labelInfo={\r\n              <Colorpicker\r\n                color={ChartState.xaxis.style.fillColor}\r\n                onColorSelected={(color) => {\r\n                  const action: ReducerActionType<\"setAxisFillColor\"> = {\r\n                    task: \"setAxisFillColor\",\r\n                    params: { color: color },\r\n                  };\r\n                  (ChartStateDispatch as React.Dispatch<ReducerActionType<\"setAxisFillColor\">>)(action);\r\n                }}\r\n              />\r\n            }\r\n            //   color=\"#e3742f\"\r\n            bgColor=\"#eee\"\r\n          />\r\n          <CTreeItem\r\n            nodeId=\"13\"\r\n            labelText=\"axis stroke color\"\r\n            labelIcon={<Icon path={mdiBorderColor} size={1} color=\"#333\" />}\r\n            labelInfo={\r\n              <Colorpicker\r\n                color={ChartState.xaxis.style.strokeColor}\r\n                onColorSelected={(color) => {\r\n                  const action: ReducerActionType<\"setAxisStrokeColor\"> = {\r\n                    task: \"setAxisStrokeColor\",\r\n                    params: { color: color },\r\n                  };\r\n                  (ChartStateDispatch as React.Dispatch<ReducerActionType<\"setAxisStrokeColor\">>)(action);\r\n                }}\r\n              />\r\n            }\r\n            //   color=\"#a250f5\"\r\n            bgColor=\"#eee\"\r\n          />\r\n          <CTreeItem\r\n            nodeId=\"14\"\r\n            labelText=\"axis text color\"\r\n            labelIcon={<Icon path={mdiFormatText} size={1} color=\"#333\" />}\r\n            labelInfo={\r\n              <Colorpicker\r\n                color={ChartState.xaxis.style.fontColor}\r\n                onColorSelected={(color) => {\r\n                  const action: ReducerActionType<\"setAxisTextColor\"> = {\r\n                    task: \"setAxisTextColor\",\r\n                    params: { color: color },\r\n                  };\r\n                  (ChartStateDispatch as React.Dispatch<ReducerActionType<\"setAxisTextColor\">>)(action);\r\n                }}\r\n              />\r\n            }\r\n            color=\"#3c8039\"\r\n            bgColor=\"#eee\"\r\n          />\r\n          <CTreeItem\r\n            nodeId=\"15\"\r\n            labelText=\"use x-axis grid\"\r\n            labelIcon={<Icon path={mdiGrid} size={1} color=\"#333\" />}\r\n            labelInfo={\r\n              <Checkbox\r\n                checked={ChartState.grid.useGridX}\r\n                size=\"small\"\r\n                style={{ padding: 0, width: 24, height: 24 }}\r\n                onChange={() => {\r\n                  const action: ReducerActionType<\"toggleXaxisGrid\"> = {\r\n                    task: \"toggleXaxisGrid\",\r\n                    params: {},\r\n                  };\r\n                  (ChartStateDispatch as React.Dispatch<ReducerActionType<\"toggleXaxisGrid\">>)(action);\r\n                }}\r\n              />\r\n            }\r\n            color=\"#3c8039\"\r\n            bgColor=\"#eee\"\r\n          />\r\n          <CTreeItem\r\n            nodeId=\"16\"\r\n            labelText=\"use y-axis grid\"\r\n            labelIcon={<Icon path={mdiGrid} size={1} color=\"#333\" />}\r\n            labelInfo={\r\n              <Checkbox\r\n                checked={ChartState.grid.useGridY}\r\n                size=\"small\"\r\n                style={{ padding: 0, width: 24, height: 24 }}\r\n                onChange={() => {\r\n                  const action: ReducerActionType<\"toggleYaxisGrid\"> = {\r\n                    task: \"toggleYaxisGrid\",\r\n                    params: {},\r\n                  };\r\n                  (ChartStateDispatch as React.Dispatch<ReducerActionType<\"toggleYaxisGrid\">>)(action);\r\n                }}\r\n              />\r\n            }\r\n            color=\"#3c8039\"\r\n            bgColor=\"#eee\"\r\n          />\r\n          <CTreeItem\r\n            nodeId=\"17\"\r\n            labelText=\"grid stroke color\"\r\n            labelIcon={<Icon path={mdiBorderColor} size={1} color=\"#333\" />}\r\n            labelInfo={\r\n              <Colorpicker\r\n                color={ChartState.grid.style.strokeColor}\r\n                onColorSelected={(color) => {\r\n                  const action: ReducerActionType<\"setGridStrokeColor\"> = {\r\n                    task: \"setGridStrokeColor\",\r\n                    params: { color: color },\r\n                  };\r\n                  (ChartStateDispatch as React.Dispatch<ReducerActionType<\"setGridStrokeColor\">>)(action);\r\n                }}\r\n              />\r\n            }\r\n            color=\"#3c8039\"\r\n            bgColor=\"#eee\"\r\n          />\r\n        </CTreeItem>\r\n\r\n        {ChartState.subCharts.map((subchart, subchartIdx) => (\r\n          <CTreeItem\r\n            labelTypographyVariant=\"h6\"\r\n            key={`sub-${subchartIdx}`}\r\n            nodeId={`sub-${2 + subchartIdx}`}\r\n            labelText={subchartIdx === 0 ? \"Mainchart\" : `Subchart ${subchartIdx}`}\r\n            bgColor={theme.palette.primary.light}\r\n            labelIcon={\r\n              <div\r\n                style={{\r\n                  background: theme.palette.secondary.main,\r\n                  width: 48,\r\n                  height: 48,\r\n                  border: \"1px solid #666\",\r\n                  borderRadius: 5,\r\n                  marginRight: 10,\r\n                }}\r\n              >\r\n                <Icon path={mdiChartAreaspline} size={2} color={theme.palette.secondary.contrastText} />\r\n              </div>\r\n            }\r\n            labelInfo={\r\n              subchartIdx !== 0 ? (\r\n                <IconButton\r\n                  size=\"small\"\r\n                  onClick={(e) => {\r\n                    e.preventDefault();\r\n                    const action: ReducerActionType<\"removeSubchart\"> = {\r\n                      task: \"removeSubchart\",\r\n                      params: { subchartIdx },\r\n                    };\r\n                    (ChartStateDispatch as React.Dispatch<ReducerActionType<\"removeSubchart\">>)(action);\r\n                  }}\r\n                >\r\n                  <Icon path={mdiClose} size={1} color=\"#333\" />\r\n                </IconButton>\r\n              ) : undefined\r\n            }\r\n          >\r\n            {subchart.yaxis[0].graphs.map((graph, graphIdx) =>\r\n              isIndicatorGraph(graph) ? (\r\n                <CIndicatorGraphTreeItem\r\n                  key={`editIndicator-sub-${subchartIdx}-yaxis-${0}-graph-${graphIdx}`}\r\n                  ChartState={ChartState}\r\n                  ChartStateDispatch={ChartStateDispatch}\r\n                  subchartIdx={subchartIdx}\r\n                  yaxisIdx={0}\r\n                  graphIdx={graphIdx}\r\n                />\r\n              ) : isChartGraph(graph) ? (\r\n                <React.Fragment>\r\n                  <CTreeItem\r\n                    key={`graph-sub-${subchartIdx}-yaxis-${0}-graph-${graphIdx}`}\r\n                    nodeId={`graph-sub-${subchartIdx}-yaxis-${0}-graph-${graphIdx}`}\r\n                    labelText={graph.name}\r\n                    bgColor=\"#eee\"\r\n                    labelIcon={\r\n                      <div\r\n                        style={{\r\n                          background: theme.palette.primary.main,\r\n                          width: 32,\r\n                          height: 32,\r\n                          border: \"1px solid #666\",\r\n                          borderRadius: 5,\r\n                          marginRight: 10,\r\n                        }}\r\n                      >\r\n                        <Icon path={mdiChartLine} size={\"32px\"} color={theme.palette.secondary.contrastText} />\r\n                      </div>\r\n                    }\r\n                    labelInfo={\r\n                      subchartIdx !== 0 || graphIdx !== 0 ? (\r\n                        <IconButton\r\n                          size=\"small\"\r\n                          onClick={(e) => {\r\n                            e.preventDefault();\r\n                            const action: ReducerActionType<\"removeGraph\"> = {\r\n                              task: \"removeGraph\",\r\n                              params: { subchartIdx, yaxisIdx: 0, graphIdx },\r\n                            };\r\n                            (ChartStateDispatch as React.Dispatch<ReducerActionType<\"removeGraph\">>)(action);\r\n                          }}\r\n                        >\r\n                          <Icon path={mdiClose} size={1} color=\"#333\" />\r\n                        </IconButton>\r\n                      ) : undefined\r\n                    }\r\n                  >\r\n                    {graph.meta.type === \"linechart\" ? (\r\n                      <CTreeItem\r\n                        nodeId={`${2 + subchartIdx}00-${graphIdx}`}\r\n                        labelText=\"line stroke color\"\r\n                        labelIcon={<Icon path={mdiBorderColor} size={1} color=\"#333\" />}\r\n                        labelInfo={\r\n                          <Colorpicker\r\n                            color={ChartState.subCharts[subchartIdx].yaxis[0].graphs[graphIdx].style?.strokeColor?.[0]}\r\n                            onColorSelected={(color) => {\r\n                              const action: ReducerActionType<\"setLineChartStrokeColor\"> = {\r\n                                task: \"setLineChartStrokeColor\",\r\n                                params: { color: color, subchartIdx, yaxisIdx: 0, graphIdx },\r\n                              };\r\n                              (ChartStateDispatch as React.Dispatch<ReducerActionType<\"setLineChartStrokeColor\">>)(\r\n                                action\r\n                              );\r\n                            }}\r\n                          />\r\n                        }\r\n                      />\r\n                    ) : graph.meta.type === \"candlechart\" ? (\r\n                      <React.Fragment>\r\n                        <CTreeItem\r\n                          nodeId={`${2 + subchartIdx}00-${graphIdx}`}\r\n                          labelText=\"candle up color\"\r\n                          labelIcon={<Icon path={mdiBorderColor} size={1} color=\"#333\" />}\r\n                          labelInfo={\r\n                            <Colorpicker\r\n                              color={graph.style.candleUpColor}\r\n                              onColorSelected={(color) => {\r\n                                const action: ReducerActionType<\"setCandleChartUpColor\"> = {\r\n                                  task: \"setCandleChartUpColor\",\r\n                                  params: { color: color, subchartIdx, yaxisIdx: 0, graphIdx },\r\n                                };\r\n                                (ChartStateDispatch as React.Dispatch<ReducerActionType<\"setCandleChartUpColor\">>)(\r\n                                  action\r\n                                );\r\n                              }}\r\n                            />\r\n                          }\r\n                        />\r\n                        <CTreeItem\r\n                          nodeId={`${2 + subchartIdx}00-${graphIdx}`}\r\n                          labelText=\"candle down color\"\r\n                          labelIcon={<Icon path={mdiBorderColor} size={1} color=\"#333\" />}\r\n                          labelInfo={\r\n                            <Colorpicker\r\n                              color={graph.style.candleDownColor}\r\n                              onColorSelected={(color) => {\r\n                                const action: ReducerActionType<\"setCandleChartDownColor\"> = {\r\n                                  task: \"setCandleChartDownColor\",\r\n                                  params: { color: color, subchartIdx, yaxisIdx: 0, graphIdx },\r\n                                };\r\n                                (ChartStateDispatch as React.Dispatch<ReducerActionType<\"setCandleChartDownColor\">>)(\r\n                                  action\r\n                                );\r\n                              }}\r\n                            />\r\n                          }\r\n                        />\r\n                        <CTreeItem\r\n                          nodeId={`${2 + subchartIdx}00-${graphIdx}`}\r\n                          labelText=\"candle stroke color\"\r\n                          labelIcon={<Icon path={mdiBorderColor} size={1} color=\"#333\" />}\r\n                          labelInfo={\r\n                            <Colorpicker\r\n                              color={graph.style.candleStrokeColor}\r\n                              onColorSelected={(color) => {\r\n                                const action: ReducerActionType<\"setCandleChartStrokeColor\"> = {\r\n                                  task: \"setCandleChartStrokeColor\",\r\n                                  params: { color: color, subchartIdx, yaxisIdx: 0, graphIdx },\r\n                                };\r\n                                (ChartStateDispatch as React.Dispatch<ReducerActionType<\"setCandleChartStrokeColor\">>)(\r\n                                  action\r\n                                );\r\n                              }}\r\n                            />\r\n                          }\r\n                        />\r\n                      </React.Fragment>\r\n                    ) : null}\r\n                  </CTreeItem>\r\n                </React.Fragment>\r\n              ) : null\r\n            )}\r\n\r\n            {subchart.yaxis[0].tools.length > 0 ? (\r\n              <CTreeItem\r\n                key={`tools-${subchartIdx}-y0`}\r\n                nodeId={`tools-${subchartIdx}-y0`}\r\n                labelIcon={\r\n                  <div\r\n                    style={{\r\n                      background: theme.palette.primary.main,\r\n                      width: 32,\r\n                      height: 32,\r\n                      border: \"1px solid #666\",\r\n                      borderRadius: 5,\r\n                      marginRight: 10,\r\n                    }}\r\n                  >\r\n                    <Icon path={mdiPencilRuler} size={\"32px\"} color={theme.palette.secondary.contrastText} />\r\n                  </div>\r\n                }\r\n                labelText=\"Tools\"\r\n                bgColor=\"#eee\"\r\n              >\r\n                {subchart.yaxis[0].tools.map((tool, toolIdx) => (\r\n                  <CToolTreeItem\r\n                    key={`editIndicator-sub-${subchartIdx}-yaxis-${0}-tool-${toolIdx}`}\r\n                    ChartState={ChartState}\r\n                    ChartStateDispatch={ChartStateDispatch}\r\n                    subchartIdx={subchartIdx}\r\n                    yaxisIdx={0}\r\n                    toolIdx={toolIdx}\r\n                  />\r\n                ))}\r\n              </CTreeItem>\r\n            ) : null}\r\n          </CTreeItem>\r\n        ))}\r\n      </TreeView>\r\n    </React.Fragment>\r\n  );\r\n};\r\n","import {\r\n  Button,\r\n  Grid,\r\n  ListItem,\r\n  List,\r\n  Paper,\r\n  Typography,\r\n  useMediaQuery,\r\n  ListItemIcon,\r\n  ListItemText,\r\n  useTheme,\r\n} from \"@material-ui/core\";\r\nimport { mdiChartLine, mdiChartBellCurve, mdiPencilRuler, mdiTune, mdiStarShooting, mdiBroom } from \"@mdi/js\";\r\nimport Icon, { Stack } from \"@mdi/react\";\r\nimport React from \"react\";\r\nimport { CalculatedChartStateType } from \"../Types/CChartStateTypes\";\r\nimport { CChartMenuOpenType } from \"./ChartMenu\";\r\n\r\nexport const ChartMenuQuickys = (props: {\r\n  ChartState: CalculatedChartStateType;\r\n  onNavigate: (target: CChartMenuOpenType) => void;\r\n}) => {\r\n  const { ChartState, onNavigate } = props;\r\n\r\n  const isMinSm = useMediaQuery(\"(min-width:600px)\");\r\n  const theme = useTheme();\r\n\r\n  return (\r\n    <React.Fragment>\r\n      {/* <Grid container>\r\n        <Grid item> */}\r\n      <List>\r\n        <ListItem\r\n          button\r\n          onClick={() => {\r\n            // onNavigate?.(\"indicators\");\r\n          }}\r\n        >\r\n          <ListItemIcon\r\n            style={{\r\n              border: \"1px solid #666\",\r\n              borderRadius: 5,\r\n              marginRight: 10,\r\n              background: theme.palette.secondary.main,\r\n              minWidth: 48,\r\n              height: 48,\r\n              position: \"relative\",\r\n              top: 0,\r\n            }}\r\n          >\r\n            <Icon\r\n              path={mdiBroom}\r\n              size={2}\r\n              color={theme.palette.secondary.contrastText}\r\n              style={{ position: \"absolute\", top: 0, left: 0 }}\r\n              rotate={5}\r\n            />\r\n            <Icon\r\n              path={mdiChartBellCurve}\r\n              size={0.8}\r\n              color={\"#fff\"}\r\n              style={{ position: \"absolute\", bottom: 0, right: 0 }}\r\n            />\r\n          </ListItemIcon>\r\n          <ListItemText\r\n            primary=\"Clear All Indicators\"\r\n            primaryTypographyProps={{ variant: \"h6\", color: \"textSecondary\" }}\r\n          />\r\n        </ListItem>\r\n        <ListItem\r\n          button\r\n          onClick={() => {\r\n            // onNavigate?.(\"tools\");\r\n          }}\r\n        >\r\n          <ListItemIcon\r\n            style={{\r\n              border: \"1px solid #666\",\r\n              borderRadius: 5,\r\n              marginRight: 10,\r\n              background: theme.palette.secondary.main,\r\n              minWidth: 48,\r\n              height: 48,\r\n              position: \"relative\",\r\n              top: 0,\r\n            }}\r\n          >\r\n            <Icon\r\n              path={mdiBroom}\r\n              size={2}\r\n              color={theme.palette.secondary.contrastText}\r\n              style={{ position: \"absolute\", top: 0, left: 0 }}\r\n              rotate={5}\r\n            />\r\n            <Icon\r\n              path={mdiPencilRuler}\r\n              size={0.7}\r\n              color={\"#fff\"}\r\n              style={{ position: \"absolute\", bottom: 1, right: 1 }}\r\n            />\r\n          </ListItemIcon>\r\n          <ListItemText primary=\"Clear All Tools\" primaryTypographyProps={{ variant: \"h6\", color: \"textSecondary\" }} />\r\n        </ListItem>\r\n        <ListItem\r\n          button\r\n          onClick={() => {\r\n            // onNavigate?.(\"settings\");\r\n          }}\r\n        >\r\n          <ListItemIcon\r\n            style={{\r\n              border: \"1px solid #666\",\r\n              borderRadius: 5,\r\n              marginRight: 10,\r\n              background: theme.palette.secondary.main,\r\n              width: 48,\r\n              height: 48,\r\n            }}\r\n          >\r\n            <Icon path={mdiTune} size={2} color={theme.palette.secondary.contrastText} />\r\n          </ListItemIcon>\r\n          <ListItemText\r\n            primary=\"Autoscale Y axis (mode to disable upcoming)\"\r\n            primaryTypographyProps={{ variant: \"h6\", color: \"textSecondary\" }}\r\n          />\r\n        </ListItem>\r\n      </List>\r\n      {/* </Grid>\r\n      </Grid> */}\r\n    </React.Fragment>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport {\r\n  Button,\r\n  createStyles,\r\n  Drawer,\r\n  Grid,\r\n  IconButton,\r\n  makeStyles,\r\n  Paper,\r\n  TextField,\r\n  Theme,\r\n  Typography,\r\n  useMediaQuery,\r\n  useTheme,\r\n} from \"@material-ui/core\";\r\nimport { mdiClose, mdiFullscreen, mdiHome, mdiMagnify, mdiPencilRuler, mdiTune } from \"@mdi/js\";\r\nimport Icon from \"@mdi/react\";\r\nimport { CalculatedChartStateType, ChartStateHookType } from \"../Types/CChartStateTypes\";\r\n\r\nimport { ChartMenuHome } from \"./ChartMenuHome\";\r\nimport { ChartMenuIndicators } from \"./ChartMenuIndicators\";\r\nimport { ChartMenuTools } from \"./ChartMenuTools\";\r\nimport { ChartMenuSettings } from \"./ChartMenuSettings\";\r\nimport { ChartMenuQuickys } from \"./ChartMenuQuickys\";\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    paper: {\r\n      minHeight: \"33%\",\r\n      border: \"1px solid #666\",\r\n      borderTopLeftRadius: 10,\r\n      borderTopRightRadius: 10,\r\n    },\r\n    paperDesktop: {\r\n      minHeight: \"33%\",\r\n      border: \"1px solid #666\",\r\n      borderBottomRightRadius: 10,\r\n      borderTopRightRadius: 10,\r\n    },\r\n  })\r\n);\r\n\r\nexport type CChartMenuOpenType =\r\n  | \"menu\"\r\n  | \"chart\"\r\n  | \"indicators\"\r\n  | \"tools\"\r\n  | \"settings\"\r\n  | \"quickys\"\r\n  | \"editIndicator\"\r\n  | \"editTool\"\r\n  | null;\r\n\r\nexport const CChartMenu2 = (props: {\r\n  open: CChartMenuOpenType;\r\n  onClose: () => void;\r\n  ChartState: CalculatedChartStateType;\r\n  onNavigate: (target: CChartMenuOpenType) => void;\r\n  ChartStateDispatch: ChartStateHookType[1];\r\n}) => {\r\n  const { onClose, open, ChartState, onNavigate, ChartStateDispatch } = props;\r\n  const theme = useTheme();\r\n  const isMinSm = useMediaQuery(\"(min-width:600px)\");\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <Drawer\r\n      anchor={!!isMinSm ? \"left\" : \"bottom\"}\r\n      open={!!open}\r\n      classes={{ paper: !!isMinSm ? classes.paperDesktop : classes.paper }}\r\n      ModalProps={{ hideBackdrop: true }}\r\n    >\r\n      <div style={{ background: theme.palette.primary.main, color: theme.palette.primary.contrastText, padding: 10 }}>\r\n        <Grid container alignItems=\"center\" justify=\"center\">\r\n          <Grid item>\r\n            <Typography component=\"div\" variant=\"h4\">\r\n              {open === \"quickys\"\r\n                ? \"Quick Tasks\"\r\n                : open === \"editIndicator\"\r\n                ? \"Edit Indicator\"\r\n                : open === \"indicators\"\r\n                ? \"Add Indicator\"\r\n                : open === \"editTool\"\r\n                ? \"Edit Tool\"\r\n                : open === \"tools\"\r\n                ? \"Add Tool\"\r\n                : open === \"settings\"\r\n                ? \"Settings\"\r\n                : \"Chart Menu\"}\r\n            </Typography>\r\n          </Grid>\r\n          <Grid item xs></Grid>\r\n          <Grid item>\r\n            <div style={{ height: \"2.6rem\" }}>\r\n              {!!open && open !== \"menu\" ? (\r\n                <IconButton\r\n                  size=\"small\"\r\n                  onClick={() => {\r\n                    onNavigate(\"menu\");\r\n                  }}\r\n                >\r\n                  <Icon path={mdiHome} size={1.75} color={theme.palette.primary.contrastText}></Icon>\r\n                </IconButton>\r\n              ) : null}\r\n\r\n              <IconButton\r\n                size=\"small\"\r\n                onClick={() => {\r\n                  //   onClose?.();\r\n                }}\r\n              >\r\n                <Icon path={mdiFullscreen} size={1.75} color={theme.palette.primary.contrastText}></Icon>\r\n              </IconButton>\r\n              <IconButton\r\n                size=\"small\"\r\n                onClick={() => {\r\n                  onClose?.();\r\n                }}\r\n              >\r\n                <Icon path={mdiClose} size={1.75} color={theme.palette.primary.contrastText}></Icon>\r\n              </IconButton>\r\n            </div>\r\n          </Grid>\r\n        </Grid>\r\n      </div>\r\n      <div style={{ padding: 10 }}>\r\n        {open === \"menu\" ? (\r\n          <ChartMenuHome ChartState={ChartState} onNavigate={onNavigate} />\r\n        ) : open === \"indicators\" || open === \"editIndicator\" ? (\r\n          <ChartMenuIndicators\r\n            ChartState={ChartState}\r\n            onNavigate={onNavigate}\r\n            open={open}\r\n            ChartStateDispatch={ChartStateDispatch}\r\n          />\r\n        ) : open === \"tools\" || open === \"editTool\" ? (\r\n          <ChartMenuTools\r\n            ChartState={ChartState}\r\n            ChartStateDispatch={ChartStateDispatch}\r\n            onNavigate={onNavigate}\r\n            open={open}\r\n          />\r\n        ) : open === \"settings\" ? (\r\n          <ChartMenuSettings ChartState={ChartState} ChartStateDispatch={ChartStateDispatch} onNavigate={onNavigate} />\r\n        ) : open === \"quickys\" ? (\r\n          <ChartMenuQuickys ChartState={ChartState} onNavigate={onNavigate} />\r\n        ) : null}\r\n      </div>\r\n    </Drawer>\r\n  );\r\n};\r\n","import React, { RefObject } from \"react\";\r\nimport { Stage, Layer, Rect, Line, Shape } from \"react-konva\";\r\nimport { CChartProps, Dataset } from \"./Types/CChartTypes\";\r\nimport { isIndicatorGraph } from \"./Types/CChartStateTypes\";\r\nimport Ajv from \"ajv\";\r\nimport { chartDataSchema } from \"./CChartDataSchema\";\r\nimport { CChartLabel } from \"./CChartLabel\";\r\nimport { CChartCrosshair } from \"./CChartCrosshair\";\r\n\r\nimport { CCandleChart } from \"./Charts/CCandleChart\";\r\nimport { CLineChart } from \"./Charts/CLineChart\";\r\nimport { CBarChart } from \"./Charts/CBarChart\";\r\nimport { ReducerActionType } from \"./ChartState/CChartStateReducer\";\r\nimport { useChartState } from \"./ChartState/CChartState\";\r\nimport { CTrendline } from \"./Tools/CTrendline\";\r\nimport { CVline } from \"./Tools/CVLine\";\r\nimport { CHline } from \"./Tools/CHLine\";\r\nimport { Button, ThemeProvider, Typography, useTheme } from \"@material-ui/core\";\r\n\r\nimport { muiTheme } from \"./MuiTheme\";\r\nimport { CChartMenu2, CChartMenuOpenType } from \"./Menu2/ChartMenu\";\r\n// import { Layer as LayerType } from \"konva\";\r\nimport Icon from \"@mdi/react\";\r\nimport { mdiMenu } from \"@mdi/js\";\r\nconst ajv = new Ajv();\r\n\r\nexport const CChart = (props: CChartProps) => {\r\n  // get props + -> deviceRatio (does konva need that anymore?!)\r\n  const { width, height, chartData, style, viewMode } = props;\r\n  // responsive container and pointer events\r\n  let widthPerTick = 20;\r\n  const ContainerRef: RefObject<HTMLDivElement> = React.useRef(null);\r\n  const [ChartMenuActive, setChartMenuActive] = React.useState<\r\n    \"menu\" | \"charts\" | \"indicators\" | \"settings\" | \"tools\" | null\r\n  >(null);\r\n  const [ChartMenu2Open, setChartMenu2Open] = React.useState<CChartMenuOpenType>(null);\r\n  const [ChartState, ChartStateDispatch] = useChartState(ContainerRef, { width, height, viewMode });\r\n  widthPerTick = ChartState.xaxis.scaledWidthPerTick;\r\n  const { widthYAxis, widthTickmarkLines } = ChartState.yaxis;\r\n  const { heightXAxis, heightTickMarkLines } = ChartState.xaxis;\r\n  const containerWidth = ChartState.containerSize.width - 1;\r\n  const containerHeight = ChartState.containerSize.height - 1;\r\n  const isContainerInit = ChartState.containerSize.init;\r\n  // const theme = useTheme();\r\n\r\n  // const CanvasLayerCharts: React.RefObject<LayerType> = React.useRef(null);\r\n\r\n  // check chartData schema every time chartData is modified\r\n  React.useEffect(() => {\r\n    if (!isContainerInit) return;\r\n    const validate = ajv.compile(chartDataSchema);\r\n    const valid = validate(chartData);\r\n    if (!valid) {\r\n      alert(\"ERROR - chartData prop is not valid, check console\");\r\n      console.log(\"ERROR - chartData prop is not valid -> \", \"data:\", chartData, \"errors:\", validate.errors);\r\n    } else if (ChartState.subCharts.length === 0) {\r\n      const action: ReducerActionType<\"addSubchart\"> = {\r\n        task: \"addSubchart\",\r\n        params: { chartSeries: chartData[0].data, chartName: chartData[0].name, containerHeight },\r\n      };\r\n      (ChartStateDispatch as React.Dispatch<ReducerActionType<\"addSubchart\">>)(action);\r\n      // addSubchart(chartData[0].data, chartData[0].name, { indicatorFn: ATR, params: [14] });\r\n      // addSubchart(chartData[0].data, chartData[0].name, { indicatorFn: RSI, params: [14] });\r\n      // addGraph(chartData[0].data, chartData[0].name, 0, { indicatorFn: SMA, params: [10] });\r\n    }\r\n    // eslint-disable-next-line\r\n  }, [chartData, ChartState.subCharts.length, containerHeight, isContainerInit, heightXAxis]);\r\n  const fullState = ChartState;\r\n\r\n  console.log(fullState);\r\n  const xAxis = fullState.xaxis.xAxisTicks;\r\n  return (\r\n    // <div style={{ width: \"100%\", height: \"100%\", position: \"fixed\", top: 0 }}>\r\n    <React.Fragment>\r\n      <ThemeProvider theme={muiTheme}>\r\n        <div //responsive container (above is not necessary)\r\n          ref={ContainerRef}\r\n          style={{\r\n            boxSizing: \"border-box\",\r\n            // width: !!width ? width : \"100%\",\r\n            // height: !!height ? height : \"100%\",\r\n            // width: \"100%\",\r\n            // height: \"100%\",\r\n            // position: \"fixed\",\r\n            border: \"1px solid red\",\r\n            background: fullState.backgroundColor,\r\n            // ...addContainerStyles,\r\n          }}\r\n        >\r\n          <Stage //konva container\r\n            width={ChartState.containerSize.width}\r\n            height={ChartState.containerSize.height}\r\n            listening={false}\r\n\r\n            // style={{ boxSizing: \"border-box\" }}\r\n          >\r\n            {/*  Canvas Layer 3 - chart and example */}\r\n            <Layer>\r\n              {/* <Rect\r\n              x={20 + ChartState.pointer.totalTranslatedX}\r\n              y={50 + ChartState.pointer.totalTranslatedY}\r\n              width={100}\r\n              height={100}\r\n              fill=\"red\"\r\n              shadowBlur={10}\r\n            /> */}\r\n              {0 in fullState.subCharts ? <CCandleChart fullState={fullState} /> : null}\r\n              {fullState.subCharts.map((subchart, subchartIdx) =>\r\n                subchart.yaxis.map((singleYaxis, singleYaxisIdx) =>\r\n                  singleYaxis.graphs.map((graph, graphIdx) => {\r\n                    const stateGraph = fullState.subCharts[subchartIdx].yaxis[0].graphs[graphIdx];\r\n                    // const type = stateGraph.type;\r\n                    const indicatorType = isIndicatorGraph(stateGraph) ? stateGraph.indicator.type : null;\r\n                    if (isIndicatorGraph(stateGraph) && stateGraph.data.length > 0) {\r\n                      const indicatorLines = stateGraph.data[stateGraph.data.length - 1].prices;\r\n\r\n                      if (indicatorType === \"line\") {\r\n                        return indicatorLines.map((indicatorDataSeries, indDataSeriesIdx) => (\r\n                          <CLineChart\r\n                            fullState={fullState}\r\n                            subchartIdx={subchartIdx}\r\n                            yaxisIdx={0}\r\n                            graphIdx={graphIdx}\r\n                            key={`${subchartIdx}-${graphIdx}-${indDataSeriesIdx}`}\r\n                            indSeriesIdx={indDataSeriesIdx}\r\n                          />\r\n                        ));\r\n                      } else if (indicatorType === \"bars\") {\r\n                        return (\r\n                          <CBarChart\r\n                            fullState={fullState}\r\n                            subchartIdx={subchartIdx}\r\n                            yaxisIdx={0}\r\n                            graphIdx={graphIdx}\r\n                            key={`${subchartIdx}-${graphIdx}`}\r\n                          />\r\n                        );\r\n                      }\r\n                    }\r\n                    return null;\r\n                  })\r\n                )\r\n              )}\r\n              {/* NEW TLINE!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! */}\r\n              {!!fullState.pointer.move.isMoving && fullState.draw.pixXy.length >= 1 ? (\r\n                <Line\r\n                  x={0}\r\n                  y={0}\r\n                  points={[\r\n                    fullState.draw.pixXy[0][0],\r\n                    fullState.draw.pixXy[0][1],\r\n                    !!fullState.pointer?.chartPointer.move.x\r\n                      ? fullState.methods.xToPix(fullState.pointer.chartPointer.move.x)\r\n                      : fullState.pointer.move.xy[0],\r\n                    !!fullState.pointer?.chartPointer?.move.snapDatasets?.[0]?.pixYSnap\r\n                      ? fullState.pointer?.chartPointer?.move.snapDatasets[0].pixYSnap\r\n                      : fullState.pointer.move.xy[1],\r\n                  ]}\r\n                  stroke={\"red\"}\r\n                  strokeWidth={1}\r\n                />\r\n              ) : null}\r\n              {/* EXISTING TLINES!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! */}\r\n              {0 in fullState.subCharts\r\n                ? fullState.subCharts[0].yaxis[0].tools.map((tool, toolIdx) => {\r\n                    if (tool.type === \"trendline\" && tool.xy.length === 2)\r\n                      return (\r\n                        <CTrendline\r\n                          mode=\"trendline\"\r\n                          subchartTop={fullState.subCharts[0].top}\r\n                          subchartBottom={fullState.subCharts[0].bottom}\r\n                          pixXy={[\r\n                            [fullState.methods.xToPix(tool.xy[0][0]), fullState.methods.yToPix(tool.xy[0][1], 0, 0)],\r\n                            [fullState.methods.xToPix(tool.xy[1][0]), fullState.methods.yToPix(tool.xy[1][1], 0, 0)],\r\n                          ]}\r\n                          style={{ anchorColor: tool.style.anchorColor, strokeColor: tool.style.strokeColor }}\r\n                        />\r\n                      );\r\n                    else if (tool.type === \"vline\" && tool.xy.length === 1)\r\n                      return (\r\n                        <CVline\r\n                          mode=\"extendUpDown\"\r\n                          subchartTop={fullState.subCharts[0].top}\r\n                          subchartBottom={fullState.subCharts[0].bottom}\r\n                          pixXy={[\r\n                            [fullState.methods.xToPix(tool.xy[0][0]), fullState.methods.yToPix(tool.xy[0][1], 0, 0)],\r\n                          ]}\r\n                          style={{ anchorColor: tool.style.anchorColor, strokeColor: tool.style.strokeColor }}\r\n                        />\r\n                      );\r\n                    else if (tool.type === \"hline\" && tool.xy.length === 1)\r\n                      return (\r\n                        <CHline\r\n                          mode=\"extendLeftRight\"\r\n                          pixXstart={0}\r\n                          pixXend={fullState.containerSize.width - fullState.yaxis.widthYAxis}\r\n                          pixXy={[\r\n                            [fullState.methods.xToPix(tool.xy[0][0]), fullState.methods.yToPix(tool.xy[0][1], 0, 0)],\r\n                          ]}\r\n                          style={{ anchorColor: tool.style.anchorColor, strokeColor: tool.style.strokeColor }}\r\n                        />\r\n                      );\r\n                    else return null;\r\n                  })\r\n                : null}\r\n            </Layer>\r\n\r\n            {/*  Canvas Layer 5 (before 0) - axis bg rects + future chartbgcolor? */}\r\n            <Layer>\r\n              <Rect\r\n                x={0 + 0.5}\r\n                y={containerHeight - heightXAxis + 0.5}\r\n                width={containerWidth}\r\n                height={heightXAxis}\r\n                fill={ChartState.xaxis.style.fillColor}\r\n                stroke={ChartState.xaxis.style.strokeColor}\r\n                strokeWidth={1}\r\n              />\r\n              {fullState.subCharts.map((subchart, subchartIdx) => (\r\n                <React.Fragment key={subchartIdx}>\r\n                  <Rect\r\n                    // key={`subchartPrimaryYaxis-${subchartIdx}`}\r\n                    x={containerWidth - widthYAxis + 0.5}\r\n                    y={subchart.top + 0.5}\r\n                    width={widthYAxis}\r\n                    height={subchart.bottom - subchart.top}\r\n                    // fill={ChartState.xaxis.style.fillColor}\r\n                    stroke={ChartState.xaxis.style.strokeColor}\r\n                    strokeWidth={1}\r\n                  />\r\n                  <Rect\r\n                    // key={`subchartBorder-${subchartIdx}`}\r\n                    x={0 + 0.5}\r\n                    y={subchart.top + 0.5}\r\n                    width={containerWidth - widthYAxis}\r\n                    height={subchart.bottom - subchart.top}\r\n                    stroke={ChartState.xaxis.style.strokeColor}\r\n                    strokeWidth={1}\r\n                  />\r\n                </React.Fragment>\r\n              ))}\r\n            </Layer>\r\n            {/*  Canvas Layer 6 before 1 - x axis */}\r\n            <Layer>\r\n              {xAxis.map((xaxisTick, xaxisTickIdx) => {\r\n                return (\r\n                  <React.Fragment key={xaxisTickIdx}>\r\n                    <Line\r\n                      x={xaxisTick.x}\r\n                      y={ChartState.containerSize.height - 1 - heightXAxis + 0.5}\r\n                      points={[0, 0, 0, heightTickMarkLines]}\r\n                      stroke={ChartState.xaxis.style.strokeColor}\r\n                      strokeWidth={1}\r\n                    />\r\n                    {!!ChartState.grid.useGridX ? (\r\n                      <Line\r\n                        x={xaxisTick.x}\r\n                        y={0 + 0.5}\r\n                        points={[0, 0, 0, ChartState.containerSize.height - 1 - heightXAxis + 0.5]}\r\n                        stroke={ChartState.grid.style.strokeColor}\r\n                        strokeWidth={1}\r\n                      />\r\n                    ) : null}\r\n                    <Shape\r\n                      sceneFunc={(context, shape) => {\r\n                        // context.fillS\r\n                        const ctx = context._context;\r\n                        ctx.font = ChartState.xaxis.style.fontSize + \"px \" + ChartState.xaxis.style.fontName;\r\n                        ctx.fillStyle = ChartState.xaxis.style.fontColor;\r\n                        ctx.textAlign = \"center\";\r\n                        ctx.textBaseline = \"top\";\r\n                        ctx.fillText(\r\n                          xaxisTick.dateString,\r\n                          xaxisTick.x,\r\n                          ChartState.containerSize.height - 1 - heightXAxis + 0.5 + 20 + 5 // additional 5px distance to end of tickmark\r\n                        );\r\n                        // (!) Konva specific method, it is very important\r\n                        context.fillStrokeShape(shape);\r\n                      }}\r\n                      // fill=\"#333\"\r\n                      // stroke={ChartState.options.xAxis.style.fontColor}\r\n                      // strokeWidth={1}\r\n                    />\r\n                  </React.Fragment>\r\n                );\r\n              })}\r\n            </Layer>\r\n            {/*  Canvas Layer 7 before 2 - y axis */}\r\n            <Layer>\r\n              {fullState.subCharts.map((subchart, subchartIdx) => {\r\n                return subchart.yaxis.map((singleYaxis, singleYaxisIdx) => {\r\n                  const yAxisTicks = singleYaxis.drawTicks;\r\n\r\n                  // const yAxisTicks =\r\n                  //   subchartIdx === 0 ? subchart.yaxis[0] : subchart.yaxis[0].slice(0, subchart.yaxis[0].length - 1);\r\n                  return yAxisTicks.map((yaxisTick, yaxisTickIdx) => {\r\n                    return (\r\n                      <React.Fragment key={yaxisTick.label}>\r\n                        <Line\r\n                          x={ChartState.containerSize.width - 1 - widthYAxis + 0.5}\r\n                          y={yaxisTick.pixY + 0.5}\r\n                          points={[0, 0, widthTickmarkLines, 0]}\r\n                          stroke={ChartState.xaxis.style.strokeColor}\r\n                          strokeWidth={1}\r\n                        />\r\n                        {!!ChartState.grid.useGridY ? (\r\n                          <Line\r\n                            x={0 + 0.5}\r\n                            y={yaxisTick.pixY + 0.5}\r\n                            points={[0, 0, ChartState.containerSize.width - 1 + 0.5, 0]}\r\n                            stroke={ChartState.grid.style.strokeColor}\r\n                            strokeWidth={1}\r\n                          />\r\n                        ) : null}\r\n                        <Shape\r\n                          sceneFunc={(context, shape) => {\r\n                            // context.fillS\r\n                            const ctx = context._context;\r\n                            ctx.font = ChartState.yaxis.style.fontSize + \"px \" + ChartState.yaxis.style.fontName;\r\n                            ctx.fillStyle = ChartState.yaxis.style.fontColor;\r\n                            ctx.textAlign = \"left\";\r\n                            ctx.textBaseline = \"middle\";\r\n                            ctx.fillText(\r\n                              yaxisTick.label,\r\n                              ChartState.containerSize.width - 1 - widthYAxis + widthTickmarkLines + 5 + 0.5,\r\n                              yaxisTick.pixY // additional 5px distance to end of tickmark\r\n                            );\r\n                            // (!) Konva specific method, it is very important\r\n                            context.fillStrokeShape(shape);\r\n                          }}\r\n                        />\r\n                      </React.Fragment>\r\n                    );\r\n                  });\r\n                });\r\n              })}\r\n            </Layer>\r\n            {/*  Canvas Layer 4 - crosshair */}\r\n            <Layer>\r\n              {!!ChartState.pointer.move?.xy && !!ChartState.pointer.isHovering ? (\r\n                <CChartCrosshair fullState={fullState} />\r\n              ) : null}\r\n            </Layer>\r\n          </Stage>\r\n        </div>\r\n        {/* <CChartMenu\r\n          ChartState={fullState}\r\n          ChartStateDispatch={ChartStateDispatch}\r\n          active={ChartMenuActive}\r\n          onNavigate={(newLoc) => setChartMenuActive(newLoc)}\r\n        /> */}\r\n\r\n        {!!fullState.xaxis.xEnd && xAxis.length > 0\r\n          ? fullState.subCharts.map((subchart, subchartIdx) =>\r\n              subchart.yaxis[0].graphs.map((graph, graphIdx) => {\r\n                const name =\r\n                  isIndicatorGraph(graph) && graph.indicator.params.length > 0\r\n                    ? `${graph.indicator.name}(${graph.indicator.params[0].val})`\r\n                    : isIndicatorGraph(graph) && graph.indicator.params.length === 0\r\n                    ? `${graph.indicator.name}`\r\n                    : graph.name;\r\n                if (!graph.datasets.last) return null;\r\n\r\n                const tmpDataset: Dataset =\r\n                  (fullState.pointer.isHovering &&\r\n                  subchartIdx === fullState.pointer?.chartPointer?.move.subchartIdx &&\r\n                  fullState.pointer?.chartPointer?.move.snapDatasets?.[0]?.graphIdx === graphIdx\r\n                    ? fullState.pointer?.chartPointer?.move?.snapDatasets?.[0]?.data\r\n                    : fullState.pointer.isHovering &&\r\n                      // subchartIdx === fullState.pointer?.chartPointer?.move.subchartIdx &&\r\n                      fullState.pointer.chartPointer.move.x !== null\r\n                    ? graph.data[fullState.pointer.chartPointer.move.x]\r\n                    : graph.datasets.last.data) || graph.datasets.last.data;\r\n\r\n                return (\r\n                  <CChartLabel\r\n                    key={`${subchartIdx}-${graphIdx}`}\r\n                    onClick={() => setChartMenuActive(\"settings\")}\r\n                    name={name}\r\n                    dataset={tmpDataset}\r\n                    decimals={\r\n                      isIndicatorGraph(graph) && graph.indicator.default.decimals !== undefined\r\n                        ? graph.indicator.default.decimals\r\n                        : graph.decimals\r\n                    }\r\n                    top={subchart.top + graphIdx * 30} // get height automatically!\r\n                  />\r\n                );\r\n              })\r\n            )\r\n          : null}\r\n        <div style={{ position: \"absolute\", top: (fullState.subCharts?.[0]?.bottom ?? 0) - 64 - 10, left: 10 }}>\r\n          <Button\r\n            color=\"primary\"\r\n            variant=\"contained\"\r\n            style={{ width: 64, height: 64, textTransform: \"none\", borderRadius: 5, opacity: 0.8 }}\r\n            onClick={() => setChartMenu2Open(\"menu\")}\r\n          >\r\n            <div style={{ position: \"relative\", top: 0, height: 64 }}>\r\n              <Icon path={mdiMenu} size=\"64px\" color=\"#fff\" />\r\n            </div>\r\n          </Button>\r\n        </div>\r\n\r\n        <CChartMenu2\r\n          open={ChartMenu2Open}\r\n          onClose={() => {\r\n            setChartMenu2Open(null);\r\n          }}\r\n          onNavigate={(target) => setChartMenu2Open(target)}\r\n          ChartState={fullState}\r\n          ChartStateDispatch={ChartStateDispatch}\r\n        />\r\n      </ThemeProvider>\r\n    </React.Fragment>\r\n    // </div>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { CChart } from \"../Components/Chart/CChart\";\r\nimport { csvParse } from \"d3-dsv\";\r\nimport { timeParse } from \"d3-time-format\";\r\nimport { ChartDataset } from \"../Components/Chart/Types/CChartTypes\";\r\n\r\nfunction parseData(parse: any) {\r\n  return function (d: any) {\r\n    d.date = parse(d.date);\r\n    d.open = +d.open;\r\n    d.high = +d.high;\r\n    d.low = +d.low;\r\n    d.close = +d.close;\r\n    d.volume = +d.volume;\r\n\r\n    return d;\r\n  };\r\n}\r\nconst parseDate = timeParse(\"%Y-%m-%d\");\r\n\r\nexport function getData() {\r\n  const promiseMSFT = fetch(\"https://raw.githubusercontent.com/carmnk/resources/main/data/csv/BAYN.DE.csv\")\r\n    .then((response) => {\r\n      return response.text();\r\n    })\r\n    .then((data) => {\r\n      //   console.log(data);\r\n      return csvParse(data, parseData(parseDate));\r\n    })\r\n    .then((res) => {\r\n      //   console.log(res);s\r\n      return res;\r\n    });\r\n  return promiseMSFT;\r\n}\r\n\r\nexport const ChartTest = () => {\r\n  const [Data, setData] = React.useState<any>(null);\r\n  const [W, setW] = React.useState(400);\r\n  React.useEffect(() => {\r\n    getData().then((res) => setData(res));\r\n  }, []);\r\n\r\n  if (!Data) return null;\r\n  console.log(\"DATA:\", [{ data: Data, name: \"coolChart\" }]);\r\n\r\n  return (\r\n    <CChart\r\n      chartData={[{ data: Data as unknown as ChartDataset[], name: \"coolChart\" }]}\r\n      viewMode=\"fullscreen\"\r\n      style=\"TODO\"\r\n    />\r\n  );\r\n};\r\n","import React from \"react\";\nimport { createMuiTheme, responsiveFontSizes, ThemeProvider } from \"@material-ui/core/styles\";\nimport { BrowserRouter as Router, Switch, Route, Link, useLocation, BrowserRouter } from \"react-router-dom\";\nimport Home from \"./Pages/Home\";\nimport Layout from \"./Layout\";\nimport { ChartTest } from \"./Pages/Chart\";\n\nconst routes = [\n  {\n    content: (props: any) => {\n      return <Home {...props} />;\n    },\n    path: \"/\",\n    exact: true,\n  },\n  {\n    content: (props: any) => {\n      return <ChartTest {...props} />;\n    },\n    path: \"/chart\",\n    exact: true,\n  },\n];\n\nlet theme = createMuiTheme({\n  palette: {\n    primary: {\n      main: \"#009688\",\n    },\n    secondary: {\n      main: \"#f50057\",\n    },\n    type: \"light\",\n  },\n  spacing: (factor) => `${0.5 * factor}rem`,\n  overrides: { MuiCssBaseline: { \"@global\": { body: {boxSizing: \"border-box\"}}} },\n});\n\ntheme.typography.h1 = { fontFamily: \"'Open Sans', sans-serif, Arial\", fontWeight: 600, fontSize: \"4rem\", lineHeight: 1.167, };\ntheme.typography.h2 = {\n  fontFamily: \"'Open Sans', sans-serif, Arial\",\n  fontWeight: 600,\n  fontSize: \"2.5rem\",\n  lineHeight: 1.167,\n};\ntheme.typography.h3 = {\n  fontFamily: \"'Open Sans', sans-serif, Arial\",\n  fontWeight: 600,\n  fontSize: \"2rem\",\n  lineHeight: 1.167,\n};\ntheme.typography.h4 = {\n  fontFamily: \"'Open Sans', sans-serif, Arial\",\n  fontWeight: 600,\n  fontSize: \"1.88rem\",\n  lineHeight: 1.167,\n};\ntheme.typography.h5 = {\n  fontFamily: \"'Open Sans', sans-serif, Arial\",\n  fontWeight: 600,\n  fontSize: \"1.44rem\",\n  lineHeight: 1.167,\n};\ntheme.typography.h6 = {\n  fontFamily: \"'Open Sans', sans-serif, Arial\",\n  fontWeight: 600,\n  fontSize: \"1.25rem\",\n  lineHeight: 1.167,\n};\ntheme.typography.fontFamily = \"'Quattrocento Sans', sans-serif\" ;\ntheme = responsiveFontSizes(theme);\n//test dev build flag\n//if (\"NODE_ENV\" in process.env) console.log(process.env.NODE_ENV);\n\nfunction App() {\n  const [MenuOpen, setMenuOpen] = React.useState(false);\n  const setMenuState = (newState?: boolean) => {\n    if (newState === true || newState === false) setMenuOpen(newState);\n    else setMenuOpen(!MenuOpen);\n  };\n  return (\n    <ThemeProvider theme={theme}>\n      <BrowserRouter basename={process.env.PUBLIC_URL}>\n        <Switch>\n          {routes.map((route, index) => (\n            <Route\n              exact={!!route.exact ? route.exact : true}\n              key={index}\n              path={route.path}\n              children={<route.content menuOpen={MenuOpen} setMenuOpen={setMenuState} />}\n            />\n          ))}\n        </Switch>\n      </BrowserRouter>\n    </ThemeProvider>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}